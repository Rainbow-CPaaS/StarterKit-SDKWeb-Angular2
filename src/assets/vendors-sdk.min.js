!function(e,t){"use strict";function n(e,n,r){var i=r.baseHref(),o=e[0];return function(e,r,a){var s,c;c=(a=a||{}).expires,s=t.isDefined(a.path)?a.path:i,t.isUndefined(r)&&(c="Thu, 01 Jan 1970 00:00:00 GMT",r=""),t.isString(c)&&(c=new Date(c)),r=(r=encodeURIComponent(e)+"="+encodeURIComponent(r))+(s?";path="+s:"")+(a.domain?";domain="+a.domain:""),r+=c?";expires="+c.toUTCString():"",r+=a.secure?";secure":"",4096<(a=(r+=a.samesite?";samesite="+a.samesite:"").length+1)&&n.warn("Cookie '"+e+"' possibly not set or overflowed because it was too large ("+a+" > 4096 bytes)!"),o.cookie=r}}t.module("ngCookies",["ng"]).info({angularVersion:"1.7.5"}).provider("$cookies",[function(){var e=this.defaults={};this.$get=["$$cookieReader","$$cookieWriter",function(n,r){return{get:function(e){return n()[e]},getObject:function(e){return(e=this.get(e))?t.fromJson(e):e},getAll:function(){return n()},put:function(n,i,o){r(n,i,o?t.extend({},e,o):e)},putObject:function(e,n,r){this.put(e,t.toJson(n),r)},remove:function(n,i){r(n,void 0,i?t.extend({},e,i):e)}}}]}]),n.$inject=["$document","$log","$browser"],t.module("ngCookies").provider("$$cookieWriter",function(){this.$get=n})}(window,window.angular),function(e,t){"function"==typeof define&&define.amd?define([],function(){return t()}):"object"==typeof module&&module.exports?module.exports=t():t()}(0,function(){function e(e){"use strict";var t=e.storageKey(),n=e.storage(),r=function(){var r=e.preferredLanguage();angular.isString(r)?e.use(r):n.put(t,e.use())};r.displayName="fallbackFromIncorrectStorageValue",n?n.get(t)?e.use(n.get(t)).catch(r):r():angular.isString(e.preferredLanguage())&&e.use(e.preferredLanguage())}function t(e,t,n,r){"use strict";var i,o,a,s,c,l,d,u,p,h,f,m,g,v,S,y,b={},_=[],w=e,T=[],C="translate-cloak",x=!1,R=!1,k=".",P=!1,j=!1,E=0,D=!0,O="default",A={default:function(e){return(e||"").split("-").join("_")},java:function(e){var t=(e||"").split("-").join("_"),n=t.split("_");return 1<n.length?n[0].toLowerCase()+"_"+n[1].toUpperCase():t},bcp47:function(e){var t=(e||"").split("_").join("-"),n=t.split("-");switch(n.length){case 1:n[0]=n[0].toLowerCase();break;case 2:n[0]=n[0].toLowerCase(),4===n[1].length?n[1]=n[1].charAt(0).toUpperCase()+n[1].slice(1).toLowerCase():n[1]=n[1].toUpperCase();break;case 3:n[0]=n[0].toLowerCase(),n[1]=n[1].charAt(0).toUpperCase()+n[1].slice(1).toLowerCase(),n[2]=n[2].toUpperCase();break;default:return t}return n.join("-")},"iso639-1":function(e){return(e||"").split("_").join("-").split("-")[0].toLowerCase()}},M=function(){if(angular.isFunction(r.getLocale))return r.getLocale();var e,n,i=t.$get().navigator,o=["language","browserLanguage","systemLanguage","userLanguage"];if(angular.isArray(i.languages))for(e=0;e<i.languages.length;e++)if((n=i.languages[e])&&n.length)return n;for(e=0;e<o.length;e++)if((n=i[o[e]])&&n.length)return n;return null};M.displayName="angular-translate/service: getFirstBrowserLanguage";var I=function(){var e=M()||"";return A[O]&&(e=A[O](e)),e};I.displayName="angular-translate/service: getLocale";var L=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},N=function(){return this.toString().replace(/^\s+|\s+$/g,"")},$=function(e){return angular.isString(e)?e.toLowerCase():e},B=function(e){if(e){for(var t,n=[],r=$(e),i=0,a=_.length;i<a;i++)n.push($(_[i]));if(-1<(i=L(n,r)))return _[i];if(o)for(var s in o)if(o.hasOwnProperty(s)){var c=!1,l=Object.prototype.hasOwnProperty.call(o,s)&&$(s)===$(e);if("*"===s.slice(-1)&&(c=$(s.slice(0,-1))===$(e.slice(0,s.length-1))),(l||c)&&(t=o[s],-1<L(n,$(t))))return t}var d=e.split("_");return 1<d.length&&-1<L(n,$(d[0]))?d[0]:void 0}},F=function(e,t){if(!e&&!t)return b;if(e&&!t){if(angular.isString(e))return b[e]}else angular.isObject(b[e])||(b[e]={}),angular.extend(b[e],U(t));return this};this.translations=F,this.cloakClassName=function(e){return e?(C=e,this):C},this.nestedObjectDelimeter=function(e){return e?(k=e,this):k};var U=function(e,t,n,r){var i,o,a;for(i in t||(t=[]),n||(n={}),e)Object.prototype.hasOwnProperty.call(e,i)&&(a=e[i],angular.isObject(a)?U(a,t.concat(i),n,i):(o=t.length?""+t.join(k)+k+i:i,t.length&&i===r&&(n[""+t.join(k)]="@:"+o),n[o]=a));return n};U.displayName="flatObject",this.addInterpolation=function(e){return T.push(e),this},this.useMessageFormatInterpolation=function(){return this.useInterpolation("$translateMessageFormatInterpolation")},this.useInterpolation=function(e){return h=e,this},this.useSanitizeValueStrategy=function(e){return n.useStrategy(e),this},this.preferredLanguage=function(e){return e?(H(e),this):i};var H=function(e){return e&&(i=e),i};this.translationNotFoundIndicator=function(e){return this.translationNotFoundIndicatorLeft(e),this.translationNotFoundIndicatorRight(e),this},this.translationNotFoundIndicatorLeft=function(e){return e?(g=e,this):g},this.translationNotFoundIndicatorRight=function(e){return e?(v=e,this):v},this.fallbackLanguage=function(e){return q(e),this};var q=function(e){return e?(angular.isString(e)?(s=!0,a=[e]):angular.isArray(e)&&(s=!1,a=e),angular.isString(i)&&L(a,i)<0&&a.push(i),this):s?a[0]:a};this.use=function(e){if(e){if(!b[e]&&!f)throw new Error("$translateProvider couldn't find translationTable for langKey: '"+e+"'");return c=e,this}return c},this.resolveClientLocale=function(){return I()};var z=function(e){return e?(w=e,this):u?u+w:w};this.storageKey=z,this.useUrlLoader=function(e,t){return this.useLoader("$translateUrlLoader",angular.extend({url:e},t))},this.useStaticFilesLoader=function(e){return this.useLoader("$translateStaticFilesLoader",e)},this.useLoader=function(e,t){return f=e,m=t||{},this},this.useLocalStorage=function(){return this.useStorage("$translateLocalStorage")},this.useCookieStorage=function(){return this.useStorage("$translateCookieStorage")},this.useStorage=function(e){return d=e,this},this.storagePrefix=function(e){return e?(u=e,this):e},this.useMissingTranslationHandlerLog=function(){return this.useMissingTranslationHandler("$translateMissingTranslationHandlerLog")},this.useMissingTranslationHandler=function(e){return p=e,this},this.usePostCompiling=function(e){return x=!!e,this},this.forceAsyncReload=function(e){return R=!!e,this},this.uniformLanguageTag=function(e){return e?angular.isString(e)&&(e={standard:e}):e={},O=e.standard,this},this.determinePreferredLanguage=function(e){var t=e&&angular.isFunction(e)?e():I();return i=_.length&&B(t)||t,this},this.registerAvailableLanguageKeys=function(e,t){return e?(_=e,t&&(o=t),this):_},this.useLoaderCache=function(e){return!1===e?S=void 0:!0===e?S=!0:void 0===e?S="$translationCache":e&&(S=e),this},this.directivePriority=function(e){return void 0===e?E:(E=e,this)},this.statefulFilter=function(e){return void 0===e?D:(D=e,this)},this.postProcess=function(e){return y=e||void 0,this},this.keepContent=function(e){return j=!!e,this},this.$get=["$log","$injector","$rootScope","$q",function(e,t,n,r){var o,u,O,A=t.get(h||"$translateDefaultInterpolation"),M=!1,$={},J={},V=function(e,t,n,s,l,p){!c&&i&&(c=i);var h=l&&l!==c?B(l)||l:c;if(l&&oe(l),angular.isArray(e))return function(e){for(var i={},o=[],a=function(e){var o=r.defer(),a=function(t){i[e]=t,o.resolve([e,t])};return V(e,t,n,s,l,p).then(a,a),o.promise},c=0,d=e.length;c<d;c++)o.push(a(e[c]));return r.all(o).then(function(){return i})}(e);var f=r.defer();if(!e)throw new TypeError("translationId must be a not empty string");e=N.apply(e);var m=function(){var e=J[h]||J[i];if(u=0,d&&!e){var t=o.get(w);if(e=J[t],a&&a.length){var n=L(a,t);u=0===n?1:0,L(a,i)<0&&a.push(i)}}return e}();if(m){var g=function(){l||(h=c),ne(e,t,n,s,h,p).then(f.resolve,f.reject)};g.displayName="promiseResolved",m.finally(g).catch(angular.noop)}else ne(e,t,n,s,h,p).then(f.resolve,f.reject);return f.promise},G=function(e){return g&&(e=[g,e].join(" ")),v&&(e=[e,v].join(" ")),e},W=function(e){c=e,d&&o.put(V.storageKey(),c),n.$emit("$translateChangeSuccess",{language:e}),A.setLocale(c);var t=function(e,t){$[t].setLocale(c)};t.displayName="eachInterpolatorLocaleSetter",angular.forEach($,t),n.$emit("$translateChangeEnd",{language:e})},X=function(e){if(!e)throw"No language key specified for loading.";var i=r.defer();n.$emit("$translateLoadingStart",{language:e}),M=!0;var o=S;"string"==typeof o&&(o=t.get(o));var a=angular.extend({},m,{key:e,$http:angular.extend({},{cache:o},m.$http)}),s=function(t){var r={};n.$emit("$translateLoadingSuccess",{language:e}),angular.isArray(t)?angular.forEach(t,function(e){angular.extend(r,U(e))}):angular.extend(r,U(t)),M=!1,i.resolve({key:e,table:r}),n.$emit("$translateLoadingEnd",{language:e})};s.displayName="onLoaderSuccess";var c=function(e){n.$emit("$translateLoadingError",{language:e}),i.reject(e),n.$emit("$translateLoadingEnd",{language:e})};return c.displayName="onLoaderError",t.get(f)(a).then(s,c),i.promise};if(d&&(!(o=t.get(d)).get||!o.put))throw new Error("Couldn't use storage '"+d+"', missing get() or put() method!");if(T.length){var K=function(e){var n=t.get(e);n.setLocale(i||c),$[n.getInterpolationIdentifier()]=n};K.displayName="interpolationFactoryAdder",angular.forEach(T,K)}var Q=function(e,t,n,i,o){var a=r.defer(),s=function(r){if(Object.prototype.hasOwnProperty.call(r,t)&&null!==r[t]){i.setLocale(e);var s=r[t];if("@:"===s.substr(0,2))Q(e,s.substr(2),n,i,o).then(a.resolve,a.reject);else{var l=i.interpolate(r[t],n,"service",o,t);l=ie(t,r[t],l,n,e),a.resolve(l)}i.setLocale(c)}else a.reject()};return s.displayName="fallbackTranslationResolver",function(e){var t=r.defer();if(Object.prototype.hasOwnProperty.call(b,e))t.resolve(b[e]);else if(J[e]){var n=function(e){F(e.key,e.table),t.resolve(e.table)};n.displayName="translationTableResolver",J[e].then(n,t.reject)}else t.reject();return t.promise}(e).then(s,a.reject),a.promise},Y=function(e,t,n,r,i){var o,a=b[e];if(a&&Object.prototype.hasOwnProperty.call(a,t)&&null!==a[t]){if(r.setLocale(e),o=r.interpolate(a[t],n,"filter",i,t),o=ie(t,a[t],o,n,e,i),!angular.isString(o)&&angular.isFunction(o.$$unwrapTrustedValue)){var s=o.$$unwrapTrustedValue();if("@:"===s.substr(0,2))return Y(e,s.substr(2),n,r,i)}else if("@:"===o.substr(0,2))return Y(e,o.substr(2),n,r,i);r.setLocale(c)}return o},Z=function(e,n,r,i){return p?t.get(p)(e,c,n,r,i):e},ee=function(e,t,n,i,o,s){var c=r.defer();if(e<a.length){var l=a[e];Q(l,t,n,i,s).then(function(e){c.resolve(e)},function(){return ee(e+1,t,n,i,o,s).then(c.resolve,c.reject)})}else if(o)c.resolve(o);else{var d=Z(t,n,o);p&&d?c.resolve(d):c.reject(G(t))}return c.promise},te=function(e,t,n,r,i){var o;if(e<a.length){var s=a[e];(o=Y(s,t,n,r,i))||""===o||(o=te(e+1,t,n,r))}return o},ne=function(e,t,n,i,o,s){var c,l,d,h,f,m=r.defer(),g=o?b[o]:b,v=n?$[n]:A;if(g&&Object.prototype.hasOwnProperty.call(g,e)&&null!==g[e]){var S=g[e];if("@:"===S.substr(0,2))V(S.substr(2),t,n,i,o,s).then(m.resolve,m.reject);else{var y=v.interpolate(S,t,"service",s,e);y=ie(e,S,y,t,o),m.resolve(y)}}else{var _;p&&!M&&(_=Z(e,t,i)),o&&a&&a.length?(c=e,l=t,d=v,h=i,f=s,ee(0<O?O:u,c,l,d,h,f)).then(function(e){m.resolve(e)},function(e){m.reject(G(e))}):p&&!M&&_?i?m.resolve(i):m.resolve(_):i?m.resolve(i):m.reject(G(e))}return m.promise},re=function(e,t,n,r,i){var o,s=r?b[r]:b,c=A;if($&&Object.prototype.hasOwnProperty.call($,n)&&(c=$[n]),s&&Object.prototype.hasOwnProperty.call(s,e)&&null!==s[e]){var l=s[e];o="@:"===l.substr(0,2)?re(l.substr(2),t,n,r,i):(o=c.interpolate(l,t,"filter",i,e),ie(e,l,o,t,r,i))}else{var d;p&&!M&&(d=Z(e,t,i)),o=r&&a&&a.length?te((u=0)<O?O:u,e,t,c,i):p&&!M&&d?d:G(e)}return o},ie=function(e,n,r,i,o,a){var s=y;return s&&("string"==typeof s&&(s=t.get(s)),s)?s(e,n,r,i,o,a):r},oe=function(e){b[e]||!f||J[e]||(J[e]=X(e).then(function(e){return F(e.key,e.table),e}))};V.preferredLanguage=function(e){return e&&H(e),i},V.cloakClassName=function(){return C},V.nestedObjectDelimeter=function(){return k},V.fallbackLanguage=function(e){if(null!=e){if(q(e),f&&a&&a.length)for(var t=0,n=a.length;t<n;t++)J[a[t]]||(J[a[t]]=X(a[t]));V.use(V.use())}return s?a[0]:a},V.useFallbackLanguage=function(e){if(null!=e)if(e){var t=L(a,e);-1<t&&(O=t)}else O=0},V.proposedLanguage=function(){return l},V.storage=function(){return o},V.negotiateLocale=B,V.use=function(e){if(!e)return c;var t=r.defer();t.promise.then(null,angular.noop),n.$emit("$translateChangeStart",{language:e});var i=B(e);return 0<_.length&&!i?r.reject(e):(i&&(e=i),l=e,!R&&b[e]||!f||J[e]?J[e]?J[e].then(function(e){return l===e.key&&W(e.key),t.resolve(e.key),e},function(e){return!c&&a&&0<a.length&&a[0]!==e?V.use(a[0]).then(t.resolve,t.reject):t.reject(e)}):(t.resolve(e),W(e)):(J[e]=X(e).then(function(n){return F(n.key,n.table),t.resolve(n.key),l===e&&W(n.key),n},function(e){return n.$emit("$translateChangeError",{language:e}),t.reject(e),n.$emit("$translateChangeEnd",{language:e}),r.reject(e)}),J[e].finally(function(){var t;l===(t=e)&&(l=void 0),J[t]=void 0}).catch(angular.noop)),t.promise)},V.resolveClientLocale=function(){return I()},V.storageKey=function(){return z()},V.isPostCompilingEnabled=function(){return x},V.isForceAsyncReloadEnabled=function(){return R},V.isKeepContent=function(){return j},V.refresh=function(e){if(!f)throw new Error("Couldn't refresh translation table, no loader registered!");n.$emit("$translateRefreshStart",{language:e});var t=r.defer(),i={};function o(e){var t=X(e);return(J[e]=t).then(function(t){b[e]={},F(e,t.table),i[e]=!0},angular.noop),t}if(t.promise.then(function(){for(var e in b)b.hasOwnProperty(e)&&(e in i||delete b[e]);c&&W(c)},angular.noop).finally(function(){n.$emit("$translateRefreshEnd",{language:e})}),e)b[e]?o(e).then(t.resolve,t.reject):t.reject();else{var s=a&&a.slice()||[];c&&-1===s.indexOf(c)&&s.push(c),r.all(s.map(o)).then(t.resolve,t.reject)}return t.promise},V.instant=function(e,t,n,r,o){var s=r&&r!==c?B(r)||r:c;if(null===e||angular.isUndefined(e))return e;if(r&&oe(r),angular.isArray(e)){for(var l={},d=0,u=e.length;d<u;d++)l[e[d]]=V.instant(e[d],t,n,r,o);return l}if(angular.isString(e)&&e.length<1)return e;e&&(e=N.apply(e));var h,f,m=[];i&&m.push(i),s&&m.push(s),a&&a.length&&(m=m.concat(a));for(var S=0,y=m.length;S<y;S++){var _=m[S];if(b[_]&&void 0!==b[_][e]&&(h=re(e,t,n,s,o)),void 0!==h)break}return h||""===h||(g||v?h=G(e):(h=A.interpolate(e,t,"filter",o),p&&!M&&(f=Z(e,t,o)),p&&!M&&f&&(h=f))),h},V.versionInfo=function(){return"2.18.3"},V.loaderCache=function(){return S},V.directivePriority=function(){return E},V.statefulFilter=function(){return D},V.isReady=function(){return P};var ae=r.defer();ae.promise.then(function(){P=!0}),V.onReady=function(e){var t=r.defer();return angular.isFunction(e)&&t.promise.then(e),P?t.resolve():ae.promise.then(t.resolve),t.promise},V.getAvailableLanguageKeys=function(){return 0<_.length?_:null},V.getTranslationTable=function(e){return(e=e||V.use())&&b[e]?angular.copy(b[e]):null};var se=n.$on("$translateReady",function(){ae.resolve(),se(),se=null}),ce=n.$on("$translateChangeEnd",function(){ae.resolve(),ce(),ce=null});if(f){if(angular.equals(b,{})&&V.use()&&V.use(V.use()),a&&a.length)for(var le=function(e){return F(e.key,e.table),n.$emit("$translateChangeEnd",{language:e.key}),e},de=0,ue=a.length;de<ue;de++){var pe=a[de];!R&&b[pe]||(J[pe]=X(pe).then(le))}}else n.$emit("$translateReady",{language:V.use()});return V}]}function n(e,t){"use strict";var n={setLocale:function(e){},getInterpolationIdentifier:function(){return"default"},useSanitizeValueStrategy:function(e){return t.useStrategy(e),this},interpolate:function(n,r,i,o,a){var s;return r=r||{},r=t.sanitize(r,"params",o,i),angular.isNumber(n)?""+n:angular.isString(n)?(s=e(n)(r),t.sanitize(s,"text",o,i)):""}};return n}function r(e,t,n,r,i){"use strict";var o=function(e){return angular.isString(e)?e.toLowerCase():e};return{restrict:"AE",scope:!0,priority:e.directivePriority(),compile:function(a,s){var c=s.translateValues?s.translateValues:void 0,l=s.translateInterpolation?s.translateInterpolation:void 0,d=s.translateSanitizeStrategy?s.translateSanitizeStrategy:void 0,u=a[0].outerHTML.match(/translate-value-+/i),p="^(.*)("+t.startSymbol()+".*"+t.endSymbol()+")(.*)",h="^(.*)"+t.startSymbol()+"(.*)"+t.endSymbol()+"(.*)";return function(a,f,m){a.interpolateParams={},a.preText="",a.postText="",a.translateNamespace=function e(t){return t.translateNamespace?t.translateNamespace:t.$parent?e(t.$parent):void 0}(a);var g={},v=function(e){if(angular.isFunction(v._unwatchOld)&&(v._unwatchOld(),v._unwatchOld=void 0),angular.equals(e,"")||!angular.isDefined(e)){var n=function(){return this.toString().replace(/^\s+|\s+$/g,"")}.apply(f.text()).replace(/\n/g," "),r=n.match(p);if(angular.isArray(r)){a.preText=r[1],a.postText=r[3],g.translate=t(r[2])(a.$parent);var i=n.match(h);angular.isArray(i)&&i[2]&&i[2].length&&(v._unwatchOld=a.$watch(i[2],function(e){g.translate=e,T()}))}else g.translate=n||void 0}else g.translate=e;T()},S=function(e){m.$observe(e,function(t){g[e]=t,T()})};!function(e,t,n){if(t.translateValues&&angular.extend(e,r(t.translateValues)(a.$parent)),u)for(var i in n)Object.prototype.hasOwnProperty.call(t,i)&&"translateValue"===i.substr(0,14)&&"translateValues"!==i&&(e[o(i.substr(14,1))+i.substr(15)]=n[i])}(a.interpolateParams,m,s);var y=!0;for(var b in m.$observe("translate",function(e){void 0===e?v(""):""===e&&y||(g.translate=e,T()),y=!1}),m)m.hasOwnProperty(b)&&"translateAttr"===b.substr(0,13)&&13<b.length&&S(b);if(m.$observe("translateDefault",function(e){a.defaultText=e,T()}),d&&m.$observe("translateSanitizeStrategy",function(e){a.sanitizeStrategy=r(e)(a.$parent),T()}),c&&m.$observe("translateValues",function(e){e&&a.$parent.$watch(function(){angular.extend(a.interpolateParams,r(e)(a.$parent))})}),u){var _=function(e){m.$observe(e,function(t){var n=o(e.substr(14,1))+e.substr(15);a.interpolateParams[n]=t})};for(var w in m)Object.prototype.hasOwnProperty.call(m,w)&&"translateValue"===w.substr(0,14)&&"translateValues"!==w&&_(w)}var T=function(){for(var e in g)g.hasOwnProperty(e)&&void 0!==g[e]&&C(e,g[e],a,a.interpolateParams,a.defaultText,a.translateNamespace)},C=function(t,n,r,i,o,a){n?(a&&"."===n.charAt(0)&&(n=a+n),e(n,i,l,o,r.translateLanguage,r.sanitizeStrategy).then(function(e){x(e,r,!0,t)},function(e){x(e,r,!1,t)})):x(n,r,!1,t)},x=function(t,r,i,o){if(i||void 0!==r.defaultText&&(t=r.defaultText),"translate"===o){(i||!i&&!e.isKeepContent()&&void 0===m.translateKeepContent)&&f.empty().append(r.preText+t+r.postText);var a=e.isPostCompilingEnabled(),c=void 0!==s.translateCompile,l=c&&"false"!==s.translateCompile;(a&&!c||l)&&n(f.contents())(r)}else{var d=m.$attr[o];"data-"===d.substr(0,5)&&(d=d.substr(5)),d=d.substr(15),f.attr(d,t)}};(c||u||m.translateDefault)&&a.$watch("interpolateParams",T,!0),a.$on("translateLanguageChanged",T);var R=i.$on("$translateChangeSuccess",T);f.text().length?m.translate?v(m.translate):v(""):m.translate&&v(m.translate),T(),a.$on("$destroy",R)}}}}function i(e,t){"use strict";return{restrict:"A",priority:e.directivePriority(),link:function(n,r,i){var a,s,c,l={},d=function(){angular.forEach(a,function(t,o){t&&(l[o]=!0,n.translateNamespace&&"."===t.charAt(0)&&(t=n.translateNamespace+t),e(t,s,i.translateInterpolation,void 0,n.translateLanguage,c).then(function(e){r.attr(o,e)},function(e){r.attr(o,e)}))}),angular.forEach(l,function(e,t){a[t]||(r.removeAttr(t),delete l[t])})};o(n,i.translateAttr,function(e){a=e},d),o(n,i.translateValues,function(e){s=e},d),o(n,i.translateSanitizeStrategy,function(e){c=e},d),i.translateValues&&n.$watch(i.translateValues,d,!0),n.$on("translateLanguageChanged",d);var u=t.$on("$translateChangeSuccess",d);d(),n.$on("$destroy",u)}}}function o(e,t,n,r){"use strict";t&&("::"===t.substr(0,2)?t=t.substr(2):e.$watch(t,function(e){n(e),r()},!0),n(e.$eval(t)))}function a(e,t){"use strict";return{compile:function(n){var r=function(t){t.addClass(e.cloakClassName())};return r(n),function(n,i,o){var a=function(t){t.removeClass(e.cloakClassName())}.bind(this,i),s=r.bind(this,i);o.translateCloak&&o.translateCloak.length?(o.$observe("translateCloak",function(t){e(t).then(a,s)}),t.$on("$translateChangeSuccess",function(){e(o.translateCloak).then(a,s)})):e.onReady(a)}}}}function s(){"use strict";return{restrict:"A",scope:!0,compile:function(){return{pre:function(e,t,n){e.translateNamespace=function e(t){return t.translateNamespace?t.translateNamespace:t.$parent?e(t.$parent):void 0}(e),e.translateNamespace&&"."===n.translateNamespace.charAt(0)?e.translateNamespace+=n.translateNamespace:e.translateNamespace=n.translateNamespace}}}}}function c(){"use strict";return{restrict:"A",scope:!0,compile:function(){return function(e,t,n){n.$observe("translateLanguage",function(t){e.translateLanguage=t}),e.$watch("translateLanguage",function(){e.$broadcast("translateLanguageChanged")})}}}}function l(e,t){"use strict";var n=function(n,r,i,o){if(!angular.isObject(r)){var a=this||{__SCOPE_IS_NOT_AVAILABLE:"More info at https://github.com/angular/angular.js/commit/8863b9d04c722b278fa93c5d66ad1e578ad6eb1f"};r=e(r)(a)}return t.instant(n,r,i,o)};return t.statefulFilter()&&(n.$stateful=!0),n}function d(e){"use strict";return e("translations")}return e.$inject=["$translate"],t.$inject=["$STORAGE_KEY","$windowProvider","$translateSanitizationProvider","pascalprechtTranslateOverrider"],n.$inject=["$interpolate","$translateSanitization"],r.$inject=["$translate","$interpolate","$compile","$parse","$rootScope"],i.$inject=["$translate","$rootScope"],a.$inject=["$translate","$rootScope"],l.$inject=["$parse","$translate"],d.$inject=["$cacheFactory"],angular.module("pascalprecht.translate",["ng"]).run(e),e.displayName="runTranslate",angular.module("pascalprecht.translate").provider("$translateSanitization",function(){"use strict";var e,t,n,r=null,i=!1,o=!1;(n={sanitize:function(e,t){return"text"===t&&(e=s(e)),e},escape:function(e,t){return"text"===t&&(e=a(e)),e},sanitizeParameters:function(e,t){return"params"===t&&(e=l(e,s)),e},escapeParameters:function(e,t){return"params"===t&&(e=l(e,a)),e},sce:function(e,t,n){return"text"===t?e=c(e):"params"===t&&"filter"!==n&&(e=l(e,a)),e},sceParameters:function(e,t){return"params"===t&&(e=l(e,c)),e}}).escaped=n.escapeParameters,this.addStrategy=function(e,t){return n[e]=t,this},this.removeStrategy=function(e){return delete n[e],this},this.useStrategy=function(e){return i=!0,r=e,this},this.$get=["$injector","$log",function(a,s){var c,l={};return a.has("$sanitize")&&(e=a.get("$sanitize")),a.has("$sce")&&(t=a.get("$sce")),{useStrategy:(c=this,function(e){c.useStrategy(e)}),sanitize:function(e,t,c,d){if(r||i||o||(s.warn("pascalprecht.translate.$translateSanitization: No sanitization strategy has been configured. This can have serious security implications. See http://angular-translate.github.io/docs/#/guide/19_security for details."),o=!0),c||null===c||(c=r),!c)return e;d||(d="service");var u,p,h,f,m=angular.isArray(c)?c:[c];return u=e,p=t,h=d,f=m,angular.forEach(f,function(e){if(angular.isFunction(e))u=e(u,p,h);else if(angular.isFunction(n[e]))u=n[e](u,p,h);else{if(!angular.isString(n[e]))throw new Error("pascalprecht.translate.$translateSanitization: Unknown sanitization strategy: '"+e+"'");if(!l[n[e]])try{l[n[e]]=a.get(n[e])}catch(t){throw l[n[e]]=function(){},new Error("pascalprecht.translate.$translateSanitization: Unknown sanitization strategy: '"+e+"'")}u=l[n[e]](u,p,h)}}),u}}}];var a=function(e){var t=angular.element("<div></div>");return t.text(e),t.html()},s=function(t){if(!e)throw new Error("pascalprecht.translate.$translateSanitization: Error cannot find $sanitize service. Either include the ngSanitize module (https://docs.angularjs.org/api/ngSanitize) or use a sanitization strategy which does not depend on $sanitize, such as 'escape'.");return e(t)},c=function(e){if(!t)throw new Error("pascalprecht.translate.$translateSanitization: Error cannot find $sce service.");return t.trustAsHtml(e)},l=function(e,t,n){if(angular.isDate(e))return e;if(angular.isObject(e)){var r=angular.isArray(e)?[]:{};if(n){if(-1<n.indexOf(e))throw new Error("pascalprecht.translate.$translateSanitization: Error cannot interpolate parameter due recursive object")}else n=[];return n.push(e),angular.forEach(e,function(e,i){angular.isFunction(e)||(r[i]=l(e,t,n))}),n.splice(-1,1),r}return angular.isNumber(e)?e:!0===e||!1===e?e:angular.isUndefined(e)||null===e?e:t(e)}}),angular.module("pascalprecht.translate").constant("pascalprechtTranslateOverrider",{}).provider("$translate",t),t.displayName="displayName",angular.module("pascalprecht.translate").factory("$translateDefaultInterpolation",n),n.displayName="$translateDefaultInterpolation",angular.module("pascalprecht.translate").constant("$STORAGE_KEY","NG_TRANSLATE_LANG_KEY"),angular.module("pascalprecht.translate").directive("translate",r),r.displayName="translateDirective",angular.module("pascalprecht.translate").directive("translateAttr",i),i.displayName="translateAttrDirective",angular.module("pascalprecht.translate").directive("translateCloak",a),a.displayName="translateCloakDirective",angular.module("pascalprecht.translate").directive("translateNamespace",s),s.displayName="translateNamespaceDirective",angular.module("pascalprecht.translate").directive("translateLanguage",c),c.displayName="translateLanguageDirective",angular.module("pascalprecht.translate").filter("translate",l),l.displayName="translateFilterFactory",angular.module("pascalprecht.translate").factory("$translationCache",d),d.displayName="$translationCache","pascalprecht.translate"}),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";e.exports="ngFileSaver",angular.module("ngFileSaver",[]).factory("FileSaver",["Blob","SaveAs","FileSaverUtils",n(1)]).factory("FileSaverUtils",[n(2)]).factory("Blob",["$window",n(3)]).factory("SaveAs",[n(5)])},function(e,t){"use strict";e.exports=function(e,t,n){function r(e,r,i){try{t(e,r,i)}catch(e){n.handleErrors(e.message)}}return{saveAs:function(e,t,i){return n.isBlobInstance(e)||n.handleErrors("Data argument should be a blob instance"),n.isString(t)||n.handleErrors("Filename argument should be a string"),r(e,t,i)}}}},function(e,t){"use strict";e.exports=function(){return{handleErrors:function(e){throw new Error(e)},isString:function(e){return"string"==typeof e||e instanceof String},isUndefined:function(e){return void 0===e},isBlobInstance:function(e){return e instanceof Blob}}}},function(e,t,n){"use strict";n(4),e.exports=function(e){return e.Blob}},function(e,t){!function(e){"use strict";if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(e){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},r=function(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n},i=n.prototype,o=r.prototype,a=e.FileReaderSync,s=function(e){this.code=this[this.name=e]},c="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),l=c.length,d=e.URL||e.webkitURL||e,u=d.createObjectURL,p=d.revokeObjectURL,h=d,f=e.btoa,m=e.atob,g=e.ArrayBuffer,v=e.Uint8Array,S=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(r.fake=o.fake=!0;l--;)s.prototype[c[l]]=l+1;return d.createObjectURL||(h=e.URL=function(e){var t,n=document.createElementNS("http://www.w3.org/1999/xhtml","a");return n.href=e,"origin"in n||("data:"===n.protocol.toLowerCase()?n.origin=null:(t=e.match(S),n.origin=t&&t[1])),n}),h.createObjectURL=function(e){var t,n=e.type;return null===n&&(n="application/octet-stream"),e instanceof r?(t="data:"+n,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):f?t+";base64,"+f(e.data):t+","+encodeURIComponent(e.data)):u?u.call(d,e):void 0},h.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&p&&p.call(d,e)},i.append=function(e){var n=this.data;if(v&&(e instanceof g||e instanceof v)){for(var i="",o=new v(e),c=0,l=o.length;c<l;c++)i+=String.fromCharCode(o[c]);n.push(i)}else if("Blob"===t(e)||"File"===t(e)){if(!a)throw new s("NOT_READABLE_ERR");var d=new a;n.push(d.readAsBinaryString(e))}else e instanceof r?"base64"===e.encoding&&m?n.push(m(e.data)):"URI"===e.encoding?n.push(decodeURIComponent(e.data)):"raw"===e.encoding&&n.push(e.data):("string"!=typeof e&&(e+=""),n.push(unescape(encodeURIComponent(e))))},i.getBlob=function(e){return arguments.length||(e=null),new r(this.data.join(""),e,"raw")},i.toString=function(){return"[object BlobBuilder]"},o.slice=function(e,t,n){var i=arguments.length;return i<3&&(n=null),new r(this.data.slice(e,i>1?t:this.data.length),n,this.encoding)},o.toString=function(){return"[object Blob]"},o.close=function(){this.size=0,delete this.data},n}(e);e.Blob=function(e,n){var r=n&&n.type||"",i=new t;if(e)for(var o=0,a=e.length;o<a;o++)Uint8Array&&e[o]instanceof Uint8Array?i.append(e[o].buffer):i.append(e[o]);var s=i.getBlob(r);return!s.slice&&s.webkitSlice&&(s.slice=s.webkitSlice),s};var n=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=n(new e.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this)},function(e,t,n){"use strict";e.exports=function(){return n(6).saveAs||function(){}}},function(e,t,n){var r,i=i||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in r,o=/constructor/i.test(e.HTMLElement)||e.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},c=function(e){setTimeout(function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()},4e4)},l=function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var i=e["on"+t[r]];if("function"==typeof i)try{i.call(e,n||e)}catch(e){s(e)}}},d=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},u=function(t,s,u){u||(t=d(t));var p,h=this,f="application/octet-stream"===t.type,m=function(){l(h,"writestart progress write writeend".split(" "))};return h.readyState=h.INIT,i?(p=n().createObjectURL(t),void setTimeout(function(){var e,t;r.href=p,r.download=s,e=r,t=new MouseEvent("click"),e.dispatchEvent(t),m(),c(p),h.readyState=h.DONE})):void function(){if((a||f&&o)&&e.FileReader){var r=new FileReader;return r.onloadend=function(){var t=a?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,h.readyState=h.DONE,m()},r.readAsDataURL(t),void(h.readyState=h.INIT)}p||(p=n().createObjectURL(t)),f?e.location.href=p:e.open(p,"_blank")||(e.location.href=p);h.readyState=h.DONE,m(),c(p)}()},p=u.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=d(e)),navigator.msSaveOrOpenBlob(e,t)}:(p.abort=function(){},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,function(e,t,n){return new u(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==e&&e.exports?e.exports.saveAs=i:null!==n(7)&&null!==n(8)&&(void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r))},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){(function(t){e.exports=t}).call(t,{})}])}),function(e,t){"function"==typeof define&&define.amd?define([],function(){return t()}):"object"==typeof module&&module.exports?module.exports=t():t()}(0,function(){function e(e,t){"use strict";return function(n){if(!n||!(angular.isArray(n.files)||angular.isString(n.prefix)&&angular.isString(n.suffix)))throw new Error("Couldn't load static files, no files and prefix or suffix specified!");n.files||(n.files=[{prefix:n.prefix,suffix:n.suffix}]);for(var r=function(r){if(!r||!angular.isString(r.prefix)||!angular.isString(r.suffix))throw new Error("Couldn't load static file, no prefix or suffix specified!");var i=[r.prefix,n.key,r.suffix].join("");return angular.isObject(n.fileMap)&&n.fileMap[i]&&(i=n.fileMap[i]),t(angular.extend({url:i,method:"GET"},n.$http)).then(function(e){return e.data},function(){return e.reject(n.key)})},i=[],o=n.files.length,a=0;a<o;a++)i.push(r({prefix:n.files[a].prefix,key:n.key,suffix:n.files[a].suffix}));return e.all(i).then(function(e){for(var t=e.length,n={},r=0;r<t;r++)for(var i in e[r])n[i]=e[r][i];return n})}}return e.$inject=["$q","$http"],angular.module("pascalprecht.translate").factory("$translateStaticFilesLoader",e),e.displayName="$translateStaticFilesLoader","pascalprecht.translate"}),function(){"use strict";var e,t,n="translateOnce";function r(t,n,r){var i=e(t);return{restrict:"A",priority:-2,link:function(e,o,a){var s={};a.translateValues&&(s=n(a.translateValues)(e)),r(a[i],s).then(function(e){o.attr(t,e)})}}}e=function(e){return n+e.charAt(0).toUpperCase()+e.slice(1)},t=function(t){var n=e(t);angular.module("pascalprecht.translate").directive(n,["$parse","$translate",angular.bind(void 0,r,t)])},["value","title","alt","placeholder"].forEach(function(e){t(e)}),angular.module("pascalprecht.translate").directive(n,["$compile","$parse","$translate",function(e,t,r){return{restrict:"A",priority:-1,link:function(i,o,a){var s={};a.translateValues&&(s=t(a.translateValues)(i)),r(a[n],s).then(function(t){o.html(t),a.hasOwnProperty("translateCompile")&&e(o.contents())(i)})}}}])}.apply(this),function(e,t){"use strict";var n,r,i,o,a,s,c,l,d,u,p=t.$$minErr("$sanitize");t.module("ngSanitize",[]).provider("$sanitize",function(){function h(e,t){return f(e.split(","),t)}function f(e,t){var n,r={};for(n=0;n<e.length;n++)r[t?s(e[n]):e[n]]=!0;return r}function m(e,t){t&&t.length&&r(e,f(t))}function g(e){for(var t={},n=0,r=e.length;n<r;n++){var i=e[n];t[i.name]=i.value}return t}function v(e){return e.replace(/&/g,"&amp;").replace(_,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+((e=e.charCodeAt(1))-56320)+65536)+";"}).replace(w,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function S(e,t){var n=t[e];if(n&&l.call(t,n))throw p("elclob",t.outerHTML||t.outerText);return n}var y=!1,b=!1;this.$get=["$$sanitizeUri",function(e){return y=!0,b&&r(j,k),function(t){var n=[];return d(t,u(n,function(t,n){return!/^unsafe:/.test(e(t,n))})),n.join("")}}],this.enableSvg=function(e){return a(e)?(b=e,this):b},this.addValidElements=function(e){return y||(o(e)&&(e={htmlElements:e}),m(k,e.svgElements),m(T,e.htmlVoidElements),m(j,e.htmlVoidElements),m(j,e.htmlElements)),this},this.addValidAttrs=function(e){return y||r(D,f(e,!0)),this},n=t.bind,r=t.extend,i=t.forEach,o=t.isArray,a=t.isDefined,s=t.$$lowercase,c=t.noop,d=function(e,t){null==e?e="":"string"!=typeof e&&(e=""+e);var n=O(e);if(!n)return"";var r=5;do{if(0===r)throw p("uinput");r--,e=n.innerHTML,n=O(e)}while(e!==n.innerHTML);for(r=n.firstChild;r;){switch(r.nodeType){case 1:t.start(r.nodeName.toLowerCase(),g(r.attributes));break;case 3:t.chars(r.textContent)}var i;if(!(i=r.firstChild)&&(1===r.nodeType&&t.end(r.nodeName.toLowerCase()),!(i=S("nextSibling",r))))for(;null==i&&(r=S("parentNode",r))!==n;)i=S("nextSibling",r),1===r.nodeType&&t.end(r.nodeName.toLowerCase());r=i}for(;r=n.firstChild;)n.removeChild(r)},u=function(e,t){var r=!1,o=n(e,e.push);return{start:function(e,n){e=s(e),!r&&P[e]&&(r=e),r||!0!==j[e]||(o("<"),o(e),i(n,function(n,r){var i=s(r),a="img"===e&&"src"===i||"background"===i;!0!==D[i]||!0===E[i]&&!t(n,a)||(o(" "),o(r),o('="'),o(v(n)),o('"'))}),o(">"))},end:function(e){e=s(e),r||!0!==j[e]||!0===T[e]||(o("</"),o(e),o(">")),e==r&&(r=!1)},chars:function(e){r||o(v(e))}}},l=e.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))};var _=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,w=/([^#-~ |!])/g,T=h("area,br,col,hr,img,wbr"),C=h("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),x=h("rp,rt"),R=r({},x,C),k=(C=r({},C,h("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),x=r({},x,h("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),h("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan")),P=h("script,style"),j=r({},T,C,x,R),E=h("background,cite,href,longdesc,src,xlink:href,xml:base"),D=(R=h("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),x=h("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),r({},E,x,R)),O=function(t,n){function r(e){e="<remove></remove>"+e;try{var n=(new t.DOMParser).parseFromString(e,"text/html").body;return n.firstChild.remove(),n}catch(e){}}var i;try{i=!!r("")}catch(e){i=!1}if(i)return r;if(!n||!n.implementation)throw p("noinert");var o=((i=n.implementation.createHTMLDocument("inert")).documentElement||i.getDocumentElement()).querySelector("body");return function(t){return o.innerHTML=t,n.documentMode&&function t(n){for(;n;){if(n.nodeType===e.Node.ELEMENT_NODE)for(var r=n.attributes,i=0,o=r.length;i<o;i++){var a=r[i],s=a.name.toLowerCase();"xmlns:ns1"!==s&&0!==s.lastIndexOf("ns1:",0)||(n.removeAttributeNode(a),i--,o--)}(r=n.firstChild)&&t(r),n=S("nextSibling",n)}}(o),o}}(e,e.document)}).info({angularVersion:"1.8.2"}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((s?ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,r=/^mailto:/i,i=t.$$minErr("linky"),o=t.isDefined,a=t.isFunction,s=t.isObject,l=t.isString;return function(t,d,p){function h(e){e&&y.push(function(e){var t=[];return u(t,c).chars(e),t.join("")}(e))}function f(e,t){var n,r=v(e);for(n in y.push("<a "),r)y.push(n+'="'+r[n]+'" ');!o(d)||"target"in r||y.push('target="',d,'" '),y.push('href="',e.replace(/"/g,"&quot;"),'">'),h(t),y.push("</a>")}if(null==t||""===t)return t;if(!l(t))throw i("notstring",t);for(var m,g,v=a(p)?p:s(p)?function(){return p}:function(){return{}},S=t,y=[];t=S.match(n);)m=t[0],t[2]||t[4]||(m=(t[3]?"http://":"mailto:")+m),g=t.index,h(S.substr(0,g)),f(m,t[0].replace(r,"")),S=S.substring(g+t[0].length);return h(S),e(y.join(""))}}])}(window,window.angular),function(e,t){if("function"==typeof define&&define.amd)define(["moment"],t);else if("object"==typeof exports)try{module.exports=t(require("moment"))}catch(e){module.exports=t}e&&(e.momentDurationFormatSetup=e.moment?t(e.moment):t)}(this,function(e){var t=!1,n=!1,r=!1,i=!1,o="escape years months weeks days hours minutes seconds milliseconds general".split(" "),a=[{type:"seconds",targets:[{type:"minutes",value:60},{type:"hours",value:3600},{type:"days",value:86400},{type:"weeks",value:604800},{type:"months",value:2678400},{type:"years",value:31536e3}]},{type:"minutes",targets:[{type:"hours",value:60},{type:"days",value:1440},{type:"weeks",value:10080},{type:"months",value:44640},{type:"years",value:525600}]},{type:"hours",targets:[{type:"days",value:24},{type:"weeks",value:168},{type:"months",value:744},{type:"years",value:8760}]},{type:"days",targets:[{type:"weeks",value:7},{type:"months",value:31},{type:"years",value:365}]},{type:"months",targets:[{type:"years",value:12}]}];function s(e,t){return!(t.length>e.length)&&-1!==e.indexOf(t)}function c(e){for(var t="";e;)t+="0",e-=1;return t}function l(e,t){var n=e+"+"+v(C(t).sort(),function(e){return e+":"+t[e]}).join(",");return l.cache[n]||(l.cache[n]=Intl.NumberFormat(e,t)),l.cache[n]}function d(e,t,o){var a,s,u,p=t.useToLocaleString,h=t.useGrouping,f=h&&t.grouping.slice(),m=t.maximumSignificantDigits,g=t.minimumIntegerDigits||1,v=t.fractionDigits||0,S=t.groupingSeparator,y=t.decimalSeparator;if(p&&o){var b={minimumIntegerDigits:g,useGrouping:h};if(v&&(b.maximumFractionDigits=v,b.minimumFractionDigits=v),m&&e>0&&(b.maximumSignificantDigits=m),r){var _;if(!i)(_=T({},t)).useGrouping=!1,_.decimalSeparator=".",e=parseFloat(d(e,_),10);return l(o,b).format(e)}return n||((_=T({},t)).useGrouping=!1,_.decimalSeparator=".",e=parseFloat(d(e,_),10)),e.toLocaleString(o,b)}var w=(m?e.toPrecision(m+1):e.toFixed(v+1)).split("e");u=w[1]||"",s=(w=w[0].split("."))[1]||"";var C=(a=w[0]||"").length,x=s.length,R=C+x,k=a+s;(m&&R===m+1||!m&&x===v+1)&&((k=function(e){for(var t=e.split("").reverse(),n=0,r=!0;r&&n<t.length;)n?"9"===t[n]?t[n]="0":(t[n]=(parseInt(t[n],10)+1).toString(),r=!1):(parseInt(t[n],10)<5&&(r=!1),t[n]="0"),n+=1;return r&&t.push("1"),t.reverse().join("")}(k)).length===R+1&&(C+=1),x&&(k=k.slice(0,-1)),a=k.slice(0,C),s=k.slice(C)),m&&(s=s.replace(/0*$/,""));var P=parseInt(u,10);P>0?s.length<=P?(a+=s+=c(P-s.length),s=""):(a+=s.slice(0,P),s=s.slice(P)):P<0&&(s=c(Math.abs(P)-a.length)+a+s,a="0"),m||((s=s.slice(0,v)).length<v&&(s+=c(v-s.length)),a.length<g&&(a=c(g-a.length)+a));var j,E="";if(h)for(w=a;w.length;)f.length&&(j=f.shift()),E&&(E=S+E),E=w.slice(-j)+E,w=w.slice(0,-j);else E=a;return s&&(E=E+y+s),E}function u(e,t){return e.label.length>t.label.length?-1:e.label.length<t.label.length?1:0}l.cache={};var p={durationLabelsStandard:{S:"millisecond",SS:"milliseconds",s:"second",ss:"seconds",m:"minute",mm:"minutes",h:"hour",hh:"hours",d:"day",dd:"days",w:"week",ww:"weeks",M:"month",MM:"months",y:"year",yy:"years"},durationLabelsShort:{S:"msec",SS:"msecs",s:"sec",ss:"secs",m:"min",mm:"mins",h:"hr",hh:"hrs",d:"dy",dd:"dys",w:"wk",ww:"wks",M:"mo",MM:"mos",y:"yr",yy:"yrs"},durationTimeTemplates:{HMS:"h:mm:ss",HM:"h:mm",MS:"m:ss"},durationLabelTypes:[{type:"standard",string:"__"},{type:"short",string:"_"}],durationPluralKey:function(e,t,n){return 1===t&&null===n?e:e+e}};function h(e){return"[object Array]"===Object.prototype.toString.call(e)}function f(e){return"[object Object]"===Object.prototype.toString.call(e)}function m(e,t){var n,r=0,i=e&&e.length||0;for("function"!=typeof t&&(n=t,t=function(e){return e===n});r<i;){if(t(e[r]))return e[r];r+=1}}function g(e,t){var n=0,r=e.length;if(e&&r)for(;n<r;){if(!1===t(e[n],n))return;n+=1}}function v(e,t){var n=0,r=e.length,i=[];if(!e||!r)return i;for(;n<r;)i[n]=t(e[n],n),n+=1;return i}function S(e,t){return v(e,function(e){return e[t]})}function y(e){var t=[];return g(e,function(e){e&&t.push(e)}),t}function b(e){var t=[];return g(e,function(e){m(t,e)||t.push(e)}),t}function _(e,t){var n=[];return g(e,function(e){g(t,function(t){e===t&&n.push(e)})}),b(n)}function w(e,t){var n=[];return g(e,function(r,i){if(!t(r))return n=e.slice(i),!1}),n}function T(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function C(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}function x(e,t){var n=0,r=e.length;if(!e||!r)return!1;for(;n<r;){if(!0===t(e[n],n))return!0;n+=1}return!1}function R(e){return"3.6"===e(3.55,"en",{useGrouping:!1,minimumIntegerDigits:1,minimumFractionDigits:1,maximumFractionDigits:1})}function k(e){var t=!0;return!!(t=(t=(t=t&&"1"===e(1,"en",{minimumIntegerDigits:1}))&&"01"===e(1,"en",{minimumIntegerDigits:2}))&&"001"===e(1,"en",{minimumIntegerDigits:3}))&&(!!(t=(t=(t=(t=t&&"100"===e(99.99,"en",{maximumFractionDigits:0,minimumFractionDigits:0}))&&"100.0"===e(99.99,"en",{maximumFractionDigits:1,minimumFractionDigits:1}))&&"99.99"===e(99.99,"en",{maximumFractionDigits:2,minimumFractionDigits:2}))&&"99.990"===e(99.99,"en",{maximumFractionDigits:3,minimumFractionDigits:3}))&&(!!(t=(t=(t=(t=(t=t&&"100"===e(99.99,"en",{maximumSignificantDigits:1}))&&"100"===e(99.99,"en",{maximumSignificantDigits:2}))&&"100"===e(99.99,"en",{maximumSignificantDigits:3}))&&"99.99"===e(99.99,"en",{maximumSignificantDigits:4}))&&"99.99"===e(99.99,"en",{maximumSignificantDigits:5}))&&!!(t=(t=t&&"1,000"===e(1e3,"en",{useGrouping:!0}))&&"1000"===e(1e3,"en",{useGrouping:!1}))))}function P(){var e,t=[].slice.call(arguments),n={};if(g(t,function(t,r){if(!r){if(!h(t))throw"Expected array as the first argument to durationsFormat.";e=t}"string"!=typeof t&&"function"!=typeof t?"number"!=typeof t?f(t)&&T(n,t):n.precision=t:n.template=t}),!e||!e.length)return[];n.returnMomentTypes=!0;var r,i=v(e,function(e){return e.format(n)}),a=_(o,b(S((r=[],g(i,function(e){r=r.concat(e)}),r),"type"))),s=n.largest;return s&&(a=a.slice(0,s)),n.returnMomentTypes=!1,n.outputTypes=a,v(e,function(e){return e.format(n)})}function j(){var n=[].slice.call(arguments),i=T({},this.format.defaults),c=this.asMilliseconds(),l=this.asMonths();"function"==typeof this.isValid&&!1===this.isValid()&&(c=0,l=0);var R=c<0,k=e.duration(Math.abs(c),"milliseconds"),P=e.duration(Math.abs(l),"months");g(n,function(e){"string"!=typeof e&&"function"!=typeof e?"number"!=typeof e?f(e)&&T(i,e):i.precision=e:i.template=e});var j={years:"y",months:"M",weeks:"w",days:"d",hours:"h",minutes:"m",seconds:"s",milliseconds:"S"},E={escape:/\[(.+?)\]/,years:/\*?[Yy]+/,months:/\*?M+/,weeks:/\*?[Ww]+/,days:/\*?[Dd]+/,hours:/\*?[Hh]+/,minutes:/\*?m+/,seconds:/\*?s+/,milliseconds:/\*?S+/,general:/.+?/};i.types=o;var D=function(e){return m(o,function(t){return E[t].test(e)})},O=new RegExp(v(o,function(e){return E[e].source}).join("|"),"g");i.duration=this;var A="function"==typeof i.template?i.template.apply(i):i.template,M=i.outputTypes,I=i.returnMomentTypes,L=i.largest,N=[];M||(h(i.stopTrim)&&(i.stopTrim=i.stopTrim.join("")),i.stopTrim&&g(i.stopTrim.match(O),function(e){var t=D(e);"escape"!==t&&"general"!==t&&N.push(t)}));var $=e.localeData();$||($={}),g(C(p),function(e){"function"!=typeof p[e]?$["_"+e]||($["_"+e]=p[e]):$[e]||($[e]=p[e])}),g(C($._durationTimeTemplates),function(e){A=A.replace("_"+e+"_",$._durationTimeTemplates[e])});var B=i.userLocale||e.locale(),F=i.useLeftUnits,U=i.usePlural,H=i.precision,q=i.forceLength,z=i.useGrouping,J=i.trunc,V=i.useSignificantDigits&&H>0,G=V?i.precision:0,W=G,X=i.minValue,K=!1,Q=i.maxValue,Y=!1,Z=i.useToLocaleString,ee=i.groupingSeparator,te=i.decimalSeparator,ne=i.grouping;Z=Z&&(t||r);var re=i.trim;h(re)&&(re=re.join(" ")),null===re&&(L||Q||V)&&(re="all"),null!==re&&!0!==re&&"left"!==re&&"right"!==re||(re="large"),!1===re&&(re="");var ie=function(e){return e.test(re)},oe=/both/,ae=/^all|[^sm]all/,se=L>0||x([/large/,oe,ae],ie),ce=x([/small/,oe,ae],ie),le=x([/mid/,ae],ie),de=x([/final/,ae],ie),ue=v(A.match(O),function(e,t){var n=D(e);return"*"===e.slice(0,1)&&(e=e.slice(1),"escape"!==n&&"general"!==n&&N.push(n)),{index:t,length:e.length,text:"",token:"escape"===n?e.replace(E.escape,"$1"):e,type:"escape"===n||"general"===n?null:n}}),pe={index:0,length:0,token:"",text:"",type:null},he=[];F&&ue.reverse(),g(ue,function(e){if(e.type)return(pe.type||pe.text)&&he.push(pe),void(pe=e);F?pe.text=e.token+pe.text:pe.text+=e.token}),(pe.type||pe.text)&&he.push(pe),F&&he.reverse();var fe=_(o,b(y(S(he,"type"))));if(!fe.length)return S(he,"text").join("");fe=v(fe,function(e,t){var n,r=t+1===fe.length,o=!t;n="years"===e||"months"===e?P.as(e):k.as(e);var a=Math.floor(n),s=n-a,c=m(he,function(t){return e===t.type});return o&&Q&&n>Q&&(Y=!0),r&&X&&Math.abs(i.duration.as(e))<X&&(K=!0),o&&null===q&&c.length>1&&(q=!0),k.subtract(a,e),P.subtract(a,e),{rawValue:n,wholeValue:a,decimalValue:r?s:0,isSmallest:r,isLargest:o,type:e,tokenLength:c.length}});var me,ge=J?Math.floor:Math.round,ve=function(e,t){var n=Math.pow(10,t);return ge(e*n)/n},Se=!1,ye=!1,be=function(e,t){var n={useGrouping:z,groupingSeparator:ee,decimalSeparator:te,grouping:ne,useToLocaleString:Z};return V&&(G<=0?(e.rawValue=0,e.wholeValue=0,e.decimalValue=0):(n.maximumSignificantDigits=G,e.significantDigits=G)),Y&&!ye&&(e.isLargest?(e.wholeValue=Q,e.decimalValue=0):(e.wholeValue=0,e.decimalValue=0)),K&&!ye&&(e.isSmallest?(e.wholeValue=X,e.decimalValue=0):(e.wholeValue=0,e.decimalValue=0)),e.isSmallest||e.significantDigits&&e.significantDigits-e.wholeValue.toString().length<=0?H<0?e.value=ve(e.wholeValue,H):0===H?e.value=ge(e.wholeValue+e.decimalValue):V?(e.value=J?ve(e.rawValue,G-e.wholeValue.toString().length):e.rawValue,e.wholeValue&&(G-=e.wholeValue.toString().length)):(n.fractionDigits=H,e.value=J?e.wholeValue+ve(e.decimalValue,H):e.wholeValue+e.decimalValue):V&&e.wholeValue?(e.value=Math.round(ve(e.wholeValue,e.significantDigits-e.wholeValue.toString().length)),G-=e.wholeValue.toString().length):e.value=e.wholeValue,e.tokenLength>1&&(q||Se)&&(n.minimumIntegerDigits=e.tokenLength,ye&&n.maximumSignificantDigits<e.tokenLength&&delete n.maximumSignificantDigits),!Se&&(e.value>0||""===re||m(N,e.type)||m(M,e.type))&&(Se=!0),e.formattedValue=d(e.value,n,B),n.useGrouping=!1,n.decimalSeparator=".",e.formattedValueEn=d(e.value,n,"en"),2===e.tokenLength&&"milliseconds"===e.type&&(e.formattedValueMS=d(e.value,{minimumIntegerDigits:3,useGrouping:!1},"en").slice(0,2)),e};if((fe=y(fe=v(fe,be))).length>1){var _e=function(e){return m(fe,function(t){return t.type===e})};g(a,function(e){var t=_e(e.type);t&&g(e.targets,function(e){var n=_e(e.type);n&&parseInt(t.formattedValueEn,10)===e.value&&(t.rawValue=0,t.wholeValue=0,t.decimalValue=0,n.rawValue+=1,n.wholeValue+=1,n.decimalValue=0,n.formattedValueEn=n.wholeValue.toString(),ye=!0)})})}return ye&&(Se=!1,G=W,fe=y(fe=v(fe,be))),!M||Y&&!i.trim?(se&&(fe=w(fe,function(e){return!e.isSmallest&&!e.wholeValue&&!m(N,e.type)})),L&&fe.length&&(fe=fe.slice(0,L)),ce&&fe.length>1&&(me=function(e){return!e.wholeValue&&!m(N,e.type)&&!e.isLargest},fe=w(fe.slice().reverse(),me).reverse()),le&&(fe=y(fe=v(fe,function(e,t){return t>0&&t<fe.length-1&&!e.wholeValue?null:e}))),!de||1!==fe.length||fe[0].wholeValue||!J&&fe[0].isSmallest&&fe[0].rawValue<X||(fe=[])):fe=y(fe=v(fe,function(e){return m(M,function(t){return e.type===t})?e:null})),I?fe:(g(he,function(e){var t=j[e.type],n=m(fe,function(t){return t.type===e.type});if(t&&n){var r=n.formattedValueEn.split(".");r[0]=parseInt(r[0],10),r[1]?r[1]=parseFloat("0."+r[1],10):r[1]=null;var i=$.durationPluralKey(t,r[0],r[1]),o=function(e,t){var n=[];return g(C(t),function(r){if("_durationLabels"===r.slice(0,15)){var i=r.slice(15).toLowerCase();g(C(t[r]),function(o){o.slice(0,1)===e&&n.push({type:i,key:o,label:t[r][o]})})}}),n}(t,$),a=!1,c={};g($._durationLabelTypes,function(t){var n=m(o,function(e){return e.type===t.type&&e.key===i});n&&(c[n.type]=n.label,s(e.text,t.string)&&(e.text=e.text.replace(t.string,n.label),a=!0))}),U&&!a&&(o.sort(u),g(o,function(t){return c[t.type]===t.label?!s(e.text,t.label)&&void 0:s(e.text,t.label)?(e.text=e.text.replace(t.label,c[t.type]),!1):void 0}))}}),(he=v(he,function(e){if(!e.type)return e.text;var t=m(fe,function(t){return t.type===e.type});if(!t)return"";var n="";return F&&(n+=e.text),(R&&Y||!R&&K)&&(n+="< ",Y=!1,K=!1),(R&&K||!R&&Y)&&(n+="> ",Y=!1,K=!1),R&&(t.value>0||""===re||m(N,t.type)||m(M,t.type))&&(n+="-",R=!1),"milliseconds"===e.type&&t.formattedValueMS?n+=t.formattedValueMS:n+=t.formattedValue,F||(n+=e.text),n})).join("").replace(/(,| |:|\.)*$/,"").replace(/^(,| |:|\.)*/,""))}function E(){var e=this.duration,t=function(t){return e._data[t]},n=m(this.types,t),r=function(e,t){for(var n=e.length;n-=1;)if(t(e[n]))return e[n]}(this.types,t);switch(n){case"milliseconds":return"S __";case"seconds":case"minutes":return"*_MS_";case"hours":return"_HMS_";case"days":if(n===r)return"d __";case"weeks":return n===r?"w __":(null===this.trim&&(this.trim="both"),"w __, d __, h __");case"months":if(n===r)return"M __";case"years":return n===r?"y __":(null===this.trim&&(this.trim="both"),"y __, M __, d __");default:return null===this.trim&&(this.trim="both"),"y __, d __, h __, m __, s __"}}function D(e){if(!e)throw"Moment Duration Format init cannot find moment instance.";e.duration.format=P,e.duration.fn.format=j,e.duration.fn.format.defaults={trim:null,stopTrim:null,largest:null,maxValue:null,minValue:null,precision:0,trunc:!1,forceLength:null,userLocale:null,usePlural:!0,useLeftUnits:!1,useGrouping:!0,useSignificantDigits:!1,template:E,useToLocaleString:!0,groupingSeparator:",",decimalSeparator:".",grouping:[3]},e.updateLocale("en",p)}var O=function(e,t,n){return e.toLocaleString(t,n)};t=function(){try{(0).toLocaleString("i")}catch(e){return"RangeError"===e.name}return!1}()&&k(O),n=t&&R(O);var A=function(e,t,n){if("undefined"!=typeof window&&window&&window.Intl&&window.Intl.NumberFormat)return window.Intl.NumberFormat(t,n).format(e)};return r=k(A),i=r&&R(A),D(e),D}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).adapter=e()}}(function(){return function(){return function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[a]={exports:{}};t[a][0].call(d.exports,function(e){return i(t[a][1][e]||e)},d,d.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}}()({1:[function(e,t,n){"use strict";var r=(0,e("./adapter_factory.js").adapterFactory)({window:window});t.exports=r},{"./adapter_factory.js":2}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=r.log,l=r.detectBrowser(e),d={browserDetails:l,commonShim:c,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(l.browser){case"chrome":if(!i||!i.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),d;n("adapter.js shimming chrome."),d.browserShim=i,i.shimGetUserMedia(e),i.shimMediaStream(e),i.shimPeerConnection(e),i.shimOnTrack(e),i.shimAddTrackRemoveTrack(e),i.shimGetSendersWithDtmf(e),i.shimGetStats(e),i.shimSenderReceiverGetStats(e),i.fixNegotiationNeeded(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;case"firefox":if(!a||!a.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),d;n("adapter.js shimming firefox."),d.browserShim=a,a.shimGetUserMedia(e),a.shimPeerConnection(e),a.shimOnTrack(e),a.shimRemoveStream(e),a.shimSenderGetStats(e),a.shimReceiverGetStats(e),a.shimRTCDataChannel(e),a.shimAddTransceiver(e),a.shimCreateOffer(e),a.shimCreateAnswer(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"edge":if(!o||!o.shimPeerConnection||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),d;n("adapter.js shimming edge."),d.browserShim=o,o.shimGetUserMedia(e),o.shimGetDisplayMedia(e),o.shimPeerConnection(e),o.shimReplaceTrack(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"safari":if(!s||!t.shimSafari)return n("Safari shim is not included in this adapter release."),d;n("adapter.js shimming safari."),d.browserShim=s,s.shimRTCIceServerUrls(e),s.shimCreateOfferLegacy(e),s.shimCallbacksAPI(e),s.shimLocalStreamsAPI(e),s.shimRemoteStreamsAPI(e),s.shimTrackEventTransceiver(e),s.shimGetUserMedia(e),c.shimRTCIceCandidate(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;default:n("Unsupported browser!")}return d};var r=l(e("./utils")),i=l(e("./chrome/chrome_shim")),o=l(e("./edge/edge_shim")),a=l(e("./firefox/firefox_shim")),s=l(e("./safari/safari_shim")),c=l(e("./common_shim"));function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(e){if("object"!==(void 0===e?"undefined":r(e))||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)a.wrapPeerConnectionEvent(e,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",function(r){var i=void 0;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.track.id}):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}),t.stream.getTracks().forEach(function(r){var i=void 0;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.id}):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},n.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach(function(e){n._senders.push(t(n,e))})};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach(function(e){var n=t._senders.find(function(t){return t.track===e});n&&t._senders.splice(t._senders.indexOf(n),1)})}}else if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function(e){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,n=Array.prototype.slice.call(arguments),r=n[0],i=n[1],o=n[2];if(arguments.length>0&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var a=function(e){var t={},n=e.result();return n.forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){return t.apply(this,[function(e){i(s(a(e)))},r])}return new Promise(function(n,r){t.apply(e,[function(e){n(s(a(e)))},r])}).then(i,o)}},n.shimSenderReceiverGetStats=function(e){if(!("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach(function(t){return t._pc=e}),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return a.filterStats(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t}),a.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return a.filterStats(t,e.track,!1)})}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],n=void 0,r=void 0,i=void 0;return this.getSenders().forEach(function(e){e.track===t&&(n?i=!0:n=e)}),this.getReceivers().forEach(function(e){return e.track===t&&(r?i=!0:r=e),e.track===t}),i||n&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}},n.shimAddTrackRemoveTrackWithNative=c,n.shimAddTrackRemoveTrack=function(e){if(!e.RTCPeerConnection)return;var t=a.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return c(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(function(e){var t=n.getSenders().find(function(t){return t.track===e});if(t)throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}r.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var o=this.getSenders().find(function(e){return e.track===t});if(o)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var a=this._streams[n.id];if(a)a.addTrack(t),Promise.resolve().then(function(){r.dispatchEvent(new Event("negotiationneeded"))});else{var s=new e.MediaStream([t]);this._streams[n.id]=s,this._reverseStreams[s.id]=n,this.addStream(s)}return this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t],r=s({},t,function(){var e=this,t=arguments,r=arguments.length&&"function"==typeof arguments[0];return r?n.apply(this,[function(n){var r=o(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then(function(t){return o(e,t)})});e.RTCPeerConnection.prototype[t]=r[t]});var l=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,t=arguments[0],n=t.sdp,Object.keys(e._reverseStreams||[]).forEach(function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})),l.apply(this,arguments)):l.apply(this,arguments);var e,t,n};var d=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=d.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var n=e._pc===this;if(!n)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var r=void 0;Object.keys(this._streams).forEach(function(n){var i=t._streams[n].getTracks().find(function(t){return e.track===t});i&&(r=t._streams[n])}),r&&(1===r.getTracks().length?this.removeStream(this._reverseStreams[r.id]):r.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}},n.shimPeerConnection=function(e){var t=a.detectBrowser(e);!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection);if(!e.RTCPeerConnection)return;var n=0===e.RTCPeerConnection.prototype.addIceCandidate.length;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t],r=s({},t,function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=r[t]});var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return n||arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},n.fixNegotiationNeeded=function(e){a.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){var t=e.target;if("stable"===t.signalingState)return e})};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js"));function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(e){if(t.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter(function(e){return-1===r.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]}),i.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;if("function"!=typeof t)return void console.error("shimGetDisplayMedia: getSourceId argument is not a function");e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)})}}},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(!t.mediaDevices)return;var n=i.detectBrowser(e),a=function(e){if("object"!==(void 0===e?"undefined":r(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i="object"===r(e[n])?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];var a={};"number"==typeof i.ideal?(a[o("min",n)]=i.ideal,t.optional.push(a),(a={})[o("max",n)]=i.ideal,t.optional.push(a)):(a[o("",n)]=i.ideal,t.optional.push(a))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=i.exact):["min","max"].forEach(function(e){void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=i[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,i){if(n.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===r(e.audio)){var s=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};e=JSON.parse(JSON.stringify(e)),s(e.audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=a(e.audio)}if(e&&"object"===r(e.video)){var c=e.video.facingMode;c=c&&("object"===(void 0===c?"undefined":r(c))?c:{ideal:c});var l=n.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||l)){delete e.video.facingMode;var d=void 0;if("environment"===c.exact||"environment"===c.ideal?d=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(d=["front"]),d)return t.mediaDevices.enumerateDevices().then(function(t){var n=(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return d.some(function(t){return e.label.toLowerCase().includes(t)})});return!n&&t.length&&d.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=c.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=a(e.video),o("chrome: "+JSON.stringify(e)),i(e)})}e.video=a(e.video)}return o("chrome: "+JSON.stringify(e)),i(e)},c=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,n,r){s(e,function(e){t.webkitGetUserMedia(e,n,function(e){r&&r(c(e))})})}.bind(t),t.mediaDevices.getUserMedia){var l=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,function(e){return l(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(c(e))})})}}};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js"));var o=i.log},{"../utils.js":15}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimRTCIceCandidate=function(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":r(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),i=a.default.parseCandidate(e.candidate),o=Object.assign(n,i);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,s.wrapPeerConnectionEvent(e,"icecandidate",function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t})},n.shimMaxMessageSize=function(e){if(!e.RTCPeerConnection)return;var t=s.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),r=e.sdpSemantics;"plan-b"===r&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=a.default.splitSections(e.sdp);return t.shift(),t.some(function(e){var t=a.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){var i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),o=function(e){var n=65536;"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637);return n}(i),s=function(e,n){var r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);var i=a.default.matchPrefix(e.sdp,"a=max-message-size:");i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637);return r}(arguments[0],i),c=void 0;c=0===o&&0===s?Number.POSITIVE_INFINITY:0===o||0===s?Math.max(o,s):Math.min(o,s);var l={};Object.defineProperty(l,"maxMessageSize",{get:function(){return c}}),this._sctp=l}return n.apply(this,arguments)}},n.shimSendThrowTypeError=function(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}var n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=n.apply(this,arguments);return t(e,this),e},s.wrapPeerConnectionEvent(e,"datachannel",function(e){return t(e.channel,e.target),e})},n.shimConnectionState=function(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})},n.removeAllowExtmapMixed=function(e){if(!e.RTCPeerConnection)return;var t=s.detectBrowser(e);if("chrome"===t.browser&&t.version>=71)return;var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n")),n.apply(this,arguments)}};var i,o=e("sdp"),a=(i=o)&&i.__esModule?i:{default:i},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var r=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),n.shimPeerConnection=function(e){var t=a.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}});e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var r=(0,l.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,s.filterIceServers)(e.iceServers,t.version),a.log("ICE servers after filtering:",e.iceServers)),new r(e)},e.RTCPeerConnection.prototype=r.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var o,a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils")),s=e("./filtericeservers"),c=e("rtcpeerconnection-shim"),l=(o=c)&&o.__esModule?o:{default:o}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof t;return i&&(t=[t]),t=t.filter(function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n}),delete e.url,e.urls=i?t[0]:t,!!t.length}})};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){if(!("getDisplayMedia"in e.navigator))return;if(!e.navigator.mediaDevices)return;if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)}},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),n.shimOnTrack=function(e){"object"===(void 0===e?"undefined":r(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(e){var t=a.detectBrowser(e);if("object"!==(void 0===e?"undefined":r(e))||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection);t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t],r=function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},t,function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=r[t]});if(t.version<68){var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),n=e[0],r=e[1],a=e[2];return o.apply(this,[n||null]).then(function(e){if(t.version<53&&!r)try{e.forEach(function(e){e.type=i[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach(function(t,n){e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))})}return e}).then(r,a)}},n.shimSenderGetStats=function(e){if("object"!==(void 0===e?"undefined":r(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach(function(t){return t._pc=e}),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e});e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}},n.shimReceiverGetStats=function(e){if("object"!==(void 0===e?"undefined":r(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach(function(t){return t._pc=e}),n});a.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},n.shimRemoveStream=function(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype)return;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;a.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)})}},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){if("object"!==(void 0===e?"undefined":r(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach(function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});var r=t.apply(this,arguments);if(n){var i=r.sender,o=i.getParameters();"encodings"in o||(o.encodings=e.sendEncodings,this.setParametersPromises.push(i.setParameters(o).catch(function(){})))}return r})},n.shimCreateOffer=function(e){if("object"!==(void 0===e?"undefined":r(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return t.apply(e,n)}).finally(function(){e.setParametersPromises=[]}):t.apply(this,arguments)}},n.shimCreateAnswer=function(e){if("object"!==(void 0===e?"undefined":r(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return t.apply(e,n)}).finally(function(){e.setParametersPromises=[]}):t.apply(this,arguments)}};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)}}},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimGetUserMedia=function(e){var t=i.detectBrowser(e),n=e&&e.navigator,o=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){i.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":r(e))&&"object"===r(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},o&&o.prototype.getSettings){var c=o.prototype.getSettings;o.prototype.getSettings=function(){var e=c.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var l=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":r(e))&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[e])}}}};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimLocalStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":r(e))||!e.RTCPeerConnection)return;"getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams});if(!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(function(r){return t.call(n,r,e)}),e.getVideoTracks().forEach(function(r){return t.call(n,r,e)})},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=this,r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return i&&i.forEach(function(e){n._localStreams?n._localStreams.includes(e)||n._localStreams.push(e):n._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach(function(e){r.includes(e.track)&&t.removeTrack(e)})}})},n.shimRemoteStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":r(e))||!e.RTCPeerConnection)return;"getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]});if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}})}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function(e){if("object"!==(void 0===e?"undefined":r(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,o=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r};var c=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=c,c=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=c,c=function(e,t,n){var r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=c},n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(o(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))},n.shimConstraints=o,n.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var r=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(i.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,r.push(a)):r.push(e.iceServers[o])}e.iceServers=r}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},n.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":r(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"));function o(e){return e&&void 0!==e.video?Object.assign({},e,{video:i.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.extractVersion=a,n.wrapPeerConnectionEvent=function(e,t,n){if(!e.RTCPeerConnection)return;var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=o,i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return o.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})},n.disableLog=function(e){if("boolean"!=typeof e)return new Error("Argument type: "+(void 0===e?"undefined":r(e))+". Please use a boolean.");return i=e,e?"adapter.js logging disabled":"adapter.js logging enabled"},n.disableWarnings=function(e){if("boolean"!=typeof e)return new Error("Argument type: "+(void 0===e?"undefined":r(e))+". Please use a boolean.");return o=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")},n.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(e,t){if(!o)return;console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var t=e.navigator,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n},n.compactObject=function e(t){if(!s(t))return t;return Object.keys(t).reduce(function(n,r){var i=s(t[r]),o=i?e(t[r]):t[r],a=i&&!Object.keys(o).length;return void 0===o||a?n:Object.assign(n,function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},r,o))},{})},n.walkStats=c,n.filterStats=function(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(function(t){e.forEach(function(n){n.type===r&&n.trackId===t.id&&c(e,n,i)})}),i};var i=!0,o=!0;function a(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(function(r){r.endsWith("Id")?c(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(function(t){c(e,e.get(t),n)})}))}},{}],16:[function(e,t,n){"use strict";var r=e("sdp");function i(e,t,n,i,o){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(i?i.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach(function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function l(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout(function(){t._dispatchEvent("track",o)})}var d=function(n){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){i[e]=o[e].bind(o)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)}),delete e.url,e.urls=i?r[0]:r,!!r.length}})}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(d.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(d.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),d.prototype.onicecandidate=null,d.prototype.onaddstream=null,d.prototype.ontrack=null,d.prototype.onremovestream=null,d.prototype.onsignalingstatechange=null,d.prototype.oniceconnectionstatechange=null,d.prototype.onconnectionstatechange=null,d.prototype.onicegatheringstatechange=null,d.prototype.onnegotiationneeded=null,d.prototype.ondatachannel=null,d.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},d.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},d.prototype.getConfiguration=function(){return this._config},d.prototype.getLocalStreams=function(){return this.localStreams},d.prototype.getRemoteStreams=function(){return this.remoteStreams},d.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},d.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find(function(e){return e.track===t}))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},d.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach(function(t){n.addTrack(t,e)});else{var r=e.clone();e.getTracks().forEach(function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),r.getTracks().forEach(function(e){n.addTrack(e,r)})}},d.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find(function(e){return e.rtpSender===t});if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},d.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var n=t.getSenders().find(function(t){return t.track===e});n&&t.removeTrack(n)})},d.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},d.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},d.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},d.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var l=r.writeCandidate(s);a.candidate=Object.assign(a.candidate,r.parseCandidate(l)),a.candidate.candidate=l,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var d=r.getMediaSections(i._localDescription.sdp);d[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+d.join("");var u=i.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",a),u&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout(function(){a.forEach(function(e){o.onlocalcandidate(e)})},0)}},d.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},d.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},d.prototype._transceive=function(e,n,i){var a=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),i&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},d.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n}),i.transceivers.forEach(function(e,t){i._gather(e.mid,t)});else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var s=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var a=i.transceivers[t],c=a.iceGatherer,l=a.iceTransport,d=a.dtlsTransport,u=a.localCapabilities,p=a.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length)&&!a.rejected){var h=r.getIceParameters(e,n),f=r.getDtlsParameters(e,n);s&&(f.role="server"),i.usingBundle&&0!==t||(i._gather(a.mid,t),"new"===l.state&&l.start(c,h,s?"controlling":"controlled"),"new"===d.state&&d.start(f));var m=o(u,p);i._transceive(a,m.codecs.length>0,!1)}})}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},d.prototype.setRemoteDescription=function(i){var d=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!a("setRemoteDescription",i.type,d.signalingState)||d._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+d.signalingState));var u={};d.remoteStreams.forEach(function(e){u[e.id]=e});var p=[],h=r.splitSections(i.sdp),f=h.shift(),m=r.matchPrefix(f,"a=ice-lite").length>0,g=r.matchPrefix(f,"a=group:BUNDLE ").length>0;d.usingBundle=g;var v=r.matchPrefix(f,"a=ice-options:")[0];return d.canTrickleIceCandidates=!!v&&v.substr(14).split(" ").indexOf("trickle")>=0,h.forEach(function(a,c){var l=r.splitLines(a),h=r.getKind(a),v=r.isRejected(a)&&0===r.matchPrefix(a,"a=bundle-only").length,S=l[0].substr(2).split(" ")[2],y=r.getDirection(a,f),b=r.parseMsid(a),_=r.getMid(a)||r.generateIdentifier();if(v||"application"===h&&("DTLS/SCTP"===S||"UDP/DTLS/SCTP"===S))d.transceivers[c]={mid:_,kind:h,protocol:S,rejected:!0};else{var w,T,C,x,R,k,P,j,E;!v&&d.transceivers[c]&&d.transceivers[c].rejected&&(d.transceivers[c]=d._createTransceiver(h,!0));var D,O,A=r.parseRtpParameters(a);v||(D=r.getIceParameters(a,f),(O=r.getDtlsParameters(a,f)).role="client"),P=r.parseRtpEncodingParameters(a);var M=r.parseRtcpParameters(a),I=r.matchPrefix(a,"a=end-of-candidates",f).length>0,L=r.matchPrefix(a,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===i.type||"answer"===i.type)&&!v&&g&&c>0&&d.transceivers[c]&&(d._disposeIceAndDtlsTransports(c),d.transceivers[c].iceGatherer=d.transceivers[0].iceGatherer,d.transceivers[c].iceTransport=d.transceivers[0].iceTransport,d.transceivers[c].dtlsTransport=d.transceivers[0].dtlsTransport,d.transceivers[c].rtpSender&&d.transceivers[c].rtpSender.setTransport(d.transceivers[0].dtlsTransport),d.transceivers[c].rtpReceiver&&d.transceivers[c].rtpReceiver.setTransport(d.transceivers[0].dtlsTransport)),"offer"!==i.type||v){if("answer"===i.type&&!v){T=(w=d.transceivers[c]).iceGatherer,C=w.iceTransport,x=w.dtlsTransport,R=w.rtpReceiver,k=w.sendEncodingParameters,j=w.localCapabilities,d.transceivers[c].recvEncodingParameters=P,d.transceivers[c].remoteCapabilities=A,d.transceivers[c].rtcpParameters=M,L.length&&"new"===C.state&&(!m&&!I||g&&0!==c?L.forEach(function(e){s(w.iceTransport,e)}):C.setRemoteCandidates(L)),g&&0!==c||("new"===C.state&&C.start(T,D,"controlling"),"new"===x.state&&x.start(O)),!o(w.localCapabilities,w.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&w.sendEncodingParameters[0].rtx&&delete w.sendEncodingParameters[0].rtx,d._transceive(w,"sendrecv"===y||"recvonly"===y,"sendrecv"===y||"sendonly"===y),!R||"sendrecv"!==y&&"sendonly"!==y?delete w.rtpReceiver:(E=R.track,b?(u[b.stream]||(u[b.stream]=new e.MediaStream),n(E,u[b.stream]),p.push([E,R,u[b.stream]])):(u.default||(u.default=new e.MediaStream),n(E,u.default),p.push([E,R,u.default])))}}else{(w=d.transceivers[c]||d._createTransceiver(h)).mid=_,w.iceGatherer||(w.iceGatherer=d._createIceGatherer(c,g)),L.length&&"new"===w.iceTransport.state&&(!I||g&&0!==c?L.forEach(function(e){s(w.iceTransport,e)}):w.iceTransport.setRemoteCandidates(L)),j=e.RTCRtpReceiver.getCapabilities(h),t<15019&&(j.codecs=j.codecs.filter(function(e){return"rtx"!==e.name})),k=w.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var N,$=!1;if("sendrecv"===y||"sendonly"===y){if($=!w.rtpReceiver,R=w.rtpReceiver||new e.RTCRtpReceiver(w.dtlsTransport,h),$)E=R.track,b&&"-"===b.stream||(b?(u[b.stream]||(u[b.stream]=new e.MediaStream,Object.defineProperty(u[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(E,"id",{get:function(){return b.track}}),N=u[b.stream]):(u.default||(u.default=new e.MediaStream),N=u.default)),N&&(n(E,N),w.associatedRemoteMediaStreams.push(N)),p.push([E,R,N])}else w.rtpReceiver&&w.rtpReceiver.track&&(w.associatedRemoteMediaStreams.forEach(function(t){var n,r,i=t.getTracks().find(function(e){return e.id===w.rtpReceiver.track.id});i&&(n=i,(r=t).removeTrack(n),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:n})))}),w.associatedRemoteMediaStreams=[]);w.localCapabilities=j,w.remoteCapabilities=A,w.rtpReceiver=R,w.rtcpParameters=M,w.sendEncodingParameters=k,w.recvEncodingParameters=P,d._transceive(d.transceivers[c],!1,$)}}}),void 0===d._dtlsRole&&(d._dtlsRole="offer"===i.type?"active":"passive"),d._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?d._updateSignalingState("have-remote-offer"):d._updateSignalingState("stable"),Object.keys(u).forEach(function(t){var n=u[t];if(n.getTracks().length){if(-1===d.remoteStreams.indexOf(n)){d.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout(function(){d._dispatchEvent("addstream",r)})}p.forEach(function(e){var t=e[0],r=e[1];n.id===e[2].id&&l(d,t,r,[n])})}}),p.forEach(function(e){e[2]||l(d,e[0],e[1],[])}),e.setTimeout(function(){d&&d.transceivers&&d.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},d.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},d.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},d.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},d.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},d.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},d.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=n.transceivers.filter(function(e){return"audio"===e.kind}).length,a=n.transceivers.filter(function(e){return"video"===e.kind}).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(o=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(n.transceivers.forEach(function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)});o>0||a>0;)o>0&&(n._createTransceiver("audio"),o--),a>0&&(n._createTransceiver("video"),a--);var l=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach(function(i,o){var a=i.track,s=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(o,n.usingBundle));var l=e.RTCRtpSender.getCapabilities(s);t<15019&&(l.codecs=l.codecs.filter(function(e){return"rtx"!==e.name})),l.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),l.headerExtensions.forEach(function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var d=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&"video"===s&&!d[0].rtx&&(d[0].rtx={ssrc:d[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=l,i.sendEncodingParameters=d}),"max-compat"!==n._config.bundlePolicy&&(l+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),l+="a=ice-options:trickle\r\n",n.transceivers.forEach(function(e,t){l+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),l+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,l+="a="+r.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(l+="a=end-of-candidates\r\n"))});var d=new e.RTCSessionDescription({type:"offer",sdp:l});return Promise.resolve(d)},d.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var s=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach(function(e,r){if(!(r+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;if(e.stream)"audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var l=o(e.localCapabilities,e.remoteCapabilities);!l.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=i(e,l,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}});var l=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(l)},d.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(i,o){if(!n._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var l=0;l<n.transceivers.length;l++)if(n.transceivers[l].mid===e.sdpMid){a=l;break}var d=n.transceivers[a];if(!d)return o(c("OperationError","Can not add ICE candidate"));if(d.rejected)return i();var u=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===u.protocol&&(0===u.port||9===u.port))return i();if(u.component&&1!==u.component)return i();if((0===a||a>0&&d.iceTransport!==n.transceivers[0].iceTransport)&&!s(d.iceTransport,u))return o(c("OperationError","Can not add ICE candidate"));var p=e.candidate.trim();0===p.indexOf("a=")&&(p=p.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(u.type?p:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var h=0;h<n.transceivers.length&&(n.transceivers[h].rejected||(n.transceivers[h].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[h]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));h++);i()})},d.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)}),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&r.push(e[t].getStats())})}),Promise.all(r).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then(function(e){var t=new Map;return Object.keys(e).forEach(function(n){var r;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=e[n]).type]||r.type,t.set(n,e[n])}),t})}}});var u=["createOffer","createAnswer"];return u.forEach(function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(u=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),d}},{sdp:17}],17:[function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},r.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},r.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?r.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},r.getCryptoParameters=function(e,t){return r.matchPrefix(e+t,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(e,t){var n=r.matchPrefix(e+t,"a=ice-ufrag:")[0],i=r.matchPrefix(e+t,"a=ice-pwd:")[0];return n&&i?{usernameFragment:n.substr(12),password:i.substr(10)}:null},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});var i=0;return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,l=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});l.length>0&&l[0].length>1&&l[0][0]===c&&(t=l[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},n.push(r))}}),0===n.length&&c&&n.push({ssrc:c});var d=r.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=d})),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),i=r.matchPrefix(e,"a=max-message-size:");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var o=r.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var a=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=r)},{}]},{},[1])(1)}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.strophe=t():e.strophe=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){void 0!==Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/strophe.js")}({"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./src/bosh.js":function(e,t,n){"use strict";n.r(t);var r=n("./src/core.js"),i=r.default.Strophe,o=r.default.$build;i.Request=function(e,t,n,r){this.id=++i._requestId,this.xmlData=e,this.data=i.serialize(e),this.origFunc=t,this.func=t,this.rid=n,this.date=NaN,this.sends=r||0,this.abort=!1,this.dead=null,this.age=function(){return this.date?(new Date-this.date)/1e3:0},this.timeDead=function(){return this.dead?(new Date-this.dead)/1e3:0},this.xhr=this._newXHR()},i.Request.prototype={getResponse:function(){var e=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if("parsererror"===(e=this.xhr.responseXML.documentElement).tagName)throw i.error("invalid response received"),i.error("responseText: "+this.xhr.responseText),i.error("responseXML: "+i.serialize(this.xhr.responseXML)),new Error("parsererror")}else if(this.xhr.responseText){if(i.debug("Got responseText but no responseXML; attempting to parse it with DOMParser..."),!(e=(new DOMParser).parseFromString(this.xhr.responseText,"application/xml").documentElement))throw new Error("Parsing produced null node");if(e.querySelector("parsererror")){i.error("invalid response received: "+e.querySelector("parsererror").textContent),i.error("responseText: "+this.xhr.responseText);var t=new Error;throw t.name=i.ErrorCondition.BAD_FORMAT,t}}return e},_newXHR:function(){var e=null;return window.XMLHttpRequest?(e=new XMLHttpRequest).overrideMimeType&&e.overrideMimeType("text/xml; charset=utf-8"):window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),e.onreadystatechange=this.func.bind(null,this),e}},i.Bosh=function(e){this._conn=e,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this.inactivity=null,this.lastResponseHeaders=null,this._requests=[]},i.Bosh.prototype={strip:null,_buildBody:function(){var e=o("body",{rid:this.rid++,xmlns:i.NS.HTTPBIND});return null!==this.sid&&e.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),e},_reset:function(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_connect:function(e,t,n){this.wait=e||this.wait,this.hold=t||this.hold,this.errors=0;var r=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":i.NS.BOSH});n&&r.attrs({route:n});var o=this._conn._connect_cb;this._requests.push(new i.Request(r.tree(),this._onRequestStateChange.bind(this,o.bind(this._conn)),r.tree().getAttribute("rid"))),this._throttledRequestHandler()},_attach:function(e,t,n,r,o,a,s){this._conn.jid=e,this.sid=t,this.rid=n,this._conn.connect_callback=r,this._conn.domain=i.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=o||this.wait,this.hold=a||this.hold,this.window=s||this.window,this._conn._changeConnectStatus(i.Status.ATTACHED,null)},_restore:function(e,t,n,r,o){var a=JSON.parse(window.sessionStorage.getItem("strophe-bosh-session"));if(!(null!=a&&a.rid&&a.sid&&a.jid&&(null==e||i.getBareJidFromJid(a.jid)===i.getBareJidFromJid(e)||null===i.getNodeFromJid(e)&&i.getDomainFromJid(a.jid)===e))){var s=new Error("_restore: no restoreable session.");throw s.name="StropheSessionError",s}this._conn.restored=!0,this._attach(a.jid,a.sid,a.rid,t,n,r,o)},_cacheSession:function(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&window.sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):window.sessionStorage.removeItem("strophe-bosh-session")},_connect_cb:function(e){var t=e.getAttribute("type");if(null!==t&&"terminate"===t){var n=e.getAttribute("condition");i.error("BOSH-Connection failed: "+n);var r=e.getElementsByTagName("conflict");return null!==n?("remote-stream-error"===n&&r.length>0&&(n="conflict"),this._conn._changeConnectStatus(i.Status.CONNFAIL,n)):this._conn._changeConnectStatus(i.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(n),i.Status.CONNFAIL}this.sid||(this.sid=e.getAttribute("sid"));var o=e.getAttribute("requests");o&&(this.window=parseInt(o,10));var a=e.getAttribute("hold");a&&(this.hold=parseInt(a,10));var s=e.getAttribute("wait");s&&(this.wait=parseInt(s,10));var c=e.getAttribute("inactivity");c&&(this.inactivity=parseInt(c,10))},_disconnect:function(e){this._sendTerminate(e)},_doDisconnect:function(){this.sid=null,this.rid=Math.floor(4294967295*Math.random()),this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_emptyQueue:function(){return 0===this._requests.length},_callProtocolErrorHandlers:function(e){var t=this._getRequestStatus(e),n=this._conn.protocolErrorHandlers.HTTP[t];n&&n.call(this,t)},_hitError:function(e){this.errors++,i.warn("request errored, status: "+e+", number of errors: "+this.errors),this.errors>4&&this._conn._onDisconnectTimeout()},_no_auth_received:function(e){i.warn("Server did not yet offer a supported authentication mechanism. Sending a blank poll request."),e=e?e.bind(this._conn):this._conn._connect_cb.bind(this._conn);var t=this._buildBody();this._requests.push(new i.Request(t.tree(),this._onRequestStateChange.bind(this,e),t.tree().getAttribute("rid"))),this._throttledRequestHandler()},_onDisconnectTimeout:function(){this._abortAllRequests()},_abortAllRequests:function(){for(;this._requests.length>0;){var e=this._requests.pop();e.abort=!0,e.xhr.abort(),e.xhr.onreadystatechange=function(){}}},_onIdle:function(){var e=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===e.length&&!this._conn.disconnecting&&(i.info("no requests during idle cycle, sending blank request"),e.push(null)),!this._conn.paused){if(this._requests.length<2&&e.length>0){for(var t=this._buildBody(),n=0;n<e.length;n++)null!==e[n]&&("restart"===e[n]?t.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":i.NS.BOSH}):t.cnode(e[n]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new i.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"))),this._throttledRequestHandler()}if(this._requests.length>0){var r=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(i.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),r>Math.floor(i.TIMEOUT*this.wait)&&(i.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(i.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}},_getRequestStatus:function(e,t){var n;if(4===e.xhr.readyState)try{n=e.xhr.status}catch(e){i.error("Caught an error while retrieving a request's status, reqStatus: "+n)}return void 0===n&&(n="number"==typeof t?t:0),n},_onRequestStateChange:function(e,t){if(i.debug("request id "+t.id+"."+t.sends+" state changed to "+t.xhr.readyState),t.abort)t.abort=!1;else if(4===t.xhr.readyState){var n=this._getRequestStatus(t);if(this.lastResponseHeaders=t.xhr.getAllResponseHeaders(),this.disconnecting&&n>=400)return this._hitError(n),void this._callProtocolErrorHandlers(t);var r=n>0&&n<500,o=t.sends>this._conn.maxRetries;if((r||o)&&(this._removeRequest(t),i.debug("request id "+t.id+" should now be removed")),200===n){var a=this._requests[0]===t;(this._requests[1]===t||a&&this._requests.length>0&&this._requests[0].age()>Math.floor(i.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(Number(t.rid)+1),i.debug("request id "+t.id+"."+t.sends+" got 200"),e(t),this.errors=0}else 0===n||n>=400&&n<600||n>=12e3?(i.error("request id "+t.id+"."+t.sends+" error "+n+" happened"),this._hitError(n),this._callProtocolErrorHandlers(t),n>=400&&n<500&&(this._conn._changeConnectStatus(i.Status.DISCONNECTING,null),this._conn._doDisconnect())):i.error("request id "+t.id+"."+t.sends+" error "+n+" happened");r||o?o&&!this._conn.connected&&this._conn._changeConnectStatus(i.Status.CONNFAIL,"giving-up"):this._throttledRequestHandler()}},_processRequest:function(e){var t=this,n=this._requests[e],r=this._getRequestStatus(n,-1);if(n.sends>this._conn.maxRetries)this._conn._onDisconnectTimeout();else{var o=n.age(),a=!isNaN(o)&&o>Math.floor(i.TIMEOUT*this.wait),s=null!==n.dead&&n.timeDead()>Math.floor(i.SECONDARY_TIMEOUT*this.wait),c=4===n.xhr.readyState&&(r<1||r>=500);if((a||s||c)&&(s&&i.error("Request ".concat(this._requests[e].id," timed out (secondary), restarting")),n.abort=!0,n.xhr.abort(),n.xhr.onreadystatechange=function(){},this._requests[e]=new i.Request(n.xmlData,n.origFunc,n.rid,n.sends),n=this._requests[e]),0===n.xhr.readyState){i.debug("request id "+n.id+"."+n.sends+" posting");try{var l=this._conn.options.contentType||"text/xml; charset=utf-8";n.xhr.open("POST",this._conn.service,!this._conn.options.sync),void 0!==n.xhr.setRequestHeader&&n.xhr.setRequestHeader("Content-Type",l),this._conn.options.withCredentials&&(n.xhr.withCredentials=!0)}catch(e){return i.error("XHR open failed: "+e.toString()),this._conn.connected||this._conn._changeConnectStatus(i.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}var d=function(){if(n.date=new Date,t._conn.options.customHeaders){var e=t._conn.options.customHeaders;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.xhr.setRequestHeader(r,e[r])}n.xhr.send(n.data)};if(n.sends>1){var u=1e3*Math.min(Math.floor(i.TIMEOUT*this.wait),Math.pow(n.sends,3));setTimeout(function(){d()},u)}else d();n.sends++,this._conn.xmlOutput!==i.Connection.prototype.xmlOutput&&(n.xmlData.nodeName===this.strip&&n.xmlData.childNodes.length?this._conn.xmlOutput(n.xmlData.childNodes[0]):this._conn.xmlOutput(n.xmlData)),this._conn.rawOutput!==i.Connection.prototype.rawOutput&&this._conn.rawOutput(n.data)}else i.debug("_processRequest: "+(0===e?"first":"second")+" request has readyState of "+n.xhr.readyState)}},_removeRequest:function(e){i.debug("removing request");for(var t=this._requests.length-1;t>=0;t--)e===this._requests[t]&&this._requests.splice(t,1);e.xhr.onreadystatechange=function(){},this._throttledRequestHandler()},_restartRequest:function(e){var t=this._requests[e];null===t.dead&&(t.dead=new Date),this._processRequest(e)},_reqToData:function(e){try{return e.getResponse()}catch(e){if("parsererror"!==e.message)throw e;this._conn.disconnect("strophe-parsererror")}},_sendTerminate:function(e){i.info("_sendTerminate was called");var t=this._buildBody().attrs({type:"terminate"});e&&t.cnode(e.tree());var n=new i.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"));this._requests.push(n),this._throttledRequestHandler()},_send:function(){var e=this;clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout(function(){return e._conn._onIdle()},100)},_sendRestart:function(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)},_throttledRequestHandler:function(){this._requests?i.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):i.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}}},"./src/core.js":function(e,t,n){"use strict";n.r(t),n.d(t,"Strophe",function(){return p}),n.d(t,"$build",function(){return c}),n.d(t,"$iq",function(){return d}),n.d(t,"$msg",function(){return l}),n.d(t,"$pres",function(){return u});var r=n("./src/md5.js");n.d(t,"MD5",function(){return r.default});var i=n("./src/sha1.js");n.d(t,"SHA1",function(){return i.default});var o=n("./src/utils.js");function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return new p.Builder(e,t)}function l(e){return new p.Builder("message",e)}function d(e){return new p.Builder("iq",e)}function u(e){return new p.Builder("presence",e)}var p={VERSION:"1.3.1",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag:function(e){for(var t=0;t<p.XHTML.tags.length;t++)if(e===p.XHTML.tags[t])return!0;return!1},validAttribute:function(e,t){if(void 0!==p.XHTML.attributes[e]&&p.XHTML.attributes[e].length>0)for(var n=0;n<p.XHTML.attributes[e].length;n++)if(t===p.XHTML.attributes[e][n])return!0;return!1},validCSS:function(e){for(var t=0;t<p.XHTML.css.length;t++)if(e===p.XHTML.css[t])return!0;return!1}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10},ErrorCondition:{BAD_FORMAT:"bad-format",CONFLICT:"conflict",MISSING_JID_NODE:"x-strophe-bad-non-anon-jid",NO_AUTH_MECH:"no-auth-mech",UNKNOWN_REASON:"unknown"},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace:function(e,t){p.NS[e]=t},forEachChild:function(e,t,n){for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];i.nodeType!==p.ElementType.NORMAL||t&&!this.isTagEqual(i,t)||n(i)}},isTagEqual:function(e,t){return e.tagName===t},_xmlGenerator:null,_makeGenerator:function(){var e;return void 0===document.implementation.createDocument||document.implementation.createDocument&&document.documentMode&&document.documentMode<10?(e=this._getIEXmlDom()).appendChild(e.createElement("strophe")):e=document.implementation.createDocument("jabber:client","strophe",null),e},xmlGenerator:function(){return p._xmlGenerator||(p._xmlGenerator=p._makeGenerator()),p._xmlGenerator},_getIEXmlDom:function(){for(var e=null,t=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"],n=0;n<t.length&&null===e;n++)try{e=new ActiveXObject(t[n])}catch(t){e=null}return e},xmlElement:function(e){if(!e)return null;for(var t=p.xmlGenerator().createElement(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r)if("string"==typeof r||"number"==typeof r)t.appendChild(p.xmlTextNode(r));else if("object"===s(r)&&"function"==typeof r.sort)for(var i=0;i<r.length;i++){var o=r[i];"object"===s(o)&&"function"==typeof o.sort&&void 0!==o[1]&&null!==o[1]&&t.setAttribute(o[0],o[1])}else if("object"===s(r))for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&void 0!==r[a]&&null!==r[a]&&t.setAttribute(a,r[a])}return t},xmlescape:function(e){return e=(e=(e=(e=(e=e.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;")},xmlunescape:function(e){return e=(e=(e=(e=(e=e.replace(/\&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')},xmlTextNode:function(e){return p.xmlGenerator().createTextNode(e)},xmlHtmlNode:function(e){var t;DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e));return t},getText:function(e){if(!e)return null;var t="";0===e.childNodes.length&&e.nodeType===p.ElementType.TEXT&&(t+=e.nodeValue);for(var n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType===p.ElementType.TEXT&&(t+=e.childNodes[n].nodeValue);return p.xmlescape(t)},copyElement:function(e){var t;if(e.nodeType===p.ElementType.NORMAL){t=p.xmlElement(e.tagName);for(var n=0;n<e.attributes.length;n++)t.setAttribute(e.attributes[n].nodeName,e.attributes[n].value);for(var r=0;r<e.childNodes.length;r++)t.appendChild(p.copyElement(e.childNodes[r]))}else e.nodeType===p.ElementType.TEXT&&(t=p.xmlGenerator().createTextNode(e.nodeValue));return t},createHtml:function(e){var t;if(e.nodeType===p.ElementType.NORMAL){var n=e.nodeName.toLowerCase();if(p.XHTML.validTag(n))try{t=p.xmlElement(n);for(var r=0;r<p.XHTML.attributes[n].length;r++){var i=p.XHTML.attributes[n][r],o=e.getAttribute(i);if(null!=o&&""!==o&&!1!==o&&0!==o)if("style"===i&&"object"===s(o)&&void 0!==o.cssText&&(o=o.cssText),"style"===i){for(var a=[],c=o.split(";"),l=0;l<c.length;l++){var d=c[l].split(":"),u=d[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();if(p.XHTML.validCSS(u)){var h=d[1].replace(/^\s*/,"").replace(/\s*$/,"");a.push(u+": "+h)}}a.length>0&&(o=a.join("; "),t.setAttribute(i,o))}else t.setAttribute(i,o)}for(var f=0;f<e.childNodes.length;f++)t.appendChild(p.createHtml(e.childNodes[f]))}catch(e){t=p.xmlTextNode("")}else{t=p.xmlGenerator().createDocumentFragment();for(var m=0;m<e.childNodes.length;m++)t.appendChild(p.createHtml(e.childNodes[m]))}}else if(e.nodeType===p.ElementType.FRAGMENT){t=p.xmlGenerator().createDocumentFragment();for(var g=0;g<e.childNodes.length;g++)t.appendChild(p.createHtml(e.childNodes[g]))}else e.nodeType===p.ElementType.TEXT&&(t=p.xmlTextNode(e.nodeValue));return t},escapeNode:function(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(e){return"string"!=typeof e?e:e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(e){return e.indexOf("@")<0?null:e.split("@")[0]},getDomainFromJid:function(e){var t=p.getBareJidFromJid(e);if(t.indexOf("@")<0)return t;var n=t.split("@");return n.splice(0,1),n.join("@")},getResourceFromJid:function(e){var t=e.split("/");return t.length<2?null:(t.splice(0,1),t.join("/"))},getBareJidFromJid:function(e){return e?e.split("/")[0]:null},_handleError:function(e){void 0!==e.stack&&p.fatal(e.stack),e.sourceURL?p.fatal("error: "+this.handler+" "+e.sourceURL+":"+e.line+" - "+e.name+": "+e.message):e.fileName?p.fatal("error: "+this.handler+" "+e.fileName+":"+e.lineNumber+" - "+e.name+": "+e.message):p.fatal("error: "+e.message)},log:function(e,t){e===this.LogLevel.FATAL&&"object"===s(window.console)&&"function"==typeof window.console.error&&window.console.error(t)},debug:function(e){this.log(this.LogLevel.DEBUG,e)},info:function(e){this.log(this.LogLevel.INFO,e)},warn:function(e){this.log(this.LogLevel.WARN,e)},error:function(e){this.log(this.LogLevel.ERROR,e)},fatal:function(e){this.log(this.LogLevel.FATAL,e)},serialize:function(e){if(!e)return null;"function"==typeof e.tree&&(e=e.tree());var t=a(Array(e.attributes.length).keys()).map(function(t){return e.attributes[t].nodeName});t.sort();var n=t.reduce(function(t,n){return"".concat(t," ").concat(n,'="').concat(p.xmlescape(e.attributes.getNamedItem(n).value),'"')},"<".concat(e.nodeName));if(e.childNodes.length>0){n+=">";for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];switch(i.nodeType){case p.ElementType.NORMAL:n+=p.serialize(i);break;case p.ElementType.TEXT:n+=p.xmlescape(i.nodeValue);break;case p.ElementType.CDATA:n+="<![CDATA["+i.nodeValue+"]]>"}}n+="</"+e.nodeName+">"}else n+="/>";return n},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(e,t){p._connectionPlugins[e]=t},Builder:function(e,t){"presence"!==e&&"message"!==e&&"iq"!==e||(t&&!t.xmlns?t.xmlns=p.NS.CLIENT:t||(t={xmlns:p.NS.CLIENT})),this.nodeTree=p.xmlElement(e,t),this.node=this.nodeTree}};p.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return p.serialize(this.nodeTree)},up:function(){return this.node=this.node.parentNode,this},root:function(){return this.node=this.nodeTree,this},attrs:function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(void 0===e[t]?this.node.removeAttribute(t):this.node.setAttribute(t,e[t]));return this},c:function(e,t,n){var r=p.xmlElement(e,t,n);return this.node.appendChild(r),"string"!=typeof n&&"number"!=typeof n&&(this.node=r),this},cnode:function(e){var t,n=p.xmlGenerator();try{t=void 0!==n.importNode}catch(e){t=!1}var r=t?n.importNode(e,!0):p.copyElement(e);return this.node.appendChild(r),this.node=r,this},t:function(e){var t=p.xmlTextNode(e);return this.node.appendChild(t),this},h:function(e){var t=document.createElement("body");t.innerHTML=e;for(var n=p.createHtml(t);n.childNodes.length>0;)this.node.appendChild(n.childNodes[0]);return this}},p.Handler=function(e,t,n,r,i,o,a){this.handler=e,this.ns=t,this.name=n,this.type=r,this.id=i,this.options=a||{matchBareFromJid:!1,ignoreNamespaceFragment:!1},this.options.matchBare&&(p.warn('The "matchBare" option is deprecated, use "matchBareFromJid" instead.'),this.options.matchBareFromJid=this.options.matchBare,delete this.options.matchBare),this.options.matchBareFromJid?this.from=o?p.getBareJidFromJid(o):null:this.from=o,this.user=!0},p.Handler.prototype={getNamespace:function(e){var t=e.getAttribute("xmlns");return t&&this.options.ignoreNamespaceFragment&&(t=t.split("#")[0]),t},namespaceMatch:function(e){var t=this,n=!1;return!this.ns||(p.forEachChild(e,null,function(e){t.getNamespace(e)===t.ns&&(n=!0)}),n||this.getNamespace(e)===this.ns)},isMatch:function(e){var t=e.getAttribute("from");this.options.matchBareFromJid&&(t=p.getBareJidFromJid(t));var n=e.getAttribute("type");return!(!this.namespaceMatch(e)||this.name&&!p.isTagEqual(e,this.name)||this.type&&(Array.isArray(this.type)?-1===this.type.indexOf(n):n!==this.type)||this.id&&e.getAttribute("id")!==this.id||this.from&&t!==this.from)},run:function(e){var t=null;try{t=this.handler(e)}catch(e){throw p._handleError(e),e}return t},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},p.TimedHandler=function(e,t){this.period=e,this.handler=t,this.lastCalled=(new Date).getTime(),this.user=!0},p.TimedHandler.prototype={run:function(){return this.lastCalled=(new Date).getTime(),this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}},p.Connection=function(e,t){var n=this;this.service=e,this.options=t||{};var r=this.options.protocol||"";for(var i in 0===e.indexOf("ws:")||0===e.indexOf("wss:")||0===r.indexOf("ws")?this._proto=new p.Websocket(this):this._proto=new p.Bosh(this),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.protocolErrorHandlers={HTTP:{},websocket:{}},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(function(){return n._onIdle()},100),o.default.addCookies(this.options.cookies),this.registerSASLMechanisms(this.options.mechanisms),p._connectionPlugins)if(Object.prototype.hasOwnProperty.call(p._connectionPlugins,i)){var a=function(){};a.prototype=p._connectionPlugins[i],this[i]=new a,this[i].init(this)}},p.Connection.prototype={reset:function(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0},pause:function(){this.paused=!0},resume:function(){this.paused=!1},getUniqueId:function(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});return"string"==typeof e||"number"==typeof e?t+":"+e:t+""},addProtocolErrorHandler:function(e,t,n){this.protocolErrorHandlers[e][t]=n},connect:function(e,t,n,r,i,o,a){this.jid=e,this.authzid=p.getBareJidFromJid(this.jid),this.authcid=a||p.getNodeFromJid(this.jid),this.pass=t,this.servtype="xmpp",this.connect_callback=n,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.domain=p.getDomainFromJid(this.jid),this._changeConnectStatus(p.Status.CONNECTING,null),this._proto._connect(r,i,o)},attach:function(e,t,n,r,i,o,a){if(!(this._proto instanceof p.Bosh)){var s=new Error('The "attach" method can only be used with a BOSH connection.');throw s.name="StropheSessionError",s}this._proto._attach(e,t,n,r,i,o,a)},restore:function(e,t,n,r,i){if(!this._sessionCachingSupported()){var o=new Error('The "restore" method can only be used with a BOSH connection.');throw o.name="StropheSessionError",o}this._proto._restore(e,t,n,r,i)},_sessionCachingSupported:function(){if(this._proto instanceof p.Bosh){if(!JSON)return!1;try{sessionStorage.setItem("_strophe_","_strophe_"),sessionStorage.removeItem("_strophe_")}catch(e){return!1}return!0}return!1},xmlInput:function(e){},xmlOutput:function(e){},rawInput:function(e){},rawOutput:function(e){},nextValidRid:function(e){},send:function(e){if(null!==e){if("function"==typeof e.sort)for(var t=0;t<e.length;t++)this._queueData(e[t]);else"function"==typeof e.tree?this._queueData(e.tree()):this._queueData(e);this._proto._send()}},flush:function(){clearTimeout(this._idleTimeout),this._onIdle()},sendPresence:function(e,t,n,r){var i=this,o=null;"function"==typeof e.tree&&(e=e.tree());var a=e.getAttribute("id");if(a||(a=this.getUniqueId("sendPresence"),e.setAttribute("id",a)),"function"==typeof t||"function"==typeof n){var s=this.addHandler(function(e){o&&i.deleteTimedHandler(o),"error"===e.getAttribute("type")?n&&n(e):t&&t(e)},null,"presence",null,a);r&&(o=this.addTimedHandler(r,function(){return i.deleteHandler(s),n&&n(null),!1}))}return this.send(e),a},sendIQ:function(e,t,n,r){var i=this,o=null;"function"==typeof e.tree&&(e=e.tree());var a=e.getAttribute("id");if(a||(a=this.getUniqueId("sendIQ"),e.setAttribute("id",a)),"function"==typeof t||"function"==typeof n){var s=this.addHandler(function(e){o&&i.deleteTimedHandler(o);var r=e.getAttribute("type");if("result"===r)t&&t(e);else{if("error"!==r){var a=new Error("Got bad IQ type of ".concat(r));throw a.name="StropheError",a}n&&n(e)}},null,"iq",["error","result"],a);r&&(o=this.addTimedHandler(r,function(){return i.deleteHandler(s),n&&n(null),!1}))}return this.send(e),a},_queueData:function(e){if(null===e||!e.tagName||!e.childNodes){var t=new Error("Cannot queue non-DOMElement.");throw t.name="StropheError",t}this._data.push(e)},_sendRestart:function(){var e=this;this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout(function(){return e._onIdle()},100)},addTimedHandler:function(e,t){var n=new p.TimedHandler(e,t);return this.addTimeds.push(n),n},deleteTimedHandler:function(e){this.removeTimeds.push(e)},addHandler:function(e,t,n,r,i,o,a){var s=new p.Handler(e,t,n,r,i,o,a);return this.addHandlers.push(s),s},deleteHandler:function(e){this.removeHandlers.push(e);var t=this.addHandlers.indexOf(e);t>=0&&this.addHandlers.splice(t,1)},registerSASLMechanisms:function(e){this.mechanisms={},(e=e||[p.SASLAnonymous,p.SASLExternal,p.SASLMD5,p.SASLOAuthBearer,p.SASLXOAuth2,p.SASLPlain,p.SASLSHA1]).forEach(this.registerSASLMechanism.bind(this))},registerSASLMechanism:function(e){this.mechanisms[e.prototype.name]=e},disconnect:function(e){if(this._changeConnectStatus(p.Status.DISCONNECTING,e),p.info("Disconnect was called because: "+e),this.connected){var t=!1;this.disconnecting=!0,this.authenticated&&(t=u({xmlns:p.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(3e3,this._onDisconnectTimeout.bind(this)),this._proto._disconnect(t)}else p.info("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests(),this._doDisconnect()},_changeConnectStatus:function(e,t,n){for(var r in p._connectionPlugins)if(Object.prototype.hasOwnProperty.call(p._connectionPlugins,r)){var i=this[r];if(i.statusChanged)try{i.statusChanged(e,t)}catch(e){p.error("".concat(r," plugin caused an exception changing status: ").concat(e))}}if(this.connect_callback)try{this.connect_callback(e,t,n)}catch(e){p._handleError(e),p.error("User connection callback caused an exception: ".concat(e))}},_doDisconnect:function(e){"number"==typeof this._idleTimeout&&clearTimeout(this._idleTimeout),null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),p.info("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(p.Status.DISCONNECTED,e),this.connected=!1},_dataRecv:function(e,t){var n=this;p.info("_dataRecv called");var r=this._proto._reqToData(e);if(null!==r){for(this.xmlInput!==p.Connection.prototype.xmlInput&&(r.nodeName===this._proto.strip&&r.childNodes.length?this.xmlInput(r.childNodes[0]):this.xmlInput(r)),this.rawInput!==p.Connection.prototype.rawInput&&(t?this.rawInput(t):this.rawInput(p.serialize(r)));this.removeHandlers.length>0;){var i=this.removeHandlers.pop(),o=this.handlers.indexOf(i);o>=0&&this.handlers.splice(o,1)}for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())this._doDisconnect();else{var a=r.getAttribute("type");if(null!==a&&"terminate"===a){if(this.disconnecting)return;var s=r.getAttribute("condition"),c=r.getElementsByTagName("conflict");return null!==s?("remote-stream-error"===s&&c.length>0&&(s="conflict"),this._changeConnectStatus(p.Status.CONNFAIL,s)):this._changeConnectStatus(p.Status.CONNFAIL,p.ErrorCondition.UNKOWN_REASON),void this._doDisconnect(s)}p.forEachChild(r,null,function(e){var t=n.handlers;n.handlers=[];for(var r=0;r<t.length;r++){var i=t[r];try{!i.isMatch(e)||!n.authenticated&&i.user?n.handlers.push(i):i.run(e)&&n.handlers.push(i)}catch(e){p.warn("Removing Strophe handlers due to uncaught exception: "+e.message)}}})}}},mechanisms:{},_connect_cb:function(e,t,n){var r;p.info("_connect_cb was called"),this.connected=!0;try{r=this._proto._reqToData(e)}catch(e){if(e.name!==p.ErrorCondition.BAD_FORMAT)throw e;this._changeConnectStatus(p.Status.CONNFAIL,p.ErrorCondition.BAD_FORMAT),this._doDisconnect(p.ErrorCondition.BAD_FORMAT)}if(r&&(this.xmlInput!==p.Connection.prototype.xmlInput&&(r.nodeName===this._proto.strip&&r.childNodes.length?this.xmlInput(r.childNodes[0]):this.xmlInput(r)),this.rawInput!==p.Connection.prototype.rawInput&&(n?this.rawInput(n):this.rawInput(p.serialize(r))),this._proto._connect_cb(r)!==p.Status.CONNFAIL))if(r.getElementsByTagNameNS?r.getElementsByTagNameNS(p.NS.STREAM,"features").length>0:r.getElementsByTagName("stream:features").length>0||r.getElementsByTagName("features").length>0){var i=[],o=r.getElementsByTagName("mechanism");if(o.length>0)for(var a=0;a<o.length;a++){var s=p.getText(o[a]);this.mechanisms[s]&&i.push(this.mechanisms[s])}0!==i.length||0!==r.getElementsByTagName("auth").length?!1!==this.do_authentication&&this.authenticate(i):this._proto._no_auth_received(t)}else this._proto._no_auth_received(t)},sortMechanismsByPriority:function(e){for(var t=0;t<e.length-1;++t){for(var n=t,r=t+1;r<e.length;++r)e[r].prototype.priority>e[n].prototype.priority&&(n=r);if(n!==t){var i=e[t];e[t]=e[n],e[n]=i}}return e},_attemptSASLAuth:function(e){e=this.sortMechanismsByPriority(e||[]);for(var t=!1,n=0;n<e.length;++n)if(e[n].prototype.test(this)){this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_mechanism=new e[n],this._sasl_mechanism.onStart(this);var r=c("auth",{xmlns:p.NS.SASL,mechanism:this._sasl_mechanism.name});if(this._sasl_mechanism.isClientFirst){var i=this._sasl_mechanism.onChallenge(this,null);r.t(btoa(i))}this.send(r.tree()),t=!0;break}return t},_attemptLegacyAuth:function(){null===p.getNodeFromJid(this.jid)?(this._changeConnectStatus(p.Status.CONNFAIL,p.ErrorCondition.MISSING_JID_NODE),this.disconnect(p.ErrorCondition.MISSING_JID_NODE)):(this._changeConnectStatus(p.Status.AUTHENTICATING,null),this._addSysHandler(this._auth1_cb.bind(this),null,null,null,"_auth_1"),this.send(d({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:p.NS.AUTH}).c("username",{}).t(p.getNodeFromJid(this.jid)).tree()))},authenticate:function(e){this._attemptSASLAuth(e)||this._attemptLegacyAuth()},_sasl_challenge_cb:function(e){var t=atob(p.getText(e)),n=this._sasl_mechanism.onChallenge(this,t),r=c("response",{xmlns:p.NS.SASL});return""!==n&&r.t(btoa(n)),this.send(r.tree()),!0},_auth1_cb:function(e){var t=d({type:"set",id:"_auth_2"}).c("query",{xmlns:p.NS.AUTH}).c("username",{}).t(p.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return p.getResourceFromJid(this.jid)||(this.jid=p.getBareJidFromJid(this.jid)+"/strophe"),t.up().c("resource",{}).t(p.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(t.tree()),!1},_sasl_success_cb:function(e){var t=this;if(this._sasl_data["server-signature"]){var n,r=atob(p.getText(e)).match(/([a-z]+)=([^,]+)(,|$)/);if("v"===r[1]&&(n=r[2]),n!==this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}p.info("SASL authentication succeeded."),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);var i=[],o=function(e,n){for(;e.length;)t.deleteHandler(e.pop());return t._sasl_auth1_cb(n),!1};return i.push(this._addSysHandler(function(e){return o(i,e)},null,"stream:features",null,null)),i.push(this._addSysHandler(function(e){return o(i,e)},p.NS.STREAM,"features",null,null)),this._sendRestart(),!1},_sasl_auth1_cb:function(e){this.features=e;for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];"bind"===n.nodeName&&(this.do_bind=!0),"session"===n.nodeName&&(this.do_session=!0)}if(!this.do_bind)return this._changeConnectStatus(p.Status.AUTHFAIL,null),!1;this._addSysHandler(this._sasl_bind_cb.bind(this),null,null,null,"_bind_auth_2");var r=p.getResourceFromJid(this.jid);return r?this.send(d({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:p.NS.BIND}).c("resource",{}).t(r).tree()):this.send(d({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:p.NS.BIND}).tree()),!1},_sasl_bind_cb:function(e){var t;if("error"===e.getAttribute("type"))return p.info("SASL binding failed."),e.getElementsByTagName("conflict").length>0&&(t=p.ErrorCondition.CONFLICT),this._changeConnectStatus(p.Status.AUTHFAIL,t,e),!1;var n=e.getElementsByTagName("bind");if(!(n.length>0))return p.info("SASL binding failed."),this._changeConnectStatus(p.Status.AUTHFAIL,null,e),!1;var r=n[0].getElementsByTagName("jid");r.length>0&&(this.jid=p.getText(r[0]),this.do_session?(this._addSysHandler(this._sasl_session_cb.bind(this),null,null,null,"_session_auth_2"),this.send(d({type:"set",id:"_session_auth_2"}).c("session",{xmlns:p.NS.SESSION}).tree())):(this.authenticated=!0,this._changeConnectStatus(p.Status.CONNECTED,null)))},_sasl_session_cb:function(e){if("result"===e.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(p.Status.CONNECTED,null);else if("error"===e.getAttribute("type"))return p.info("Session creation failed."),this._changeConnectStatus(p.Status.AUTHFAIL,null,e),!1;return!1},_sasl_failure_cb:function(e){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(p.Status.AUTHFAIL,null,e),!1},_auth2_cb:function(e){return"result"===e.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(p.Status.CONNECTED,null)):"error"===e.getAttribute("type")&&(this._changeConnectStatus(p.Status.AUTHFAIL,null,e),this.disconnect("authentication failed")),!1},_addSysTimedHandler:function(e,t){var n=new p.TimedHandler(e,t);return n.user=!1,this.addTimeds.push(n),n},_addSysHandler:function(e,t,n,r,i){var o=new p.Handler(e,t,n,r,i);return o.user=!1,this.addHandlers.push(o),o},_onDisconnectTimeout:function(){return p.info("_onDisconnectTimeout was called"),this._changeConnectStatus(p.Status.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1},_onIdle:function(){for(var e=this;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;){var t=this.removeTimeds.pop(),n=this.timedHandlers.indexOf(t);n>=0&&this.timedHandlers.splice(n,1)}for(var r=(new Date).getTime(),i=[],o=0;o<this.timedHandlers.length;o++){var a=this.timedHandlers[o];if(this.authenticated||!a.user)a.lastCalled+a.period-r<=0?a.run()&&i.push(a):i.push(a)}this.timedHandlers=i,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout(function(){return e._onIdle()},100))}},p.SASLMechanism=function(e,t,n){this.name=e,this.isClientFirst=t,this.priority=n},p.SASLMechanism.prototype={test:function(e){return!0},onStart:function(e){this._connection=e},onChallenge:function(e,t){throw new Error("You should implement challenge handling!")},onFailure:function(){this._connection=null},onSuccess:function(){this._connection=null}},p.SASLAnonymous=function(){},p.SASLAnonymous.prototype=new p.SASLMechanism("ANONYMOUS",!1,20),p.SASLAnonymous.prototype.test=function(e){return null===e.authcid},p.SASLPlain=function(){},p.SASLPlain.prototype=new p.SASLMechanism("PLAIN",!0,50),p.SASLPlain.prototype.test=function(e){return null!==e.authcid},p.SASLPlain.prototype.onChallenge=function(e){var t=e.authzid;return t+="\0",t+=e.authcid,t+="\0",t+=e.pass,o.default.utf16to8(t)},p.SASLSHA1=function(){},p.SASLSHA1.prototype=new p.SASLMechanism("SCRAM-SHA-1",!0,70),p.SASLSHA1.prototype.test=function(e){return null!==e.authcid},p.SASLSHA1.prototype.onChallenge=function(e,t,n){var a=n||r.default.hexdigest(1234567890*Math.random()),s="n="+o.default.utf16to8(e.authcid);return s+=",r=",s+=a,e._sasl_data.cnonce=a,e._sasl_data["client-first-message-bare"]=s,s="n,,"+s,this.onChallenge=function(e,t){for(var n,r,a,s,c,l,d,u,p="c=biws,",h="".concat(e._sasl_data["client-first-message-bare"],",").concat(t,","),f=e._sasl_data.cnonce,m=/([a-z]+)=([^,]+)(,|$)/;t.match(m);){var g=t.match(m);switch(t=t.replace(g[0],""),g[1]){case"r":n=g[2];break;case"s":r=g[2];break;case"i":a=g[2]}}if(n.substr(0,f.length)!==f)return e._sasl_data={},e._sasl_failure_cb();h+=p+="r="+n,r=atob(r),r+="\0\0\0";var v=o.default.utf16to8(e.pass);for(s=l=i.default.core_hmac_sha1(v,r),d=1;d<a;d++){for(c=i.default.core_hmac_sha1(v,i.default.binb2str(l)),u=0;u<5;u++)s[u]^=c[u];l=c}s=i.default.binb2str(s);var S=i.default.core_hmac_sha1(s,"Client Key"),y=i.default.str_hmac_sha1(s,"Server Key"),b=i.default.core_hmac_sha1(i.default.str_sha1(i.default.binb2str(S)),h);for(e._sasl_data["server-signature"]=i.default.b64_hmac_sha1(y,h),u=0;u<5;u++)S[u]^=b[u];return p+=",p="+btoa(i.default.binb2str(S))},s},p.SASLMD5=function(){},p.SASLMD5.prototype=new p.SASLMechanism("DIGEST-MD5",!1,60),p.SASLMD5.prototype.test=function(e){return null!==e.authcid},p.SASLMD5.prototype._quote=function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},p.SASLMD5.prototype.onChallenge=function(e,t,n){for(var i=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,a=n||r.default.hexdigest(""+1234567890*Math.random()),s="",c=null,l="";t.match(i);){var d=t.match(i);switch(t=t.replace(d[0],""),d[2]=d[2].replace(/^"(.+)"$/,"$1"),d[1]){case"realm":s=d[2];break;case"nonce":l=d[2];break;case"qop":d[2];break;case"host":c=d[2]}}var u=e.servtype+"/"+e.domain;null!==c&&(u=u+"/"+c);var p=o.default.utf16to8(e.authcid+":"+s+":"+this._connection.pass),h=r.default.hash(p)+":"+l+":"+a,f="AUTHENTICATE:"+u,m="";return m+="charset=utf-8,",m+="username="+this._quote(o.default.utf16to8(e.authcid))+",",m+="realm="+this._quote(s)+",",m+="nonce="+this._quote(l)+",",m+="nc=00000001,",m+="cnonce="+this._quote(a)+",",m+="digest-uri="+this._quote(u)+",",m+="response="+r.default.hexdigest(r.default.hexdigest(h)+":"+l+":00000001:"+a+":auth:"+r.default.hexdigest(f))+",",m+="qop=auth",this.onChallenge=function(){return""},m},p.SASLOAuthBearer=function(){},p.SASLOAuthBearer.prototype=new p.SASLMechanism("OAUTHBEARER",!0,40),p.SASLOAuthBearer.prototype.test=function(e){return null!==e.pass},p.SASLOAuthBearer.prototype.onChallenge=function(e){var t="n,";return null!==e.authcid&&(t=t+"a="+e.authzid),t+=",",t+="",t+="auth=Bearer ",t+=e.pass,t+="",t+="",o.default.utf16to8(t)},p.SASLExternal=function(){},p.SASLExternal.prototype=new p.SASLMechanism("EXTERNAL",!0,10),p.SASLExternal.prototype.onChallenge=function(e){return e.authcid===e.authzid?"":e.authzid},p.SASLXOAuth2=function(){},p.SASLXOAuth2.prototype=new p.SASLMechanism("X-OAUTH2",!0,30),p.SASLXOAuth2.prototype.test=function(e){return null!==e.pass},p.SASLXOAuth2.prototype.onChallenge=function(e){var t="\0";return null!==e.authcid&&(t+=e.authzid),t+="\0",t+=e.pass,o.default.utf16to8(t)},t.default={Strophe:p,$build:c,$iq:d,$msg:l,$pres:u,SHA1:i.default,MD5:r.default,b64_hmac_sha1:i.default.b64_hmac_sha1,b64_sha1:i.default.b64_sha1,str_hmac_sha1:i.default.str_hmac_sha1,str_sha1:i.default.str_sha1}},"./src/md5.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var r=function(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n},i=function(e){for(var t=[],n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t},o=function(e,t,n,i,o,a){return r((s=r(r(t,e),r(i,a)))<<(c=o)|s>>>32-c,n);var s,c},a=function(e,t,n,r,i,a,s){return o(t&n|~t&r,e,t,i,a,s)},s=function(e,t,n,r,i,a,s){return o(t&r|n&~r,e,t,i,a,s)},c=function(e,t,n,r,i,a,s){return o(t^n^r,e,t,i,a,s)},l=function(e,t,n,r,i,a,s){return o(n^(t|~r),e,t,i,a,s)},d=function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n,i,o,d,u=1732584193,p=-271733879,h=-1732584194,f=271733878,m=0;m<e.length;m+=16)n=u,i=p,o=h,d=f,u=a(u,p,h,f,e[m+0],7,-680876936),f=a(f,u,p,h,e[m+1],12,-389564586),h=a(h,f,u,p,e[m+2],17,606105819),p=a(p,h,f,u,e[m+3],22,-1044525330),u=a(u,p,h,f,e[m+4],7,-176418897),f=a(f,u,p,h,e[m+5],12,1200080426),h=a(h,f,u,p,e[m+6],17,-1473231341),p=a(p,h,f,u,e[m+7],22,-45705983),u=a(u,p,h,f,e[m+8],7,1770035416),f=a(f,u,p,h,e[m+9],12,-1958414417),h=a(h,f,u,p,e[m+10],17,-42063),p=a(p,h,f,u,e[m+11],22,-1990404162),u=a(u,p,h,f,e[m+12],7,1804603682),f=a(f,u,p,h,e[m+13],12,-40341101),h=a(h,f,u,p,e[m+14],17,-1502002290),p=a(p,h,f,u,e[m+15],22,1236535329),u=s(u,p,h,f,e[m+1],5,-165796510),f=s(f,u,p,h,e[m+6],9,-1069501632),h=s(h,f,u,p,e[m+11],14,643717713),p=s(p,h,f,u,e[m+0],20,-373897302),u=s(u,p,h,f,e[m+5],5,-701558691),f=s(f,u,p,h,e[m+10],9,38016083),h=s(h,f,u,p,e[m+15],14,-660478335),p=s(p,h,f,u,e[m+4],20,-405537848),u=s(u,p,h,f,e[m+9],5,568446438),f=s(f,u,p,h,e[m+14],9,-1019803690),h=s(h,f,u,p,e[m+3],14,-187363961),p=s(p,h,f,u,e[m+8],20,1163531501),u=s(u,p,h,f,e[m+13],5,-1444681467),f=s(f,u,p,h,e[m+2],9,-51403784),h=s(h,f,u,p,e[m+7],14,1735328473),p=s(p,h,f,u,e[m+12],20,-1926607734),u=c(u,p,h,f,e[m+5],4,-378558),f=c(f,u,p,h,e[m+8],11,-2022574463),h=c(h,f,u,p,e[m+11],16,1839030562),p=c(p,h,f,u,e[m+14],23,-35309556),u=c(u,p,h,f,e[m+1],4,-1530992060),f=c(f,u,p,h,e[m+4],11,1272893353),h=c(h,f,u,p,e[m+7],16,-155497632),p=c(p,h,f,u,e[m+10],23,-1094730640),u=c(u,p,h,f,e[m+13],4,681279174),f=c(f,u,p,h,e[m+0],11,-358537222),h=c(h,f,u,p,e[m+3],16,-722521979),p=c(p,h,f,u,e[m+6],23,76029189),u=c(u,p,h,f,e[m+9],4,-640364487),f=c(f,u,p,h,e[m+12],11,-421815835),h=c(h,f,u,p,e[m+15],16,530742520),p=c(p,h,f,u,e[m+2],23,-995338651),u=l(u,p,h,f,e[m+0],6,-198630844),f=l(f,u,p,h,e[m+7],10,1126891415),h=l(h,f,u,p,e[m+14],15,-1416354905),p=l(p,h,f,u,e[m+5],21,-57434055),u=l(u,p,h,f,e[m+12],6,1700485571),f=l(f,u,p,h,e[m+3],10,-1894986606),h=l(h,f,u,p,e[m+10],15,-1051523),p=l(p,h,f,u,e[m+1],21,-2054922799),u=l(u,p,h,f,e[m+8],6,1873313359),f=l(f,u,p,h,e[m+15],10,-30611744),h=l(h,f,u,p,e[m+6],15,-1560198380),p=l(p,h,f,u,e[m+13],21,1309151649),u=l(u,p,h,f,e[m+4],6,-145523070),f=l(f,u,p,h,e[m+11],10,-1120210379),h=l(h,f,u,p,e[m+2],15,718787259),p=l(p,h,f,u,e[m+9],21,-343485551),u=r(u,n),p=r(p,i),h=r(h,o),f=r(f,d);return[u,p,h,f]},u={hexdigest:function(e){return function(e){for(var t="",n=0;n<4*e.length;n++)t+="0123456789abcdef".charAt(e[n>>2]>>n%4*8+4&15)+"0123456789abcdef".charAt(e[n>>2]>>n%4*8&15);return t}(d(i(e),8*e.length))},hash:function(e){return function(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}(d(i(e),8*e.length))}}},"./src/sha1.js":function(e,t,n){"use strict";function r(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;var n,r,a,l,d,u,p,h,f=new Array(80),m=1732584193,g=-271733879,v=-1732584194,S=271733878,y=-1009589776;for(n=0;n<e.length;n+=16){for(l=m,d=g,u=v,p=S,h=y,r=0;r<80;r++)f[r]=r<16?e[n+r]:c(f[r-3]^f[r-8]^f[r-14]^f[r-16],1),a=s(s(c(m,5),i(r,g,v,S)),s(s(y,f[r]),o(r))),y=S,S=v,v=c(g,30),g=m,m=a;m=s(m,l),g=s(g,d),v=s(v,u),S=s(S,p),y=s(y,h)}return[m,g,v,S,y]}function i(e,t,n,r){return e<20?t&n|~t&r:e<40?t^n^r:e<60?t&n|t&r|n&r:t^n^r}function o(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function a(e,t){var n=l(e);n.length>16&&(n=r(n,8*e.length));for(var i=new Array(16),o=new Array(16),a=0;a<16;a++)i[a]=909522486^n[a],o[a]=1549556828^n[a];var s=r(i.concat(l(t)),512+8*t.length);return r(o.concat(s),672)}function s(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function c(e,t){return e<<t|e>>>32-t}function l(e){for(var t=[],n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}function d(e){for(var t,n,r="",i=0;i<4*e.length;i+=3)for(t=(e[i>>2]>>8*(3-i%4)&255)<<16|(e[i+1>>2]>>8*(3-(i+1)%4)&255)<<8|e[i+2>>2]>>8*(3-(i+2)%4)&255,n=0;n<4;n++)8*i+6*n>32*e.length?r+="=":r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>6*(3-n)&63);return r}function u(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>24-n%32&255);return t}n.r(t),n.d(t,"default",function(){return p});var p={b64_hmac_sha1:function(e,t){return d(a(e,t))},b64_sha1:function(e){return d(r(l(e),8*e.length))},binb2str:u,core_hmac_sha1:a,str_hmac_sha1:function(e,t){return u(a(e,t))},str_sha1:function(e){return u(r(l(e),8*e.length))}}},"./src/strophe.js":function(e,t,n){"use strict";n.r(t),function(e){var r=n("./src/core.js");n("./src/bosh.js"),n("./src/websocket.js");n.d(t,"default",function(){return r.default}),e.Strophe=r.default.Strophe,e.$build=r.default.$build,e.$iq=r.default.$iq,e.$msg=r.default.$msg,e.$pres=r.default.$pres}.call(this,n("./node_modules/webpack/buildin/global.js"))},"./src/utils.js":function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.r(t),n.d(t,"default",function(){return i});var i={utf16to8:function(e){var t,n,r="",i=e.length;for(t=0;t<i;t++)(n=e.charCodeAt(t))>=0&&n<=127?r+=e.charAt(t):n>2047?(r+=String.fromCharCode(224|n>>12&15),r+=String.fromCharCode(128|n>>6&63),r+=String.fromCharCode(128|n>>0&63)):(r+=String.fromCharCode(192|n>>6&31),r+=String.fromCharCode(128|n>>0&63));return r},addCookies:function(e){for(var t in e=e||{})if(Object.prototype.hasOwnProperty.call(e,t)){var n="",i="",o="",a=e[t],s="object"===r(a),c=escape(unescape(s?a.value:a));s&&(n=a.expires?";expires="+a.expires:"",i=a.domain?";domain="+a.domain:"",o=a.path?";path="+a.path:""),document.cookie=t+"="+c+n+i+o}}}},"./src/websocket.js":function(e,t,n){"use strict";n.r(t);var r=n("./src/core.js"),i=r.default.Strophe,o=r.default.$build;i.Websocket=function(e){this._conn=e,this.strip="wrapper";var t=e.service;if(0!==t.indexOf("ws:")&&0!==t.indexOf("wss:")){var n="";"ws"===e.options.protocol&&"https:"!==window.location.protocol?n+="ws":n+="wss",n+="://"+window.location.host,0!==t.indexOf("/")?n+=window.location.pathname+t:n+=t,e.service=n}},i.Websocket.prototype={_buildStream:function(){return o("open",{xmlns:i.NS.FRAMING,to:this._conn.domain,version:"1.0"})},_check_streamerror:function(e,t){var n;if(0===(n=e.getElementsByTagNameNS?e.getElementsByTagNameNS(i.NS.STREAM,"error"):e.getElementsByTagName("stream:error")).length)return!1;for(var r=n[0],o="",a="",s=0;s<r.childNodes.length;s++){var c=r.childNodes[s];if("urn:ietf:params:xml:ns:xmpp-streams"!==c.getAttribute("xmlns"))break;"text"===c.nodeName?a=c.textContent:o=c.nodeName}var l="WebSocket stream error: ";return l+=o||"unknown",a&&(l+=" - "+a),i.error(l),this._conn._changeConnectStatus(t,o),this._conn._doDisconnect(),!0},_reset:function(){},_connect:function(){this._closeSocket(),this.socket=new WebSocket(this._conn.service,"xmpp"),this.socket.onopen=this._onOpen.bind(this),this.socket.onerror=this._onError.bind(this),this.socket.onclose=this._onClose.bind(this),this.socket.onmessage=this._connect_cb_wrapper.bind(this)},_connect_cb:function(e){if(this._check_streamerror(e,i.Status.CONNFAIL))return i.Status.CONNFAIL},_handleStreamStart:function(e){var t=!1,n=e.getAttribute("xmlns");"string"!=typeof n?t="Missing xmlns in <open />":n!==i.NS.FRAMING&&(t="Wrong xmlns in <open />: "+n);var r=e.getAttribute("version");return"string"!=typeof r?t="Missing version in <open />":"1.0"!==r&&(t="Wrong version in <open />: "+r),!t||(this._conn._changeConnectStatus(i.Status.CONNFAIL,t),this._conn._doDisconnect(),!1)},_connect_cb_wrapper:function(e){if(0===e.data.indexOf("<open ")||0===e.data.indexOf("<?xml")){var t=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===t)return;var n=(new DOMParser).parseFromString(t,"text/xml").documentElement;this._conn.xmlInput(n),this._conn.rawInput(e.data),this._handleStreamStart(n)&&this._connect_cb(n)}else if(0===e.data.indexOf("<close ")){var r=(new DOMParser).parseFromString(e.data,"text/xml").documentElement;this._conn.xmlInput(r),this._conn.rawInput(e.data);var o=r.getAttribute("see-other-uri");if(o){var a=this._conn.service;(a.indexOf("wss:")>=0&&o.indexOf("wss:")>=0||a.indexOf("ws:")>=0)&&(this._conn._changeConnectStatus(i.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=o,this._connect())}else this._conn._changeConnectStatus(i.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect()}else{var s=this._streamWrap(e.data),c=(new DOMParser).parseFromString(s,"text/xml").documentElement;this.socket.onmessage=this._onMessage.bind(this),this._conn._connect_cb(c,null,e.data)}},_disconnect:function(e){if(this.socket&&this.socket.readyState!==WebSocket.CLOSED){e&&this._conn.send(e);var t=o("close",{xmlns:i.NS.FRAMING});this._conn.xmlOutput(t.tree());var n=i.serialize(t);this._conn.rawOutput(n);try{this.socket.send(n)}catch(e){i.info("Couldn't send <close /> tag.")}}this._conn._doDisconnect()},_doDisconnect:function(){i.info("WebSockets _doDisconnect was called"),this._closeSocket()},_streamWrap:function(e){return"<wrapper>"+e+"</wrapper>"},_closeSocket:function(){if(this.socket)try{this.socket.onerror=null,this.socket.close()}catch(e){i.debug(e.message)}this.socket=null},_emptyQueue:function(){return!0},_onClose:function(e){this._conn.connected&&!this._conn.disconnecting?(i.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):e&&1006===e.code&&!this._conn.connected&&this.socket?(i.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(i.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):i.info("Websocket closed")},_no_auth_received:function(e){i.error("Server did not offer a supported authentication mechanism"),this._changeConnectStatus(i.Status.CONNFAIL,i.ErrorCondition.NO_AUTH_MECH),e&&e.call(this._conn),this._conn._doDisconnect()},_onDisconnectTimeout:function(){},_abortAllRequests:function(){},_onError:function(e){i.error("Websocket error "+e),this._conn._changeConnectStatus(i.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()},_onIdle:function(){var e=this._conn._data;if(e.length>0&&!this._conn.paused){for(var t=0;t<e.length;t++)if(null!==e[t]){var n=void 0;n="restart"===e[t]?this._buildStream().tree():e[t];var r=i.serialize(n);this._conn.xmlOutput(n),this._conn.rawOutput(r),this.socket.send(r)}this._conn._data=[]}},_onMessage:function(e){var t,n='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(e.data===n)return this._conn.rawInput(n),this._conn.xmlInput(e),void(this._conn.disconnecting||this._conn._doDisconnect());if(0===e.data.search("<open ")){if(t=(new DOMParser).parseFromString(e.data,"text/xml").documentElement,!this._handleStreamStart(t))return}else{var r=this._streamWrap(e.data);t=(new DOMParser).parseFromString(r,"text/xml").documentElement}return this._check_streamerror(t,i.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===t.firstChild.nodeName&&"unavailable"===t.firstChild.getAttribute("type")?(this._conn.xmlInput(t),void this._conn.rawInput(i.serialize(t))):void this._conn._dataRecv(t,e.data)},_onOpen:function(){i.info("Websocket open");var e=this._buildStream();this._conn.xmlOutput(e.tree());var t=i.serialize(e);this._conn.rawOutput(t),this.socket.send(t)},_reqToData:function(e){return e},_send:function(){this._conn.flush()},_sendRestart:function(){clearTimeout(this._conn._idleTimeout),this._conn._onIdle.bind(this._conn)()}}}}).default}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("strophe.js")):"function"==typeof define&&define.amd?define(["strophe.js"],t):t(e.window)}(this,function(e){"use strict";e.Strophe.addNamespace("RSM","http://jabber.org/protocol/rsm"),e.Strophe.RSM=function(e){if(this.attribs=["max","first","last","after","before","index","count"],void 0!==e.xml)this.fromXMLElement(e.xml);else for(var t=0;t<this.attribs.length;t++){var n=this.attribs[t];this[n]=e[n]}},e.Strophe.RSM.prototype={toXML:function(){for(var t=e.$build("set",{xmlns:e.Strophe.NS.RSM}),n=0;n<this.attribs.length;n++){var r=this.attribs[n];void 0!==this[r]&&(t=t.c(r).t(this[r].toString()).up())}return t.tree()},next:function(t){return new e.Strophe.RSM({max:t,after:this.last})},previous:function(t){return new e.Strophe.RSM({max:t,before:this.first})},fromXMLElement:function(t){for(var n=0;n<this.attribs.length;n++){var r=this.attribs[n],i=t.getElementsByTagName(r)[0];null!=i&&(this[r]=e.Strophe.getText(i),"first"==r&&(this.index=i.getAttribute("index")))}}}}),function(e,t){"function"==typeof define&&define.amd?define(["strophe.js"],function(e){return t(e.Strophe,e.$build,e.$iq,e.$msg,e.$pres),e}):t(e.Strophe,e.$build,e.$iq,e.$msg,e.$pres)}(this,function(e,t,n,r,i){e.addConnectionPlugin("ping",{_c:null,init:function(t){this._c=t,e.addNamespace("PING","urn:xmpp:ping")},ping:function(t,r,i,o){var a=this._c.getUniqueId("ping"),s=n({type:"get",to:t,id:a}).c("ping",{xmlns:e.NS.PING});this._c.sendIQ(s,r,i,o)},pong:function(e){var t=e.getAttribute("from"),r=e.getAttribute("id"),i=n({type:"result",to:t,id:r});this._c.sendIQ(i)},addPingHandler:function(t){return this._c.addHandler(t,e.NS.PING,"iq","get")}})}),function(){"use strict";Strophe.addConnectionPlugin("lastactivity",{_c:null,_n:0,init:function(e){this._c=e,Strophe.addNamespace("LAST_ACTIVITY","jabber:iq:last")},query:function(e,t){var n={type:"get",id:"lastActivityId"+this._n++,from:this._c.jid,to:e},r={xmlns:Strophe.NS.LAST_ACTIVITY},i=$iq(n).c("query",r),o=t.onResponse;return delete t.onResponse,this._c.addHandler(null,Strophe.NS.LAST_ACTIVITY,"message",null),this._c.sendIQ(i,o)}})}(),Strophe.addConnectionPlugin("jingle",{connection:null,sessions:{},jid2session:{},ice_config:{iceServers:[]},company_config:{},pc_constraints:{rtcpMuxPolicy:"require",bundlePolicy:"max-bundle"},media_constraints:{},localStream:null,connectionRef:null,jingleIqTimeout:15e3,init:function(e){for(var t in this.connection=e,this.connection.disco&&(this.connection.disco.addFeature("urn:xmpp:jingle:1"),this.connection.disco.addFeature("urn:xmpp:jingle:apps:rtp:1"),this.connection.disco.addFeature("urn:xmpp:jingle:transports:ice-udp:1"),this.connection.disco.addFeature("urn:xmpp:jingle:apps:rtp:audio"),this.connection.disco.addFeature("urn:xmpp:jingle:apps:rtp:video"),this.connection.disco.addFeature("urn:ietf:rfc:5761")),this.connectionRef&&(this.connection.deleteHandler(this.connectionRef),this.connectionRef=null),config&&config.jingleIqTimeout?this.jingleIqTimeout=config.jingleIqTimeout:this.jingleIqTimeout=15e3,this.connectionRef=this.connection.addHandler(this.onJingle.bind(this),"urn:xmpp:jingle:1","iq","set",null,null),this.sessions)if(this.sessions.hasOwnProperty(t)){var n=this.sessions[t];n.connection=this.connection,null!==n.statsinterval&&(window.clearInterval(n.statsinterval),n.statsinterval=null)}},attachHandlers:function(){this.connectionRef&&(this.connection.deleteHandler(this.connectionRef),this.connectionRef=null),this.connectionRef=this.connection.addHandler(this.onJingle.bind(this),"urn:xmpp:jingle:1","iq","set",null,null)},onJingle:function(e){console.log("[Strophe.jingle] onJingle");try{var t=$(e).find("jingle").attr("sid"),n=$(e).find("jingle").attr("action"),r=$iq({type:"result",to:e.getAttribute("from"),id:e.getAttribute("id")}),i=this.sessions[t];if("session-initiate"!=n){if(null==i)return r.type="error",r.c("error",{type:"cancel"}).c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("unknown-session",{xmlns:"urn:xmpp:jingle:errors:1"}),this.connection.send(r),$(document).trigger("callterminated.jingle",[t]),!0;if(Strophe.getBareJidFromJid(e.getAttribute("from"))!=Strophe.getBareJidFromJid(i.peerjid))return console.warn("[Strophe.jingle] jid mismatch for session id",t,e.getAttribute("from"),i.peerjid),r.type="error",r.c("error",{type:"cancel"}).c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("unknown-session",{xmlns:"urn:xmpp:jingle:errors:1"}),this.connection.send(r),!0}else if(void 0!==i)return r.type="error",r.c("error",{type:"cancel"}).c("service-unavailable",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up(),console.warn("[Strophe.jingle] duplicate session id",t),this.connection.send(r),!0;switch("transport-replace"!==n&&this.connection.send(r),n){case"session-initiate":var o=$(e).find("jingle").attr("localType");console.log("REMOTE TYPE || "+o),(i=new JingleSession($(e).attr("to"),$(e).find("jingle").attr("sid"),this.connection,this.jingleIqTimeout)).media_constraints=this.media_constraints,i.pc_constraints=this.pc_constraints,i.ice_config=this.ice_config,i.company_config=this.company_config,this.jid2session[$(e).attr("from")]&&this.jid2session[$(e).attr("from")].unifiedPlan&&(i.unifiedPlanActivated=!0),i.initiate($(e).attr("from"),!1),i.remoteType=o,i.confId=$(e).find("jingle").attr("confId"),i.publisherId=$(e).find("conference").attr("publisherId");var a=$(e).find("conference").attr("id");a&&(i.conference_id=a),i.setRemoteDescription($(e).find(">jingle"),"offer"),this.sessions[i.sid]=i,this.jid2session[i.peerjid]=i,$(document).trigger("callincoming.jingle",[i.sid]);break;case"transport-replace":i.isReconnecting=!0,console.log("[strophe jingle] Transport replace");o=$(e).find("jingle").attr("localType");console.log("REMOTE TYPE || "+o),i.media_constraints=this.media_constraints,i.pc_constraints=this.pc_constraints,i.ice_config=this.ice_config,i.company_config=this.company_config,i.remoteType=o,this.sessions[i.sid]=i,this.jid2session[i.peerjid]=i,i.hasSentTransportReplace?(console.log("[strophe jingle] Transport replace -- put on hold"),i.saveIncomingTransportReplace($(e).find(">jingle"),"offer",r)):(console.log("[strophe jingle] Transport replace is accepted"),this.connection.send(r),i.setRemoteDescription($(e).find(">jingle"),"offer"),$(document).trigger("transportreplace.jingle",[i.sid]));break;case"session-accept":i.setRemoteDescription($(e).find(">jingle"),"answer");o=$(e).find(">jingle").attr("localType");i.remoteType=o,console.log("REMOTE TYPE || session-accept remoteType "+i.remoteType),console.log("REMOTE TYPE || session-accept localType "+i.localType),i.accept(),$(document).trigger("callaccepted.jingle",[i.sid]);break;case"transport-accept":i.setRemoteDescription($(e).find(">jingle"),"answer"),i.isReconnecting=!1;o=$(e).find(">jingle").attr("localType");i.remoteType=o,console.log("REMOTE TYPE || transport-accept remoteType "+i.remoteType),console.log("REMOTE TYPE || transport-accept localType "+i.localType),$(document).trigger("callaccepted.jingle",[i.sid]);break;case"session-terminate":i.terminate(),this.terminate(i.sid),$(e).find(">jingle>conference").length&&$(e).find(">jingle>conference").attr("reason")?$(document).trigger("callterminated.jingle",[i.sid,"multi-device"]):$(e).find(">jingle>reason").length?$(document).trigger("callterminated.jingle",[i.sid,$(e).find(">jingle>reason>:first")[0].tagName,$(e).find(">jingle>reason>text").text()]):$(document).trigger("callterminated.jingle",[i.sid]);break;case"transport-info":console.log("[JINGLE] transport-info"),i.addIceCandidate($(e).find(">jingle>content"));break;case"session-info":var s;if($(e).find('>jingle>ringing[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').length)$(document).trigger("ringing.jingle",[i.sid]);else if($(e).find('>jingle>mute[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').length)s=$(e).find('>jingle>mute[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').attr("name"),$(document).trigger("mute.jingle",[i.sid,s]);else if($(e).find('>jingle>unmute[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').length)s=$(e).find('>jingle>unmute[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').attr("name"),$(document).trigger("unmute.jingle",[i.sid,s]);else if($(e).find('>jingle>iceFailed[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').length)$(document).trigger("remoteIceFailed.jingle",[i.sid]);else if($(e).find('>jingle>hold[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').length)$(document).trigger("hold.jingle",[i.sid]);else if($(e).find('>jingle>unhold[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').length)$(document).trigger("unhold.jingle",[i.sid]);else if($(e).find('>jingle>refer[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').length){var c=$(e).find('>jingle>refer[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').attr("status"),l=$(e).find('>jingle>refer[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').attr("confEndpointId"),d=$(e).find('>jingle>refer[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').attr("referTo");$(document).trigger("refer.jingle",[i.sid,c,l,d])}break;case"content-add":console.log("[Strophe Jingle] Content-add");var u=$(e).find(">jingle").attr("mediaType");i.remoteType=u,console.log("REMOTE TYPE || content-add remoteType "+i.remoteType),console.log("REMOTE TYPE || content-add localType "+i.localType),i.setRemoteDescription($(e).find(">jingle"),"offer"),i.mediaModified(),$(document).trigger("mediamodified.jingle",[i.sid,u]);break;case"content-modify":console.log("[Strophe Jingle] Content-modify");u=$(e).find(">jingle").attr("mediaType");i.remoteType=u,console.log("REMOTE TYPE || content-modify remoteType "+i.remoteType),console.log("REMOTE TYPE || content-modify localType "+i.localType),i.setRemoteDescription($(e).find(">jingle"),"offer"),i.mediaModified(),$(document).trigger("mediamodified.jingle",[i.sid,u]);break;case"content-remove":console.log("[Strophe Jingle] Content-remove");u=$(e).find(">jingle").attr("mediaType");i.remoteType=u,i.setRemoteDescription($(e).find(">jingle"),"offer"),i.mediaModified(!0),$(document).trigger("mediamodified.jingle",[i.sid,u]);break;case"content-accept":console.log("[Strophe Jingle] Content-accept"),i.setRemoteDescription($(e).find(">jingle"),"answer");break;case"addsource":i.addSource($(e).find(">jingle>content"));break;case"removesource":i.removeSource($(e).find(">jingle>content"));break;default:console.warn("[Strophe.jingle] jingle action not implemented",n)}}catch(e){return console.error("[Strophe.jingle] On Jingle error catch: "+e),!0}return!0},initiate:function(e,t,n,r,i,o,a,s,c){var l=i||Math.random().toString(36).substr(2,12),d=new JingleSession(t||this.connection.jid,l,this.connection,this.jingleIqTimeout);if(r&&r.length)for(var u=0;u<r.length;u++)d.localStreams.push(r[u]);return this.ice_config.iceTransportPolicy=c?"relay":"all",d.media_constraints=this.media_constraints,d.ice_config=this.ice_config,d.company_config=this.company_config,n&&(d.localType=n),void 0!==o&&(d.conference_id=o),d.calledNumber=a&&""!==a?a:null,s&&(d.unifiedPlanActivated=!0),d.initiate(e,!0),this.sessions[d.sid]=d,this.jid2session[d.peerjid]=d,window.setTimeout(()=>{d.sendOffer(!0)},100),d},transfer:function(e,t,n,r,i,o,a,s,c,l){var d=o||Math.random().toString(36).substr(2,12),u=new JingleSession(n||this.connection.jid,d,this.connection,this.jingleIqTimeout);if(i&&i.length)for(var p=0;p<i.length;p++)u.localStreams.push(i[p]);return this.ice_config.iceTransportPolicy=l?"relay":"all",u.media_constraints=this.media_constraints,u.ice_config=this.ice_config,u.company_config=this.company_config,r&&(u.localType=r),void 0!==a&&(u.conference_id=a),u.calledNumber=s&&""!==s?s:null,c&&(u.unifiedPlanActivated=!0),u.initiate(t,!0),this.sessions[u.sid]=u,this.jid2session[u.peerjid]=u,u.sendOfferCopy(e,!0),u},terminate:function(e,t,n){if(null==e)for(e in this.sessions)"ended"!=this.sessions[e].state&&(this.sessions[e].sendTerminate(t||(this.sessions[e].active()?null:"cancel"),n),this.sessions[e].terminate()),delete this.jid2session[this.sessions[e].peerjid],delete this.sessions[e];else this.sessions.hasOwnProperty(e)&&("ended"!=this.sessions[e].state&&(this.sessions[e].sendTerminate(t||(this.sessions[e].active()?null:"cancel"),n),this.sessions[e].terminate()),delete this.jid2session[this.sessions[e].peerjid],delete this.sessions[e])},terminateByJid:function(e){if(this.jid2session.hasOwnProperty(e)){var t=this.jid2session[e];t&&(t.terminate(),delete this.sessions[t.sid],delete this.jid2session[e],$(document).trigger("callterminated.jingle",[t.sid,"gone"]))}}}),SDP=function(e){this.media=e.split("\r\nm=");for(var t=1;t<this.media.length;t++)this.media[t]="m="+this.media[t],t!=this.media.length-1&&(this.media[t]+="\r\n");this.session=this.media.shift()+"\r\n",this.raw=this.session+this.media.join("")},SDP.prototype.mangle=function(){var e,t,n,r,i,o;for(e=0;e<this.media.length;e++)if((r=this.media[e].split("\r\n")).pop(),"audio"==(n=SDPUtil.parse_mline(r.shift())).media){for(o="",n.fmt.length=0,t=0;t<r.length;t++)if("a=rtpmap:"==r[t].substr(0,9)){if("CN"==(i=SDPUtil.parse_rtpmap(r[t])).name||"ISAC"==i.name)continue;n.fmt.push(i.id),o+=r[t]+"\r\n"}else o+=r[t]+"\r\n";this.media[e]=SDPUtil.build_mline(n)+"\r\n",this.media[e]+=o}this.raw=this.session+this.media.join("")},SDP.prototype.removeSessionLines=function(e){var t=this,n=SDPUtil.find_lines(this.session,e);return n.forEach(function(e){t.session=t.session.replace(e+"\r\n","")}),this.raw=this.session+this.media.join(""),n},SDP.prototype.removeMediaLines=function(e,t){var n=this,r=SDPUtil.find_lines(this.media[e],t);return r.forEach(function(t){n.media[e]=n.media[e].replace(t+"\r\n","")}),this.raw=this.session+this.media.join(""),r},SDP.prototype.toJingle=function(e,t,n){var r,i,o,a,s,c,l,d,u;if(SDPUtil.find_line(this.session,"a=group:"))for(d=SDPUtil.find_lines(this.session,"a=group:"),r=0;r<d.length;r++){var p=(l=d[r].split(" ")).shift().substr(8);for(e.c("group",{xmlns:"urn:xmpp:jingle:apps:grouping:0",semantics:p}),i=0;i<l.length;i++)e.c("content",{name:l[i]}).up();e.up()}for(SDPUtil.find_line(this.session,"a=group:BUNDLE")&&SDPUtil.find_line(this.session,"a=group:BUNDLE ").split(" ").shift(),r=0;r<this.media.length;r++)if("audio"==(a=SDPUtil.parse_mline(this.media[r].split("\r\n")[0])).media||"video"==a.media){if(s=!!SDPUtil.find_line(this.media[r],"a=ssrc:")&&SDPUtil.find_line(this.media[r],"a=ssrc:").substring(7).split(" ")[0],u=!!SDPUtil.find_line(this.media[r],"a=simulcast:")&&SDPUtil.find_line(this.media[r],"a=simulcast:").substring(12).trim(),e.c("content",{creator:t,name:a.media}),SDPUtil.find_line(this.media[r],"a=mid:")){var h=SDPUtil.parse_mid(SDPUtil.find_line(this.media[r],"a=mid:"));e.attrs({name:h})}if(SDPUtil.find_line(this.media[r],"a=rtpmap:").length){for(e.c("description",{xmlns:"urn:xmpp:jingle:apps:rtp:1",media:a.media}),s&&e.attrs({ssrc:s}),i=0;i<a.fmt.length;i++){if(c=SDPUtil.find_line(this.media[r],"a=rtpmap:"+a.fmt[i]),e.c("payload-type",SDPUtil.parse_rtpmap(c)),SDPUtil.find_line(this.media[r],"a=fmtp:"+a.fmt[i]))for(l=SDPUtil.parse_fmtp(SDPUtil.find_line(this.media[r],"a=fmtp:"+a.fmt[i])),o=0;o<l.length;o++)e.c("parameter",l[o]).up();this.RtcpFbToJingle(r,e,a.fmt[i]),e.up()}if(SDPUtil.find_line(this.media[r],"a=crypto:",this.session))e.c("encryption",{required:1}),SDPUtil.find_lines(this.media[r],"a=crypto:",this.session).forEach(function(t){e.c("crypto",SDPUtil.parse_crypto(t)).up()}),e.up();if(s)e.c("source",{ssrc:s,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),SDPUtil.find_lines(this.media[r],"a=ssrc:").forEach(function(t){idx=t.indexOf(" ");var n=t.substr(0,idx).substr(7);n!=s&&(e.up(),s=n,e.c("source",{ssrc:s,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}));var r=t.substr(idx+1);e.c("parameter"),-1==r.indexOf(":")?e.attrs({name:r}):(e.attrs({name:r.split(":",2)[0]}),e.attrs({value:r.split(":",2)[1]})),e.up()}),e.up();if(u)e.c("simulcast",{rids:u,xmlns:"urn:xmpp:jingle:apps:rtp:sim:0"}),SDPUtil.find_lines(this.media[r],"a=rid:").forEach(function(t){var n=t.indexOf(" "),r=t.substr(0,n).substr(6);e.c("rid",{xmlns:"urn:xmpp:jingle:apps:rtp:rid:0",name:r}),e.up()}),e.up();if(SDPUtil.find_lines(this.media[r],"a=ssrc-group").forEach(function(t){idx=t.indexOf(" ");var n=t.substr(0,idx).substr(13);for(e.c("ssrc-group",{xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0",semantics:n}),kv=t.substr(idx+1);kv.length>0;){var r;idx=kv.indexOf(" "),idx>0?(r=kv.substr(0,idx),kv=kv.substr(idx+1)):(r=kv.substr(0,kv.length),kv=""),e.c("source",{ssrc:r}).up()}e.up()}),SDPUtil.find_line(this.media[r],"a=rtcp-mux")&&e.c("rtcp-mux").up(),this.RtcpFbToJingle(r,e,"*"),SDPUtil.find_line(this.media[r],"a=extmap:"))for(d=SDPUtil.find_lines(this.media[r],"a=extmap:"),i=0;i<d.length;i++){if(l=SDPUtil.parse_extmap(d[i]),e.c("rtp-hdrext",{xmlns:"urn:xmpp:jingle:apps:rtp:rtp-hdrext:0",uri:l.uri,id:l.value}),l.hasOwnProperty("direction"))switch(l.direction){case"sendonly":e.attrs({senders:"responder"});break;case"recvonly":e.attrs({senders:"initiator"});break;case"sendrecv":e.attrs({senders:"both"});break;case"inactive":e.attrs({senders:"none"})}e.up()}e.up()}this.TransportToJingle(r,e),SDPUtil.find_line(this.media[r],"a=sendrecv",this.session)?e.attrs({senders:"both"}):SDPUtil.find_line(this.media[r],"a=sendonly",this.session)?e.attrs({senders:"initiator"}):SDPUtil.find_line(this.media[r],"a=recvonly",this.session)?e.attrs({senders:"responder"}):SDPUtil.find_line(this.media[r],"a=inactive",this.session)&&e.attrs({senders:"none"}),"0"!=a.port||SDPUtil.find_line(this.media[r],"a=bundle-only",this.session)||e.attrs({senders:"rejected"}),e.up()}return n&&-1!==n&&(e.c("conference",{xmlns:"urn:xmpp:janus:1",id:n}),e.up()),e.up(),e},SDP.prototype.TransportToJingle=function(e,t){var n,r=this;(t.c("transport"),SDPUtil.find_lines(this.media[e],"a=fingerprint:",this.session).forEach(function(i){(n=SDPUtil.parse_fingerprint(i)).xmlns="urn:xmpp:jingle:apps:dtls:0",t.c("fingerprint").t(n.fingerprint),delete n.fingerprint,(i=SDPUtil.find_line(r.media[e],"a=setup:",r.session))&&(n.setup=i.substr(8)),t.attrs(n),t.up()}),n=SDPUtil.iceparams(this.media[e],this.session))&&(n.xmlns="urn:xmpp:jingle:transports:ice-udp:1",t.attrs(n),SDPUtil.find_line(this.media[e],"a=candidate:",this.session)&&SDPUtil.find_lines(this.media[e],"a=candidate:",this.session).forEach(function(e){t.c("candidate",SDPUtil.candidateToJingle(e)).up()}));t.up()},SDP.prototype.RtcpFbToJingle=function(e,t,n){SDPUtil.find_lines(this.media[e],"a=rtcp-fb:"+n).forEach(function(e){var n=SDPUtil.parse_rtcpfb(e);"trr-int"==n.type?(t.c("rtcp-fb-trr-int",{xmlns:"urn:xmpp:jingle:apps:rtp:rtcp-fb:0",value:n.params[0]}),t.up()):(t.c("rtcp-fb",{xmlns:"urn:xmpp:jingle:apps:rtp:rtcp-fb:0",type:n.type}),n.params.length>0&&t.attrs({subtype:n.params[0]}),t.up())})},SDP.prototype.RtcpFbFromJingle=function(e,t){var n="",r=e.find('>rtcp-fb-trr-int[xmlns="urn:xmpp:jingle:apps:rtp:rtcp-fb:0"]');return r.length&&(n+="a=rtcp-fb:* trr-int ",r.attr("value")?n+=r.attr("value"):n+="0",n+="\r\n"),(r=e.find('>rtcp-fb[xmlns="urn:xmpp:jingle:apps:rtp:rtcp-fb:0"]')).each(function(){n+="a=rtcp-fb:"+t+" "+$(this).attr("type"),$(this).attr("subtype")&&(n+=" "+$(this).attr("subtype")),n+="\r\n"}),n},SDP.prototype.fromJingle=function(e){var t=this;if(this.raw="v=0\r\no=- 1923518516 2 IN IP4 0.0.0.0\r\ns=-\r\nt=0 0\r\n",$(e).find('>group[xmlns="urn:xmpp:jingle:apps:grouping:0"]').length)$(e).find('>group[xmlns="urn:xmpp:jingle:apps:grouping:0"]').each(function(e,n){var r=$(n).find(">content").map(function(e,t){return t.getAttribute("name")}).get();r.length>0&&(t.raw+="a=group:"+(n.getAttribute("semantics")||n.getAttribute("type"))+" "+r.join(" ")+"\r\n")});else if($(e).find('>group[xmlns="urn:ietf:rfc:5888"]').length)$(e).find('>group[xmlns="urn:ietf:rfc:5888"]').each(function(e,n){var r=$(n).find(">content").map(function(e,t){return t.getAttribute("name")}).get();null!==n.getAttribute("type")&&r.length>0&&(t.raw+="a=group:"+n.getAttribute("type")+" "+r.join(" ")+"\r\n")});else{var n=$(e).find(">content").filter(function(e,t){return $(t).find(">bundle").length>0}).map(function(e,t){return t.getAttribute("name")}).get();n.length&&(this.raw+="a=group:BUNDLE "+n.join(" ")+"\r\n")}this.raw+="a=ice-options:trickle\r\n",this.session=this.raw,e.find(">content").each(function(){var e=t.jingle2media($(this));t.media.push(e)});var r=SDPUtil.parse_ssrc(this.raw);r.hasOwnProperty("mslabel")&&r.mslabel&&(this.session+="a=msid-semantic: WMS "+r.mslabel+"\r\n"),this.raw=this.session+this.media.join("")},SDP.prototype.jingle2media=function(e){var t,n="",r=e.find("description"),i=(r.attr("ssrc"),this);if((t={media:r.attr("media")}).port="1","rejected"==e.attr("senders")&&(t.port="0"),e.find(">transport>fingerprint").length||r.find("encryption").length?t.proto="RTP/SAVPF":t.proto="RTP/AVPF",t.fmt=r.find("payload-type").map(function(){return this.getAttribute("id")}).get(),n+=SDPUtil.build_mline(t)+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:1 IN IP4 0.0.0.0\r\n",(t=e.find('>transport[xmlns="urn:xmpp:jingle:transports:ice-udp:1"]')).length&&(t.attr("ufrag")&&(n+=SDPUtil.build_iceufrag(t.attr("ufrag"))+"\r\n"),t.attr("pwd")&&(n+=SDPUtil.build_icepwd(t.attr("pwd"))+"\r\n"),t.find(">fingerprint").each(function(){n+="a=fingerprint:"+this.getAttribute("hash"),n+=" "+$(this).text(),n+="\r\n",this.getAttribute("setup")&&(n+="a=setup:"+this.getAttribute("setup")+"\r\n")})),(t=e.find('description>simulcast[xmlns="urn:xmpp:jingle:apps:rtp:sim:0"]')).length){var o=t.attr("rids");o&&(n+="a=simulcast: "+o+"\r\n"),t.find(">rid").each(function(){n+="a=rid:"+this.getAttribute("name")+" recv",n+="\r\n"})}switch(e.attr("senders")){case"initiator":n+="a=sendonly\r\n";break;case"responder":n+="a=recvonly\r\n";break;case"none":n+="a=inactive\r\n";break;case"both":n+="a=sendrecv\r\n"}return n+="a=mid:"+e.attr("name")+"\r\n",r.find("rtcp-mux").length&&(n+="a=rtcp-mux\r\n"),r.find("encryption").length&&r.find("encryption>crypto").each(function(){n+="a=crypto:"+this.getAttribute("tag"),n+=" "+this.getAttribute("crypto-suite"),n+=" "+this.getAttribute("key-params"),this.getAttribute("session-params")&&(n+=" "+this.getAttribute("session-params")),n+="\r\n"}),r.find("payload-type").each(function(){n+=SDPUtil.build_rtpmap(this)+"\r\n",$(this).find(">parameter").length&&(n+="a=fmtp:"+this.getAttribute("id")+" ",n+=$(this).find("parameter").map(function(){return(this.getAttribute("name")?this.getAttribute("name")+"=":"")+this.getAttribute("value")}).get().join(";"),n+="\r\n"),n+=i.RtcpFbFromJingle($(this),this.getAttribute("id"))}),n+=i.RtcpFbFromJingle(r,"*"),(t=r.find('>rtp-hdrext[xmlns="urn:xmpp:jingle:apps:rtp:rtp-hdrext:0"]')).each(function(){n+="a=extmap:"+this.getAttribute("id")+" "+this.getAttribute("uri")+"\r\n"}),e.find('>transport[xmlns="urn:xmpp:jingle:transports:ice-udp:1"]>candidate').each(function(){n+=SDPUtil.candidateFromJingle(this)}),(t=e.find('description>source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]')).each(function(){var e=this.getAttribute("ssrc");$(this).find(">parameter").each(function(){this.getAttribute("name")&&this.getAttribute("name").length&&this.getAttribute("value")&&this.getAttribute("value").length&&(n+="a=ssrc:"+e+" "+this.getAttribute("name")+":"+this.getAttribute("value")),n+="\r\n"})}),(t=e.find('description>ssrc-group[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]')).each(function(){var e=this.getAttribute("semantics");n+="a=ssrc-group:"+e,$(this).find(">source").each(function(){n+=" "+this.getAttribute("ssrc")}),n+="\r\n"}),n},SDPUtil={iceparams:function(e,t){var n=null;return SDPUtil.find_line(e,"a=ice-ufrag:",t)&&SDPUtil.find_line(e,"a=ice-pwd:",t)&&(n={ufrag:SDPUtil.parse_iceufrag(SDPUtil.find_line(e,"a=ice-ufrag:",t)),pwd:SDPUtil.parse_icepwd(SDPUtil.find_line(e,"a=ice-pwd:",t))}),n},parse_iceufrag:function(e){return e.substring(12)},build_iceufrag:function(e){return"a=ice-ufrag:"+e},parse_icepwd:function(e){return e.substring(10)},build_icepwd:function(e){return"a=ice-pwd:"+e},parse_mid:function(e){return e.substring(6)},parse_mline:function(e){var t=e.substring(2).split(" "),n={};return n.media=t.shift(),n.port=t.shift(),n.proto=t.shift(),""===t[t.length-1]&&t.pop(),n.fmt=t,n},build_mline:function(e){return"m="+e.media+" "+e.port+" "+e.proto+" "+e.fmt.join(" ")},parse_rtpmap:function(e){var t=e.substring(9).split(" "),n={};return n.id=t.shift(),t=t[0].split("/"),n.name=t.shift(),n.clockrate=t.shift(),n.channels=t.length?t.shift():"1",n},build_rtpmap:function(e){var t="a=rtpmap:"+e.getAttribute("id")+" "+e.getAttribute("name")+"/"+e.getAttribute("clockrate");return e.getAttribute("channels")&&"1"!=e.getAttribute("channels")&&(t+="/"+e.getAttribute("channels")),t},parse_simulcast:function(e){var t=e.substr(13).split(" "),n={};return n.direction=t.shift(),n.rid=t.shift().substr(4),n},parse_crypto:function(e){var t=e.substring(9).split(" "),n={};return n.tag=t.shift(),n["crypto-suite"]=t.shift(),n["key-params"]=t.shift(),t.length&&(n["session-params"]=t.join(" ")),n},parse_fingerprint:function(e){var t=e.substring(14).split(" "),n={};return n.hash=t.shift(),n.fingerprint=t.shift(),n},parse_fmtp:function(e){var t,n,r,i=e.split(" "),o=[];for(i.shift(),i=i.join(" ").split(";"),t=0;t<i.length;t++){for(n=i[t].split("=")[0];n.length&&" "==n[0];)n=n.substring(1);r=i[t].split("=")[1],n&&r?o.push({name:n,value:r}):n&&o.push({name:"",value:n})}return o},parse_icecandidate:function(e){console.log("[Strophe.jingle] jingle.sdp.parse_icecandidate "+e);var t={},n=e.split(" ");t.foundation=n[0].substring(12),t.component=n[1],t.protocol=n[2].toLowerCase(),t.priority=n[3],t.ip=n[4],t.port=n[5],t.type=n[7],t.generation=0;for(var r=8;r<n.length;r+=2)switch(n[r]){case"raddr":t["rel-addr"]=n[r+1];break;case"rport":t["rel-port"]=n[r+1];break;case"generation":t.generation=n[r+1];break;case"tcptype":t.tcptype=n[r+1];break;default:console.log('[Strophe.jingle] parse_icecandidate not translating "'+n[r]+'" = "'+n[r+1]+'"')}return t.network="1",t.id=Math.random().toString(36).substr(2,10),t},build_icecandidate:function(e){var t=["a=candidate:"+e.foundation,e.component,e.protocol,e.priority,e.ip,e.port,"typ",e.type].join(" ");switch(t+=" ",e.type){case"srflx":case"prflx":case"relay":e.hasOwnAttribute("rel-addr")&&e.hasOwnAttribute("rel-port")&&(t+="raddr",t+=" ",t+=e["rel-addr"],t+=" ",t+="rport",t+=" ",t+=e["rel-port"],t+=" ")}return e.hasOwnAttribute("tcptype")&&(t+="tcptype",t+=" ",t+=e.tcptype,t+=" "),t+="generation",t+=" ",t+=e.hasOwnAttribute("generation")?e.generation:"0",console.log("[Strophe.jingle] jingle.sdp.build_icecandidate "+t),t},parse_ssrc:function(e){for(var t=e.split("\r\n"),n={},r=0;r<t.length;r++)if("a=ssrc:"==t[r].substring(0,7)){var i=t[r].indexOf(" ");n[t[r].substr(i+1).split(":",2)[0]]=t[r].substr(i+1).split(":",2)[1]}return n},parse_rtcpfb:function(e){var t=e.substr(10).split(" "),n={};return n.pt=t.shift(),n.type=t.shift(),n.params=t,n},parse_extmap:function(e){var t=e.substr(9).split(" "),n={};return n.value=t.shift(),-1!=n.value.indexOf("/")?(n.direction=n.value.substr(n.value.indexOf("/")+1),n.value=n.value.substr(0,n.value.indexOf("/"))):n.direction="both",n.uri=t.shift(),n.params=t,n},find_line:function(e,t,n){for(var r=e.split("\r\n"),i=0;i<r.length;i++)if(r[i].substring(0,t.length)==t)return r[i];if(!n)return!1;r=n.split("\r\n");for(var o=0;o<r.length;o++)if(r[o].substring(0,t.length)==t)return r[o];return!1},find_lines:function(e,t,n){for(var r=e.split("\r\n"),i=[],o=0;o<r.length;o++)r[o].substring(0,t.length)==t&&i.push(r[o]);if(i.length||!n)return i;r=n.split("\r\n");for(var a=0;a<r.length;a++)r[a].substring(0,t.length)==t&&i.push(r[a]);return i},candidateToJingle:function(e){if(console.log("[Strophe.jingle] !!! jingle.sdp.candidateToJingle "+e),0===e.indexOf("candidate:"))e="a="+e;else if("a=candidate:"!=e.substring(0,12))return console.log("[Strophe.jingle] parseCandidate called with a line that is not a candidate line"),console.log("[Strophe.jingle] "+e),null;"\r\n"==e.substring(e.length-2)&&(e=e.substring(0,e.length-2));var t,n={},r=e.split(" ");if("typ"!=r[6])return console.log("[Strophe.jingle] did not find typ in the right place"),console.log("[Strophe.jingle] "+e),null;for(n.foundation=r[0].substring(12),n.component=r[1],n.protocol=r[2].toLowerCase(),n.priority=r[3],n.ip=r[4],n.port=r[5],n.type=r[7],n.generation="0",t=8;t<r.length;t+=2)switch(r[t]){case"raddr":n["rel-addr"]=r[t+1];break;case"rport":n["rel-port"]=r[t+1];break;case"generation":n.generation=r[t+1];break;case"tcptype":n.tcptype=r[t+1];break;case"network-cost":n.cost=r[t+1];break;case"network-id":n.network=r[t+1];break;default:console.log('[Strophe.jingle] not translating "'+r[t]+'" = "'+r[t+1]+'"')}return n.id=Math.random().toString(36).substr(2,10),n},candidateFromJingle:function(e,t,n){var r=["a=candidate:"+e.getAttribute("foundation"),e.getAttribute("component"),e.getAttribute("protocol"),e.getAttribute("priority"),e.getAttribute("ip"),e.getAttribute("port"),"typ",e.getAttribute("type")];switch(e.getAttribute("type")){case"srflx":case"prflx":case"relay":e.getAttribute("rel-addr")&&e.getAttribute("rel-port")&&(r.push("raddr"),r.push(e.getAttribute("rel-addr")),r.push("rport"),r.push(e.getAttribute("rel-port")))}return r.push("generation"),r.push(e.getAttribute("generation")||"0"),e.getAttribute("network")&&(r.push("network-id"),r.push(e.getAttribute("network"))),e.getAttribute("cost")&&(r.push("network-cost"),r.push(e.getAttribute("cost"))),t&&(r.push("ufrag"),r.push(t)),n&&(r.push("pwd"),r.push(n)),r.join(" ")+"\r\n"}},JingleSession=function(e,t,n,r){this.me=e,this.sid=t,this.connection=n,this.initiator=null,this.responder=null,this.isInitiator=null,this.peerjid=null,this.state=null,this.peerconnection=null,this.remoteStream=null,this.localSDP=null,this.remoteSDP=null,this.localStreams=[],this.localTransceivers=[],this.remoteStreams=[],this.remoteStreamsObject={},this.startTime=null,this.stopTime=null,this.media_constraints=null,this.pc_constraints=null,this.ice_config={},this.company_config={},this.hadstuncandidate=!1,this.hadturncandidate=!1,this.statsinterval=null,this.reason=null,this.addssrc=[],this.removessrc=[],this.pendingop=null,this.wait=!0,this.isRenegotiating=!1,this.remoteType=null,this.localType=null,this.videoSender=null,this.jingleIqTimeout=15e3,r&&(this.jingleIqTimeout=r),this.conference_id=-1,this.calledNumber=null,this.DTX=!1,this.unifiedPlanActivated=!1,this.hasSentTransportReplace=!1,this.iceFilterList=[]},JingleSession.prototype.initiate=function(e,t){Strophe.log("","[Strophe.jingle] initiate");var n=this;if(null===this.state){this.isInitiator=t,this.initiator=t?this.me:e,this.responder=t?e:this.me,this.peerjid=e;var r={};if(this.ice_config.sdpSemantics="plan-b",adapter&&adapter.default&&"chrome"===adapter.default.browserDetails.browser&&adapter.default.browserDetails.version>=70){var i=function(e){var t=null;if(e){var n=e.indexOf("web_sdk");-1!==n&&(t=e.substr(n+10,2),t=parseInt(t,10))}return t}(e);i&&i<53&&(Strophe.log("","[Strophe.jingle] Unified plan activated"),this.ice_config.sdpSemantics="unified-plan")}this.unifiedPlanActivated&&(this.ice_config.sdpSemantics="unified-plan"),Strophe.log("","[Strophe.jingle] SDP activated: "+this.ice_config.sdpSemantics),(this.conference_id&&-1!==this.conference_id||this.ice_config.unifiedPlan)&&(this.unifiedPlanActivated=!0,Strophe.log("","[Strophe.jingle] FORCED Unified plan activated"),this.ice_config.sdpSemantics="unified-plan"),this.ice_config.enableDSCP&&(Strophe.log("","[Strophe.jingle] googDscp activated"),r={optional:[{googDscp:!0}]}),this.ice_config.dtx&&(Strophe.log("","[Strophe.jingle] Discontinuous Transmission (DTX) activated"),this.DTX=!0),this.company_config&&this.company_config.negotiation&&this.company_config.negotiation.iceFiltering&&(this.iceFilterList=this.company_config.negotiation.iceFiltering.length?this.company_config.negotiation.iceFiltering:[]);try{this.peerconnection=new window.RTCPeerConnection(this.ice_config,r)}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] Failed to create PeerConnection, exception: ",e.message),Strophe.log(Strophe.LogLevel.ERROR,e);try{this.peerconnection=new window.RTCPeerConnection,this.peerconnection.setConfiguration&&this.peerconnection.setConfiguration(this.ice_config)}catch(t){return Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] Failed to create PeerConnection, exception: ",e.message),void Strophe.log(Strophe.LogLevel.ERROR,t)}}this.peerconnection.onicecandidate=function(e){this.isRenegotiating?Strophe.log("","[Strophe.jingle] onicecandidate not added due to renegotiation"):n.sendIceCandidate(e.candidate)};this.peerconnection.onaddstream=function(e){if(!n.unifiedPlanActivated){Strophe.log("","[Strophe.jingle] onAddStream");var t=e.stream;if(n.remoteStream=t,"audio"===n.remoteType||"video"===n.remoteType)for(;n.remoteStreams.length>0;)n.remoteStreams.pop();else for(var r=0;r<n.remoteStreams.length&&n.remoteStreams[r];r++)n.remoteStreams[r].active?t.getAudioTracks().length?n.remoteStreams[r].getAudioTracks().length&&n.remoteStreams.splice(r,1):!n.remoteStreams[r].getAudioTracks().length&&n.remoteStreams[r].getVideoTracks().length&&n.remoteStreams.splice(r,1):n.remoteStreams.splice(r,1);for(n.remoteStreams.push(t),Strophe.log("",n.remoteStreams),Strophe.log("","[Strophe.jingle] peer.onaddstream",t.id,t),t.hasOwnProperty("active")&&Strophe.log("","[Strophe.jingle] stream active ? ",t.active),Strophe.log("","[Strophe.jingle] audio Tracks: "+t.getAudioTracks().length+" | Video Tracks: "+t.getVideoTracks().length),r=0;r<t.getAudioTracks().length;r++){var i=t.getAudioTracks()[r];Strophe.log("","[Strophe.jingle] audio Track: "+i.id+" | "+i.kind+" | "+i.enabled+" | "+i.readyState,i)}for(r=0;r<t.getVideoTracks().length;r++)i=t.getVideoTracks()[r],Strophe.log("","[Strophe.jingle] video Track: "+i.id+" | "+i.kind+" | "+i.enabled+" | "+i.readyState,i);t.onactive=function(){Strophe.log("","[Strophe.jingle] stream.onactive",t)},t.onaddtrack=function(e){Strophe.log("","[Strophe.jingle] stream.onaddtrack: "+e.track.id+" | "+e.track.kind+" | "+e.track.enabled+" | "+e.track.readyState,e.track)},t.onremovetrack=function(e){Strophe.log("","[Strophe.jingle] stream.onremovetrack: "+e.track.id+" | "+e.track.kind+" | "+e.track.enabled+" | "+e.track.readyState,e.track)},t.oninactive=function(){Strophe.log("","[Strophe.jingle] stream.oninactive",t)},$(document).trigger("remotestreamadded.jingle",[n.sid,t.getAudioTracks().length])}},this.peerconnection.ontrack=function(e){n.unifiedPlanActivated&&(n.conference_id&&-1!==n.conference_id?n.createRemoteStreamForConference(e.transceiver):n.createOrUpdateRemoteStreams(e.transceiver))},this.peerconnection.onremovetrack=function(e){n.unifiedPlanActivated},this.peerconnection.onremovestream=function(e){Strophe.log("","[Strophe.jingle] peer.onremovestream"),$(document).trigger("remotestreamremoved.jingle",[e,n.sid])},this.peerconnection.onsignalingstatechange=function(e){n&&n.peerconnection&&$(document).trigger("iceconnectionstatechange.jingle",[n.sid,n])},this.peerconnection.oniceconnectionstatechange=function(e){if(n&&n.peerconnection){switch(n.peerconnection.iceConnectionState){case"connected":this.startTime=new Date,Strophe.log("","[Strophe.jingle] iceConnectionState is connected, try to update the RTP Sender ");break;case"closed":case"disconnected":this.stopTime=new Date}$(document).trigger("iceconnectionstatechange.jingle",[n.sid,n])}},this.localStreams.forEach(function(e){n.unifiedPlanActivated?n.addStream(e):n.peerconnection.addStream(e)})}else Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] attempt to initiate on session "+this.sid+"in state "+this.state)},JingleSession.prototype.createRemoteStreamForConference=function(e){var t=new MediaStream;t.addTrack(e.receiver.track),this.remoteStreamsObject[0]=t},JingleSession.prototype.createOrUpdateRemoteStreams=function(e){var t=parseInt(e.mid),n=new MediaStream;this.remoteStreamsObject[t]?(this.remoteStreamsObject[t].removeTrack(this.remoteStreamsObject[t].getTracks()[0]),this.remoteStreamsObject[t].addTrack(e.receiver.track)):(n.addTrack(e.receiver.track),this.remoteStreamsObject[t]=n)},JingleSession.prototype.updateRemoteStreams=function(){var e=this;this.localTransceivers.forEach(function(t){t.currentDirection&&"sendonly"!==t.currentDirection&&"inactive"!==t.currentDirection||(e.remoteStreamsObject[t.mid]=null)})},JingleSession.prototype.addStream=function(e){if(this.unifiedPlanActivated){if(this.conference_id&&-1!==this.conference_id){var t=e.getAudioTracks().length?"audio":"video";return this.localTransceivers[0]||(adapter&&adapter.default&&"chrome"===adapter.default.browserDetails.browser&&adapter.default.browserDetails.version>=70&&"video"===t&&"video"===this.localType?(Strophe.log("","[Strophe.jingle] Enabling Simulcasting for Chrome (via transceiver configuration)"),this.localTransceivers[0]=this.peerconnection.addTransceiver(t,{sendEncodings:[{rid:"h",active:!0,maxBitrate:9e5},{rid:"m",active:!0,maxBitrate:3e5,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:1e5,scaleResolutionDownBy:4}]})):this.localTransceivers[0]=this.peerconnection.addTransceiver(t)),this.localTransceivers[0].sender.replaceTrack("audio"===t?e.getAudioTracks()[0]:e.getVideoTracks()[0]),void(this.localTransceivers[0].direction="sendrecv")}return e.getAudioTracks().length>0&&(this.localTransceivers[0]||(this.localTransceivers[0]=this.peerconnection.addTransceiver("audio")),this.localTransceivers[0].sender.replaceTrack(e.getAudioTracks()[0]),this.localTransceivers[0].direction="sendrecv"),e.getVideoTracks().length>0&&e.getAudioTracks().length>0&&(this.localTransceivers[0]||(this.localTransceivers[0]=this.peerconnection.addTransceiver("audio",{direction:"recvonly"})),this.localTransceivers[1]||(this.localTransceivers[1]=this.peerconnection.addTransceiver("video")),this.localTransceivers[1].sender.replaceTrack(e.getVideoTracks()[0]),this.localTransceivers[1].direction="sendrecv"),void(e.getVideoTracks().length>0&&!e.getAudioTracks().length&&(this.localTransceivers[0]||(this.localTransceivers[0]=this.peerconnection.addTransceiver("audio",{direction:"recvonly"})),this.localTransceivers[1]||this.localTransceivers.push(this.peerconnection.addTransceiver("video",{direction:"recvonly"})),"videoOnly"===this.localType?(this.localTransceivers[1].sender.replaceTrack(e.getVideoTracks()[0]),this.localTransceivers[1].direction="sendrecv"):(this.localTransceivers[2]||this.localTransceivers.push(this.peerconnection.addTransceiver("video")),this.localTransceivers[2].sender.replaceTrack(e.getVideoTracks()[0]),this.localTransceivers[2].direction="sendrecv")))}switch(adapter.default.browserDetails.browser){case"chrome":case"edge":this.peerconnection.addStream(e);break;case"firefox":case"safari":e.getAudioTracks().length>0&&this.peerconnection.addTrack(e.getAudioTracks()[0],e),e.getVideoTracks().length>0&&this.peerconnection.addTrack(e.getVideoTracks()[0],e)}},JingleSession.prototype.removeStream=function(e,t){if(Strophe.log("","[Strophe.jingle] detected WebRTC browser is "+adapter.default.browserDetails.browser),this.unifiedPlanActivated)return this.peerconnection.getTransceivers().forEach(function(e){e.sender.replaceTrack(null),e.direction="recvonly"}),void(this.localTransceivers=this.peerconnection.getTransceivers());switch(adapter.default.browserDetails.browser){case"chrome":case"edge":this.peerconnection.removeStream(e)}},JingleSession.prototype.addTrack=function(e){e.getAudioTracks().length>0&&this.peerconnection.addTrack(e.getAudioTracks()[0],e),e.getVideoTracks().length>0&&this.peerconnection.addTrack(e.getVideoTracks()[0],e)},JingleSession.prototype.replaceStream=function(e){switch(Strophe.log("","[Strophe.jingle] detected WebRTC browser is "+adapter.default.browserDetails.browser),adapter.default.browserDetails.browser){case"chrome":break;case"firefox":case"safari":if(this.unifiedPlanActivated)return void this.addStream(e);var t=e.getAudioTracks()[0],n=e.getVideoTracks()[0];Strophe.log(Strophe.LogLevel.ERROR,t),Strophe.log(Strophe.LogLevel.ERROR,n);var r=!1,i=!1;if(this.peerconnection.getSenders().forEach(function(e){n&&e.track&&"video"===e.track.kind&&(e.replaceTrack(n),Strophe.log("","[Strophe.jingle] replaceTrack video "+e),r=!0),t&&e.track&&"audio"===e.track.kind&&(Strophe.log("","[Strophe.jingle] replaceTrack audio "+e),e.replaceTrack(t),i=!0)}),n&&!r)Strophe.log("","[Strophe.jingle] addTrack yourVideoTrack"),this.videoSender=this.peerconnection.addTrack(n,e);else if(this.videoSender){Strophe.log("","[Strophe.jingle] removeTrack yourVideoTrack");try{this.peerconnection.removeTrack(this.videoSender),this.videoSender=null}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] removeTrack error "+e)}}t&&!i&&(Strophe.log("","[Strophe.jingle] add new audio track"),this.peerconnection.addTrack(t,e))}},JingleSession.prototype.addConferenceInfo=function(e){-1!==this.conference_id&&(e.c("conference",{xmlns:"urn:xmpp:janus:1",id:this.conference_id}),e.up())},JingleSession.prototype.accept=function(){try{var e=this;this.state="active";var t=this.peerconnection.localDescription;if(!t||"pranswer"!=t.type)return;for(Strophe.log("","[Strophe.jingle] going from pranswer to answer");SDPUtil.find_line(t.sdp,"a=inactive");)t.sdp=t.sdp.replace("a=inactive","a=sendrecv");t=this.hackMsLabelSDP(t);var n=new SDP(t.sdp),r=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-accept",initiator:this.initiator,responder:this.responder,sid:this.sid,localType:this.localType});n.toJingle(r,this.initiator==this.me?"initiator":"responder",this.conference_id,this.calledNumber),this.connection.sendIQ(r,function(){var t={source:"answer"};$(document).trigger("ack.jingle",[e.sid,t])},function(t){var n=$(t).find("error").length?{code:$(t).find("error").attr("code"),reason:$(t).find("error :first")[0].tagName}:{};n.source="answer",$(document).trigger("error.jingle",{sid:e.sid,error:n})},this.jingleIqTimeout);for(var i=this.peerconnection.localDescription.sdp;SDPUtil.find_line(i,"a=inactive");)i=i.replace("a=inactive","a=sendrecv");this.peerconnection.setLocalDescription(new window.RTCSessionDescription({type:"answer",sdp:i}),function(){$(document).trigger("setLocalDescription.jingle",[e.sid]),Strophe.log("","[Strophe.jingle] setLocalDescription success, try to update the RTP Sender "),e.ice_config.enableDSCP&&e.peerconnection.getSenders().forEach(function(e){if(e.getParameters&&e.setParameters){var t=e.getParameters();t.encodings.forEach(function(e){e.priority="high",e.networkPriority="high"}),e.setParameters(t),Strophe.log("","[Strophe.jingle] RTP Sender parameters are updated "+e.getParameters())}})},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] setLocalDescription failed",e)})}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.accept failed: "+e)}},JingleSession.prototype.terminate=function(e){this.state="ended",this.reason=e,this.peerconnection&&"closed"!==this.peerconnection.signalingState&&this.peerconnection.close(),Strophe.log("","[Strophe.jingle] Clear peerconnection"),this.peerconnection=null,null!==this.statsinterval&&(window.clearInterval(this.statsinterval),this.statsinterval=null),this.localStreams&&this.localStreams.length&&this.localStreams.forEach(function(e){e.getTracks().forEach(function(e){e.enabled=!1,e.stop(),e=null}),e.stop&&e.stop(),e=null})},JingleSession.prototype.active=function(){return"active"==this.state},JingleSession.prototype.sendIceCandidate=function(e){if(e&&this.iceFilterList&&this.iceFilterList.length&&-1!==this.iceFilterList.indexOf(e.type))Strophe.log("","[Strophe.jingle] ICE candidate "+e.type+" is filtered");else if(e){Strophe.log("","[Strophe.jingle] sendIceCandidate "+e);var t=SDPUtil.iceparams(this.localSDP.media[e.sdpMLineIndex],this.localSDP.session),n=SDPUtil.candidateToJingle(e.candidate);if(!t||!n)return void Strophe.log("","[Strophe.jingle] failed to get ice && jcand");t.xmlns="urn:xmpp:jingle:transports:ice-udp:1",Strophe.log("","[Strophe.jingle] sending single candidate"),this.isRenegotiating?Strophe.log("","[Strophe.jingle] NOT sending candidate due to Renegotiation"):this.sendIceCandidates([e])}},JingleSession.prototype.sendIceCandidates=function(e){try{Strophe.log("","[Strophe.jingle] sendIceCandidates",e);for(var t=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"transport-info",initiator:this.initiator,sid:this.sid,localType:this.localType}),n=0;n<this.localSDP.media.length;n++){var r=e.filter(function(e){return e.sdpMLineIndex==n}),i=SDPUtil.parse_mline(this.localSDP.media[n].split("\r\n")[0]);if(r.length>0){var o=SDPUtil.iceparams(this.localSDP.media[n],this.localSDP.session);o.xmlns="urn:xmpp:jingle:transports:ice-udp:1",t.c("content",{creator:this.initiator==this.me?"initiator":"responder",name:r[0].sdpMid?r[0].sdpMid:i.media}).c("transport",o);for(var a=0;a<r.length;a++)t.c("candidate",SDPUtil.candidateToJingle(r[a].candidate)).up();if(SDPUtil.find_line(this.localSDP.media[n],"a=fingerprint:",this.localSDP.session)){var s=SDPUtil.parse_fingerprint(SDPUtil.find_line(this.localSDP.media[n],"a=fingerprint:",this.localSDP.session));s.required=!0,s.xmlns="urn:xmpp:jingle:apps:dtls:0",t.c("fingerprint").t(s.fingerprint),delete s.fingerprint,t.attrs(s),t.up()}t.up(),t.up()}}if(config.turnOn&&!(t.node.innerHTML.indexOf('type="relay')>-1))return void Strophe.log("","[Strophe.jingle] Debug flag turnOn : Ignore candidate");Strophe.log("","[Strophe.jingle] try to send ack(transportinfo)..."),this.connection.sendIQ(t,function(){var e={source:"transportinfo"};Strophe.log("","Sent session initiate (ACK, transportinfo)..."),$(document).trigger("ack.jingle",[this.sid,e])},function(e){var t=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};t.source="transportinfo",$(document).trigger("error.jingle",{sid:this.sid,error:t})},this.jingleIqTimeout)}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.sendIceCandidates failed: "+e)}},JingleSession.prototype.hackOfferSDP=function(e){return"firefox"!==adapter.default.browserDetails.browser&&(e.sdp=e.sdp.replace(/a=sendonly/g,"a=sendrecv")),-1!==this.conference_id&&"video"===this.localType&&(e.sdp=e.sdp.replace(/a=sendrecv/g,"a=sendonly")),navigator.platform.toUpperCase().indexOf("MAC")>=0&&(e.sdp=this.forceCodecTo(e.sdp,"H264/90000","video")),e},JingleSession.prototype.hackMsLabelSDP=function(e){for(var t=e.sdp.split("\r\n"),n=0;n<t.length;n++)if("a=ssrc:"==t[n].substring(0,7)){var r=t[n].indexOf(" ");!t[n].substr(r+1).split(":",2)[0]||void 0!==t[n].substr(r+1).split(":",2)[1]&&""!==t[n].substr(r+1).split(":",2)[1]||t.splice(n,1)}return e.sdp=t.join("\r\n"),e},JingleSession.prototype.sendTransportReplace=function(){Strophe.log("","[Strophe.jingle] sendTransportReplace");var e=this,t={iceRestart:!0};e.isReconnecting?Strophe.log("","[Strophe.jingle] sendTransportReplace ignored because we're already connecting"):(e.isReconnecting=!0,this.peerconnection.createOffer(function(t){e.createdOffer(t,"transport-replace")},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] createOffer failed",e)},t))},JingleSession.prototype.reconnectSession=function(){Strophe.log("","[Strophe.jingle] reconnectSession");var e=this,t={iceRestart:!0};e.isReconnecting?Strophe.log("","[Strophe.jingle] reconnectSession ignored because we're already connecting"):(e.isReconnecting=!0,e.hasSentTransportReplace=!0,this.peerconnection.createOffer(function(t){e.sendCreatedOfferWithAckWait(t,"transport-replace")},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] createOffer failed",e)},t))},JingleSession.prototype.saveIncomingTransportReplace=function(e,t,n){Strophe.log("","[Strophe.jingle] saveIncomingTransportReplace"),this.savedIncomingTransportReplace={elem:e,desctype:t,ack:n}},JingleSession.prototype.acceptSavedIncomingTransportReplace=function(){Strophe.log("","[Strophe.jingle] acceptSavedIncomingTransportReplace"),this.connection.send(this.savedIncomingTransportReplace.ack),this.setRemoteDescription(this.savedIncomingTransportReplace.elem,this.savedIncomingTransportReplace.desctype),$(document).trigger("transportreplace.jingle",[this.sid]),this.savedIncomingTransportReplace=null},JingleSession.prototype.rejectSavedIncomingTransportReplace=function(){if(Strophe.log("","[Strophe.jingle] rejectSavedIncomingTransportReplace"),this.savedIncomingTransportReplace&&this.savedIncomingTransportReplace.ack){var e=this.savedIncomingTransportReplace.ack;e.type="error",e.c("error",{type:"reject"}),this.connection.send(e)}this.savedIncomingTransportReplace=null},JingleSession.prototype.sendCreatedOfferWithAckWait=function(e,t){try{e=this.hackOfferSDP(e),e=this.hackMsLabelSDP(e);var n=this;this.localSDP=new SDP(e.sdp);var r=t||"session-initiate";Strophe.log("","[Strophe.jingle] sendCreatedOfferWithAckWait with SDP : "+e.sdp+" and action : "+r);var i=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:r,initiator:this.initiator,sid:this.sid,localType:this.localType});this.calledNumber&&""!==this.calledNumber&&((i=i.c("mediapillar",{xmlns:"urn:xmpp:janus:1"}).c("callednumber").t(this.calledNumber)).up(),i.up()),this.localSDP.toJingle(i,this.initiator==this.me?"initiator":"responder",this.conference_id),this.connection.sendIQ(i,function(t){if(t&&$(t).find("error").length)return Strophe.log("","[Strophe.jingle] sendCreatedOfferWithAckWait -- IQ ACK with error"),n.hasSentTransportReplace=!1,void(n.savedIncomingTransportReplace&&n.acceptSavedIncomingTransportReplace());if(Strophe.log("","[Strophe.jingle] sendCreatedOfferWithAckWait -- IQ ACK received, set local description"),n.hasSentTransportReplace=!1,n.savedIncomingTransportReplace){if(!n.isInitiator)return void n.acceptSavedIncomingTransportReplace();n.rejectSavedIncomingTransportReplace()}e.sdp=n.localSDP.raw,n.peerconnection.setLocalDescription(e,function(){$(document).trigger("setLocalDescription.jingle",[n.sid]),Strophe.log("","[Strophe.jingle] setLocalDescription success")},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] setLocalDescription failed",e)})},function(){Strophe.log("","[Strophe.jingle] sendCreatedOfferWithAckWait -- IQ rejected"),n.hasSentTransportReplace=!1,n.savedIncomingTransportReplace?n.acceptSavedIncomingTransportReplace():n.isReconnecting=!1},this.jingleIqTimeout)}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.createdOffer failed: "+e)}},JingleSession.prototype.sendOffer=function(e){Strophe.log("","[Strophe.jingle] sendOffer");var t=this;if(e){Strophe.log("","ice restart");var n={};if((-1===this.conference_id&&!this.calledNumber||"video"!==this.localType)&&(n.iceRestart=!0),-1!==this.conference_id&&(n.iceRestart=!0),this.ice_config.simulcast&&-1!==this.conference_id&&"video"===this.localType&&adapter&&adapter.default&&"firefox"===adapter.default.browserDetails.browser){Strophe.log("","[Strophe.jingle] Enabling Simulcasting for Firefox (RID)");var r=this.peerconnection.getSenders().find(function(e){return"video"==e.track.kind});if(r){var i=r.getParameters();i||(i={}),i.encodings=[{rid:"h",active:!0,maxBitrate:9e5},{rid:"m",active:!0,maxBitrate:3e5,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:1e5,scaleResolutionDownBy:4}],r.setParameters(i)}}this.peerconnection.createOffer(function(e){t.createdOffer(e)},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] createOffer failed",e)},n)}else this.peerconnection.createOffer(function(e){t.createdOffer(e)},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] createOffer failed",e)},this.media_constraints)},JingleSession.prototype.sendOfferCopy=function(e,t){Strophe.log("","[Strophe.jingle] sendOfferCopy");var n=this;if(t){Strophe.log("","ice restart");var r={};if((-1===this.conference_id&&!this.calledNumber||"video"!==this.localType)&&(r.iceRestart=!0),-1!==this.conference_id&&(r.iceRestart=!0),this.ice_config.simulcast&&-1!==this.conference_id&&"video"===this.localType&&adapter&&adapter.default&&"firefox"===adapter.default.browserDetails.browser){Strophe.log("","[Strophe.jingle] Enabling Simulcasting for Firefox (RID)");var i=this.peerconnection.getSenders().find(function(e){return"video"==e.track.kind});if(i){var o=i.getParameters();o||(o={}),o.encodings=[{rid:"h",active:!0,maxBitrate:9e5},{rid:"m",active:!0,maxBitrate:3e5,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:1e5,scaleResolutionDownBy:4}],i.setParameters(o)}}this.peerconnection.createOffer(function(t){n.copyCreatedOffer(e,t)},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] createOffer failed",e)},r)}else this.peerconnection.createOffer(function(t){n.copyCreatedOffer(e,t)},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] createOffer failed",e)},this.media_constraints)},JingleSession.prototype.createdOffer=function(e,t){try{e=this.hackOfferSDP(e),e=this.hackMsLabelSDP(e);var n=this;this.localSDP=new SDP(e.sdp);var r=t||"session-initiate";Strophe.log("","[Strophe.jingle] createdOffer with SDP : "+e.sdp+" and action : "+r);var i=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:r,initiator:this.initiator,sid:this.sid,localType:this.localType});this.calledNumber&&""!==this.calledNumber&&((i=i.c("mediapillar",{xmlns:"urn:xmpp:janus:1"}).c("callednumber").t(this.calledNumber)).up(),i.up()),this.localSDP.toJingle(i,this.initiator==this.me?"initiator":"responder",this.conference_id),this.connection.sendIQ(i,function(){var e={source:"offer"};$(document).trigger("ack.jingle",[n.sid,e])},function(e){n.state="error",n.peerconnection&&"closed"!==n.peerconnection.signalingState&&(Strophe.log("","[Strophe.jingle] Clear peerconnection"),n.peerconnection.close(),n.peerconnection=null);var t=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};t.source="offer",$(document).trigger("error.jingle",{sid:n.sid,error:t})},this.jingleIqTimeout),e.sdp=this.localSDP.raw,this.peerconnection.setLocalDescription(e,function(){$(document).trigger("setLocalDescription.jingle",[n.sid]),Strophe.log("","[Strophe.jingle] setLocalDescription success")},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] setLocalDescription failed",e)})}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.createdOffer failed: "+e)}},JingleSession.prototype.copyCreatedOffer=function(e,t,n){try{t=this.hackOfferSDP(t),t=this.hackMsLabelSDP(t);var r=this;this.localSDP=e.localSDP;var i=n||"session-initiate";Strophe.log("","[Strophe.jingle] copyCreatedOffer with SDP : "+this.localSDP);var o=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:i,initiator:this.initiator,sid:this.sid,localType:this.localType});this.calledNumber&&""!==this.calledNumber&&((o=o.c("mediapillar",{xmlns:"urn:xmpp:janus:1"}).c("callednumber").t(this.calledNumber)).up(),o.up()),this.localSDP.toJingle(o,this.initiator==this.me?"initiator":"responder",this.conference_id),this.connection.sendIQ(o,function(){var e={source:"offer"};$(document).trigger("ack.jingle",[r.sid,e])},function(e){r.state="error",r.peerconnection&&"closed"!==r.peerconnection.signalingState&&(Strophe.log("","[Strophe.jingle] Clear peerconnection"),r.peerconnection.close(),r.peerconnection=null);var t=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};t.source="offer",$(document).trigger("error.jingle",{sid:r.sid,error:t})},this.jingleIqTimeout),t.sdp=this.localSDP.raw,this.peerconnection.setLocalDescription(t,function(){$(document).trigger("setLocalDescription.jingle",[r.sid]),Strophe.log("","[Strophe.jingle] setLocalDescription success")},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] setLocalDescription failed",e)})}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.createdOffer failed: "+e)}},JingleSession.prototype.contentRemove=function(e){Strophe.log("","[Strophe.jingle] contentRemove");var t=this;this.peerconnection.createOffer(function(n){t.contentUpdateOffer(n,e,"remove")},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] contentRemove failed",e)},this.media_constraints)},JingleSession.prototype.contentAdd=function(e){Strophe.log("","[Strophe.jingle] contentAdd");var t=this;this.peerconnection.createOffer(function(n){t.contentUpdateOffer(n,e,"add")},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] contentAdd failed",e)},this.media_constraints)},JingleSession.prototype.contentModify=function(e){Strophe.log("","[Strophe.jingle] contentModify");var t=this;this.peerconnection.createOffer(function(n){t.contentUpdateOffer(n,e,"modify")},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] contentModify failed",e)},this.media_constraints)},JingleSession.prototype.contentUpdateOffer=function(e,t,n){try{Strophe.log("","[Strophe.jingle] contentUpdateOffer",e.sdp);var r=this;e=this.hackMsLabelSDP(e),this.localSDP=new SDP(e.sdp),"audio"===t?r.localType="audio":"video"===t?r.localType="audio+video":"sharing"===t?r.localType="sharing":"sharing+video"===t&&(r.localType="sharing+video");var i=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"content-"+n,initiator:this.initiator,sid:this.sid,mediaType:t});this.calledNumber&&""!==this.calledNumber&&((i=i.c("mediapillar",{xmlns:"urn:xmpp:janus:1"}).c("callednumber").t(this.calledNumber)).up(),i.up()),this.localSDP.toJingle(i,this.initiator==this.me?"initiator":"responder",this.conference_id),this.connection.sendIQ(i,function(){var e={source:"offer"};$(document).trigger("ack.jingle",[r.sid,e])},function(e){r.state="error",r.peerconnection&&(Strophe.log("","[Strophe.jingle] Clear peerconnection"),r.peerconnection.close(),r.peerconnection=null);var t=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};t.source="offer",$(document).trigger("error.jingle",{sid:r.sid,error:t})},this.jingleIqTimeout),e.sdp=this.localSDP.raw,this.peerconnection.setLocalDescription(e,function(){$(document).trigger("setLocalDescription.jingle",[r.sid]),Strophe.log("","[Strophe.jingle] setLocalDescription success")},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] setLocalDescription failed",e)})}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.contentUpdateOffer failed: "+e)}},JingleSession.prototype.contentChangeAnswer=function(e,t){try{Strophe.log("","[Strophe.jingle] contentChangeAnswer",e.sdp);var n=this;e=this.hackMsLabelSDP(e),this.localSDP=new SDP(e.sdp);var r=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"content-accept",initiator:this.initiator,sid:this.sid});this.calledNumber&&""!==this.calledNumber&&((r=r.c("mediapillar",{xmlns:"urn:xmpp:janus:1"}).c("callednumber").t(this.calledNumber)).up(),r.up()),this.localSDP.toJingle(r,this.initiator==this.me?"initiator":"responder",this.conference_id),this.connection.sendIQ(r,function(){var e={source:"offer"};$(document).trigger("ack.jingle",[n.sid,e])},function(e){n.state="error",n.peerconnection&&(Strophe.log("","[Strophe.jingle] Clear peerconnection"),n.peerconnection.close(),n.peerconnection=null);var t=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};t.source="offer",$(document).trigger("error.jingle",{sid:n.sid,error:t})},this.jingleIqTimeout),e.sdp=this.localSDP.raw,this.peerconnection.setLocalDescription(e,function(){$(document).trigger("setLocalDescription.jingle",[n.sid]),Strophe.log("","[Strophe.jingle] setLocalDescription success"),n.unifiedPlanActivated&&t&&n.updateRemoteStreams()},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] setLocalDescription failed",e)})}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.contentChangeAnswer failed: "+e)}},JingleSession.prototype.updateBandwidthRestriction=function(e){"use strict";if("audio"===this.localType||-1!==this.conference_id||this.confId||this.publisherId)return Strophe.log("","[Strophe.jingle] do not updateBandwidthRestriction"),e;var t=!1;this.peerjid&&(t=-1!==this.peerjid.indexOf("mobile_android")||-1!==this.peerjid.indexOf("mobile_ios")||-1!==this.peerjid.indexOf("deskphone"));var n=t?500:1200;"sharing"!==this.localType&&"sharing"!==this.remoteType||(n=t?800:1500),"sharing+video"===this.localType&&(n=t?1300:2700);var r="AS";if("firefox"===adapter.default.browserDetails.browser&&(n=1e3*(n>>>0),r="TIAS"),n>0)if(-1===e.indexOf("b="+r+":")){var i=e.indexOf("m=video");if(i>0){var o=e.substring(i);o=o.replace(/c=IN (.*)\r\n/,"c=IN $1\r\nb="+r+":"+n+"\r\n"),e=e.substring(0,i)+o}}else e=e.replace(new RegExp("b="+r+":.*\r\n"),"b="+r+":"+n+"\r\n");else e.replace(new RegExp("b="+r+":.*\r\n"),"");return Strophe.log("","[Strophe.jingle] updateBandwidthRestriction to ",n),e},JingleSession.prototype.setRemoteDescription=function(e,t){Strophe.log("","[Strophe.jingle] setRemoteDescription ",t);var n=this;this.remoteSDP=new SDP(""),this.remoteSDP.fromJingle(e),this.isInitiator?this.remoteSDP.raw=this.remoteSDP.raw.replace(/a=setup:passive/g,"a=setup:active"):this.remoteSDP.raw=this.remoteSDP.raw.replace(/a=setup:active/g,"a=setup:passive"),navigator.platform.toUpperCase().indexOf("MAC")>=0&&(this.remoteSDP.raw=this.forceCodecTo(this.remoteSDP.raw,"H264/90000","video")),this.remoteSDP.raw=this.updateBandwidthRestriction(this.remoteSDP.raw),this.DTX&&(Strophe.log("","[Strophe.jingle] activate Discontinuous Transmission (DTX)"),this.remoteSDP.raw=this.remoteSDP.raw.replace("useinbandfec=1","useinbandfec=1;usedtx=1")),Strophe.log("","[Strophe.jingle] setRemoteDescription after parsing for session "+this.sid+" : "+this.remoteSDP.raw);var r=new window.RTCSessionDescription({type:t,sdp:this.remoteSDP.raw});Strophe.log("","[Strophe.jingle] setRemoteDescription object ",r),this.peerconnection.setRemoteDescription(r,function(){Strophe.log("","[Strophe.jingle] setRemoteDescription success"),n.unifiedPlanActivated&&(n.localTransceivers=n.peerconnection.getTransceivers())},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] setRemoteDescription error "+e)}),Strophe.log("","[Strophe.jingle] setRemoteDescription is setting, try to update the RTP Sender "),this.ice_config.enableDSCP&&this.peerconnection.getSenders().forEach(function(e){if(console.error(e),e.getParameters&&e.setParameters){var t=e.getParameters();console.error(t),t.encodings.forEach(function(e){e.priority="high",e.networkPriority="high"}),e.setParameters(t),console.error(e.getParameters())}})},JingleSession.prototype.addIceCandidate=function(e){Strophe.log("","[Strophe.jingle] addIceCandidate");var t=this;e.each(function(){var e,n=-1;for(e=0;e<t.remoteSDP.media.length;e++)if(SDPUtil.find_line(t.remoteSDP.media[e],"a=mid:"+$(this).attr("name"))||0===t.remoteSDP.media[e].indexOf("m="+$(this).attr("name"))){n=e;break}if(-1==n)for(e=0;e<t.localSDP.media.length;e++)if(SDPUtil.find_line(t.localSDP.media[e],"a=mid:"+$(this).attr("name"))||0===t.localSDP.media[e].indexOf("m="+$(this).attr("name"))){n=e;break}var r,i,o=$(this).attr("name");$(this).find("content>transport").each(function(){r=this.getAttribute("ufrag"),i=this.getAttribute("pwd")}),$(this).find("transport>candidate").each(function(){var e,a;e=SDPUtil.candidateFromJingle(this,r,i),a=new window.RTCIceCandidate({sdpMLineIndex:n,sdpMid:o,candidate:e});try{if(a&&t.iceFilterList&&t.iceFilterList.length&&-1!==t.iceFilterList.indexOf(a.type))return void Strophe.log("","[Strophe.jingle] Received ICE candidate "+a.type+" is filtered");t.peerconnection.addIceCandidate(a)}catch(t){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] addIceCandidate failed",t.toString(),e)}})})},JingleSession.prototype.sendAnswer=function(e,t){Strophe.log("","[Strophe.jingle] sendAnswer",e);var n=this;this.peerconnection.createAnswer(function(r){n.createdAnswer(r,e,t)},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] createAnswer failed",e)},this.media_constraints)},JingleSession.prototype.createdAnswer=function(e,t,n){try{Strophe.log("","[Strophe.jingle] createdAnswer");var r=this;e=this.hackMsLabelSDP(e),this.localSDP=new SDP(e.sdp),this.usepranswer=!0===t;var i=n||"session-accept";n&&(r.isReconnecting=!1),Strophe.log("","sdp is "+e.sdp);var o=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:i,initiator:this.initiator,responder:this.responder,sid:this.sid,localType:this.localType});this.calledNumber&&""!==this.calledNumber&&((o=o.c("mediapillar",{xmlns:"urn:xmpp:janus:1"}).c("callednumber").t(this.calledNumber)).up(),o.up()),this.localSDP.toJingle(o,this.initiator==this.me?"initiator":"responder",this.conference_id),this.connection.sendIQ(o,function(){var e={source:"answer"};$(document).trigger("ack.jingle",[r.sid,e])},function(e){var t=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};t.source="answer",$(document).trigger("error.jingle",{sid:r.sid,error:t})},this.jingleIqTimeout),e.sdp=this.localSDP.raw,this.peerconnection.setLocalDescription(e,function(){$(document).trigger("setLocalDescription.jingle",[r.sid]),Strophe.log("","[Strophe.jingle] createdAnswer -- setLocalDescription success, try to update the RTP Sender "),r.ice_config.enableDSCP&&r.peerconnection.getSenders().forEach(function(e){if(e.getParameters&&e.setParameters){var t=e.getParameters();t.encodings.forEach(function(e){e.priority="high",e.networkPriority="high"}),e.setParameters(t),Strophe.log("","[Strophe.jingle] RTP Sender parameters are updated "+e.getParameters())}})},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] setLocalDescription failed",e)});for(var a=SDPUtil.find_lines(this.localSDP.raw,"a=candidate:"),s=0;s<a.length;s++){var c=SDPUtil.parse_icecandidate(a[s]);"srflx"==c.type?this.hadstuncandidate=!0:"relay"==c.type&&(this.hadturncandidate=!0)}}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.createdAnswer failed: "+e)}},JingleSession.prototype.sendTerminate=function(e,t){try{var n=this,r=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-terminate",initiator:this.initiator,sid:this.sid}).c("reason").c(e||"success");t&&r.up().c("text").t(t),this.connection.sendIQ(r,function(){!n.peerconnection||"closed"===n.peerconnection.signalingState&&"undefined"!=n.peerconnection.signalingState||(n.peerconnection.close(),n.terminate()),Strophe.log("","[Strophe.jingle] Clear peerconnection"),n.peerconnection=null;var e={source:"terminate"};$(document).trigger("ack.jingle",[n.sid,e])},function(e){var t=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};$(document).trigger("ack.jingle",[n.sid,t])},this.jingleIqTimeout),null!==this.statsinterval&&(window.clearInterval(this.statsinterval),this.statsinterval=null)}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.sendTerminate failed: "+e)}},JingleSession.prototype.mediaModified=function(e){var t=this;this.peerconnection.createAnswer(function(n){t.contentChangeAnswer(n,e)},function(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] contentChange failed",e)},this.media_constraints)},JingleSession.prototype.addSource=function(e){Strophe.log("","[Strophe.jingle] addssrc",(new Date).getTime()),Strophe.log("","[Strophe.jingle] ice",this.peerconnection.iceConnectionState);var t=new SDP(this.peerconnection.remoteDescription.sdp),n=this;$(e).each(function(e,r){var i=$(r).attr("name"),o="";tmp=$(r).find('>source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]'),tmp.each(function(){var e=$(this).attr("ssrc");$(this).find(">parameter").each(function(){o+="a=ssrc:"+e+" "+$(this).attr("name"),$(this).attr("value")&&$(this).attr("value").length&&(o+=":"+$(this).attr("value")),o+="\r\n"})}),t.media.forEach(function(e,r){SDPUtil.find_line(e,"a=mid:"+i)&&(t.media[r]+=o,n.addssrc[r]||(n.addssrc[r]=""),n.addssrc[r]+=o)}),t.raw=t.session+t.media.join("")}),this.modifySources()},JingleSession.prototype.removeSource=function(e){Strophe.log("","[Strophe.jingle] removessrc",(new Date).getTime()),Strophe.log("","[Strophe.jingle] ice",this.peerconnection.iceConnectionState);var t=new SDP(this.peerconnection.remoteDescription.sdp),n=this;$(e).each(function(e,r){var i=$(r).attr("name"),o="";tmp=$(r).find('>source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]'),tmp.each(function(){var e=$(this).attr("ssrc");$(this).find(">parameter").each(function(){o+="a=ssrc:"+e+" "+$(this).attr("name"),$(this).attr("value")&&$(this).attr("value").length&&(o+=":"+$(this).attr("value")),o+="\r\n"})}),t.media.forEach(function(e,r){SDPUtil.find_line(e,"a=mid:"+i)&&(t.media[r]+=o,n.addssrc[r]||(n.removessrc[r]=""),n.removessrc[r]+=o)}),t.raw=t.session+t.media.join("")}),this.modifySources()},JingleSession.prototype.modifySources=function(){var e=this;if(this.peerconnection&&"closed"!=this.peerconnection.signalingState&&(this.addssrc.length||this.removessrc.length||null!==this.pendingop)){if(!this.wait&&("stable"!=this.peerconnection.signalingState||"connected"!=this.peerconnection.iceConnectionState&&"completed"!=this.peerconnection.iceConnectionState))return console.warn("[Strophe.jingle] modifySources not yet",this.peerconnection.signalingState,this.peerconnection.iceConnectionState),this.wait=!0,void window.setTimeout(function(){e.modifySources()},1500);if(this.wait)return window.setTimeout(function(){e.modifySources()},2500),void(this.wait=!1);var t=new SDP(this.peerconnection.remoteDescription.sdp);this.addssrc.forEach(function(e,n){t.media[n]+=e}),this.addssrc=[],this.removessrc.forEach(function(e,n){(e=e.split("\r\n")).pop(),e.forEach(function(e){t.media[n]=t.media[n].replace(e+"\r\n","")})}),this.removessrc=[],t.raw=t.session+t.media.join(""),this.peerconnection.setRemoteDescription(new window.RTCSessionDescription({type:"offer",sdp:t.raw}),function(){e.peerconnection.createAnswer(function(t){if(null!==e.pendingop){var n=new SDP(t.sdp);if(n.media.length>1){switch(e.pendingop){case"mute":n.media[1]=n.media[1].replace("a=sendrecv","a=recvonly");break;case"unmute":n.media[1]=n.media[1].replace("a=recvonly","a=sendrecv")}n.raw=n.session+n.media.join(""),t.sdp=n.raw}e.pendingop=null}e.peerconnection.setLocalDescription(t,function(){$(document).trigger("setLocalDescription.jingle",[e.sid])},function(e){Strophe.log("","[Strophe.jingle] modified setLocalDescription failed")})},function(e){Strophe.log("","[Strophe.jingle] modified answer failed")})},function(e){Strophe.log("","[Strophe.jingle] modify failed")})}},JingleSession.prototype.hardMuteVideo=function(e){this.connection.jingle.localStream&&(this.pendingop=e?"mute":"unmute",this.modifySources(),this.connection.jingle.localStream.getVideoTracks().forEach(function(t){t.enabled=!e}))},JingleSession.prototype.mute=function(e){this.connection.jingle.localStream&&(this.pendingop=e?"mute":"unmute",this.modifySources(),this.connection.jingle.localStream.getVideoTracks().forEach(function(t){t.enabled=!e}),this.connection.jingle.localStream.getAudioTracks().forEach(function(t){t.enabled=!e}))},JingleSession.prototype.muteVideo=function(e){this.connection.jingle.localStream&&(this.pendingop=e?"mute":"unmute",this.modifySources(),this.connection.jingle.localStream.getVideoTracks().forEach(function(t){t.enabled=!e}))},JingleSession.prototype.muteAudio=function(e){this.connection.jingle.localStream&&this.connection.jingle.localStream.getAudioTracks().forEach(function(t){t.enabled=!e}),this.localStreams.length>=1&&this.localStreams.forEach(function(t){t.getAudioTracks().forEach(function(t){t.enabled=!e})})},JingleSession.prototype.sendMute=function(e,t){try{var n=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-info",initiator:this.initiator,sid:this.sid});n.c(e?"mute":"unmute",{xmlns:"urn:xmpp:jingle:apps:rtp:info:1"}),n.attrs({creator:this.me==this.initiator?"creator":"responder"}),t&&n.attrs({name:t}),this.connection.sendIQ(n)}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.sendMute failed: "+e)}},JingleSession.prototype.sendRefer=function(e,t){try{var n=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-info",initiator:this.initiator,sid:this.sid});n.c("refer",{xmlns:"urn:xmpp:jingle:apps:rtp:info:1"}),n.attrs({confEndpointId:e,referTo:t}),this.connection.sendIQ(n)}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.sendRefer failed: "+e)}},JingleSession.prototype.sendReferStatus=function(e){try{var t=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-info",initiator:this.initiator,sid:this.sid});t.c("refer",{xmlns:"urn:xmpp:jingle:apps:rtp:info:1"}),t.attrs({status:e}),this.connection.sendIQ(t)}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.sendReferStatus failed: "+e)}},JingleSession.prototype.sendHold=function(e){try{var t=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-info",initiator:this.initiator,sid:this.sid});t.c(e?"hold":"unhold",{xmlns:"urn:xmpp:jingle:apps:rtp:info:1"}),this.connection.sendIQ(t)}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.sendMute failed: "+e)}},JingleSession.prototype.sendIceFailed=function(){try{var e=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-info",initiator:this.initiator,sid:this.sid});e.c("iceFailed",{xmlns:"urn:xmpp:jingle:apps:rtp:info:1"}),this.connection.sendIQ(e)}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.sendIceFailed failed: "+e)}},JingleSession.prototype.sendRinging=function(){try{var e=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-info",initiator:this.initiator,sid:this.sid});e.c("ringing",{xmlns:"urn:xmpp:jingle:apps:rtp:info:1"}),this.connection.sendIQ(e)}catch(e){Strophe.log(Strophe.LogLevel.ERROR,"[Strophe.jingle] JingleSession.prototype.sendRinging failed: "+e)}},JingleSession.prototype.modifyEncodingState=function(e){Strophe.log("","[Strophe.jingle] modifyEncodingState "+e);var t=this.peerconnection.getSenders().find(e=>"video"===e.track.kind),n=t.getParameters(),r=2;n.encodings[0].rid&&"h"===n.encodings[0].rid&&(r=0),n.encodings[r].active=e,t.setParameters(n)},JingleSession.prototype.forceCodecTo=function(e,t,n){for(var r,i,o,a,s,c=e.split("\r\n"),l=-1,d=-1,u=[],p=[],h=0,f=c.length;h<f;h++){var m=c[h];if(m.indexOf("m="+n)>-1&&(l=h,d=m.indexOf("RTP/SAVPF")+10,p=m.substring(d).split(" ")),m.indexOf(t)>-1){for(r=m.indexOf(":"),i=m.indexOf(" "),o=m.substring(r+1,i),a=-1,u.push(o),s=0;s<p.length;s++)if(p[s]===o){a=s;break}a>-1&&p.splice(a,1)}if("PCMU/8000"===t&&m.indexOf("PCMA/8000")>-1){for(r=m.indexOf(":"),i=m.indexOf(" "),o=m.substring(r+1,i),a=-1,u.push(o),s=0;s<p.length;s++)if(p[s]===o){a=s;break}a>-1&&p.splice(a,1)}}if(-1!==l){c[l]=c[l].substr(0,d-1);for(var g=0;g<u.length;g++)c[l]+=" "+u[g];p.length>0&&(c[l]+=" "+p.join(" ")),e=c.join("\r\n")}return e},JingleSession.prototype.mungeSdpForSimulcasting=function(e){for(var t=e.split("\r\n"),n=!1,r=[-1],i=[-1],o=null,a=null,s=null,c=null,l=-1,d=0;d<t.length;d++){if(p=t[d].match(/m=(\w+) */)){if("video"===p[1]){if(!(r[0]<0)){l=d;break}n=!0}else if(r[0]>-1){l=d;break}}else if(n){var u=t[d].match(/a=ssrc-group:FID (\d+) (\d+)/);if(u)r[0]=u[1],i[0]=u[2],t.splice(d,1),d--;else{if(r[0]){if((f=t[d].match("a=ssrc:"+r[0]+" cname:(.+)"))&&(o=f[1]),(f=t[d].match("a=ssrc:"+r[0]+" msid:(.+)"))&&(a=f[1]),(f=t[d].match("a=ssrc:"+r[0]+" mslabel:(.+)"))&&(s=f[1]),(f=t[d].match("a=ssrc:"+r[0]+" label:(.+)"))&&(c=f[1]),0===t[d].indexOf("a=ssrc:"+i[0])){t.splice(d,1),d--;continue}if(0===t[d].indexOf("a=ssrc:"+r[0])){t.splice(d,1),d--;continue}}0!=t[d].length||(t.splice(d,1),d--)}}}if(r[0]<0){l=-1,n=!1;for(d=0;d<t.length;d++){var p;if(p=t[d].match(/m=(\w+) */)){if("video"===p[1]){if(!(r[0]<0)){l=d;break}n=!0}else if(r[0]>-1){l=d;break}}else if(n){if(r[0]<0){var h=t[d].match(/a=ssrc:(\d+)/);if(h){r[0]=h[1],t.splice(d,1),d--;continue}}else{var f;if((f=t[d].match("a=ssrc:"+r[0]+" cname:(.+)"))&&(o=f[1]),(f=t[d].match("a=ssrc:"+r[0]+" msid:(.+)"))&&(a=f[1]),(f=t[d].match("a=ssrc:"+r[0]+" mslabel:(.+)"))&&(s=f[1]),(f=t[d].match("a=ssrc:"+r[0]+" label:(.+)"))&&(c=f[1]),0===t[d].indexOf("a=ssrc:"+i[0])){t.splice(d,1),d--;continue}if(0===t[d].indexOf("a=ssrc:"+r[0])){t.splice(d,1),d--;continue}}0!=t[d].length||(t.splice(d,1),d--)}}}if(r[0]<0)return Janus.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;l<0&&(l=t.length),r[1]=Math.floor(4294967295*Math.random()),r[2]=Math.floor(4294967295*Math.random()),i[1]=Math.floor(4294967295*Math.random()),i[2]=Math.floor(4294967295*Math.random());for(d=0;d<r.length;d++)o&&(t.splice(l,0,"a=ssrc:"+r[d]+" cname:"+o),l++),a&&(t.splice(l,0,"a=ssrc:"+r[d]+" msid:"+a),l++),s&&(t.splice(l,0,"a=ssrc:"+r[d]+" mslabel:"+s),l++),c&&(t.splice(l,0,"a=ssrc:"+r[d]+" label:"+c),l++),o&&(t.splice(l,0,"a=ssrc:"+i[d]+" cname:"+o),l++),a&&(t.splice(l,0,"a=ssrc:"+i[d]+" msid:"+a),l++),s&&(t.splice(l,0,"a=ssrc:"+i[d]+" mslabel:"+s),l++),c&&(t.splice(l,0,"a=ssrc:"+i[d]+" label:"+c),l++);return t.splice(l,0,"a=ssrc-group:FID "+r[2]+" "+i[2]),t.splice(l,0,"a=ssrc-group:FID "+r[1]+" "+i[1]),t.splice(l,0,"a=ssrc-group:FID "+r[0]+" "+i[0]),t.splice(l,0,"a=ssrc-group:SIM "+r[0]+" "+r[1]+" "+r[2]),(e=t.join("\r\n")).endsWith("\r\n")||(e+="\r\n"),e},JingleSession.prototype.getStats=function(e){var t=this,n={audio:0,video:0},r={audio:0,video:0},i={audio:0,video:0},o={audio:0,video:0},a={audio:0,video:0},s={audio:0,video:0},c=e/1e3,l=!0,d=0,u=0,p=0,h=0,f=0,m=0,g=0,v=0,S=0,y=0,b="",_={bitrate:{}},w="",T="";return this.statsinterval&&(window.clearInterval(this.statsinterval),this.statsinterval=null),this.ice_config.debugWeRTC&&(e=1e3),this.statsinterval=window.setInterval(function(){t&&t.peerconnection?navigator.mozGetUserMedia?t.peerconnection.getStats().then(function(e){var n=[];e.forEach(function(e){n.push(e)}),function(e){$(document).trigger("statsFirefox.jingle",[t.sid,e]);for(var n,r,i=new Object,o=0,a=0,d=[],u=0;u<e.length;++u){if("audio"==e[u].mediaType&&e[u].bytesReceived){s.audio||(s.audio=e[u].bytesReceived);var p=e[u].bytesReceived-s.audio;s.audio=e[u].bytesReceived,o=8*p/(1024*c),i.audioReceived={bytesReceived:s.audio,packetsLost:e[u].packetsLost,packetsReceived:e[u].packetsReceived}}else"audio"==e[u].mediaType&&e[u].bytesSent?i.audioSent={bytesSent:e[u].bytesSent,packetsSent:e[u].packetsSent}:"video"==e[u].mediaType&&e[u].bytesReceived?(s.video||(s.video=e[u].bytesReceived),p=e[u].bytesReceived-s.video,s.video=e[u].bytesReceived,a=p?8*p/(1024*c):0,i.videoReceived={bytesReceived:s.video,packetsLost:e[u].packetsLost,packetsReceived:e[u].packetsReceived}):"video"==e[u].mediaType&&e[u].bytesSent&&(i.videoSent={bytesSent:e[u].bytesSent,packetsSent:e[u].packetsSent});"candidate-pair"===e[u].type&&"succeeded"===e[u].state&&!0===e[u].selected&&(n=e[u].localCandidateId,r=e[u].remoteCandidateId),l&&"localcandidate"===e[u].type&&e[u].id===n&&(i.connectionType||(i.connectionType={}),i.connectionType.local={candidateType:e[u].candidateType,ipAddress:e[u].ipAddress+":"+e[u].portNumber,transport:e[u].transport}),l&&"remotecandidate"===e[u].type&&e[u].id===r&&(i.connectionType||(i.connectionType={}),i.connectionType.remote={candidateType:e[u].candidateType,ipAddress:e[u].ipAddress+":"+e[u].portNumber}),("candidate-pair"!==e[u].type||e[u].selected)&&("local-candidate"===e[u].type&&e[u].id!==n||"remote-candidate"===e[u].type&&e[u].id!==r||d.push(e[u]));var h=e[u],f=!1;if(("video"===h.mediaType||h.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===h.type&&h.id.indexOf("rtcp")<0?f=!0:"ssrc"!=h.type||!h.bytesReceived||"VP8"!==h.googCodecName&&""!==h.googCodecName||(f=!0),f)if(_.bitrate.bsnow=h.bytesReceived,_.bitrate.tsnow=h.timestamp,void 0===_.bitrate.bsbefore||void 0===_.bitrate.tsbefore)_.bitrate.bsbefore=_.bitrate.bsnow,_.bitrate.tsbefore=_.bitrate.tsnow;else{var m=_.bitrate.tsnow-_.bitrate.tsbefore;"safari"==adapter.default.browserDetails.browser&&(m/=1e3);var g=Math.round(8*(_.bitrate.bsnow-_.bitrate.bsbefore)/m);"safari"===adapter.default.browserDetails.browser&&(g=parseInt(g/1e3)),_.bitrate.value=g+" kbits/sec",_.bitrate.bsbefore=_.bitrate.bsnow,_.bitrate.tsbefore=_.bitrate.tsnow,$(document).trigger("webrtcSessionBitRate.jingle",[t.sid,_.bitrate])}}i.availableIncomingAudioBandwidth=o,i.availableIncomingVideoBandwidth=a,i.connectionType&&(l=!1,$(document).trigger("webrtcConnectionType.jingle",[t.sid,i.connectionType])),$(document).trigger("webrtcFirefoxStats.jingle",[t.sid,i])}(n)}):t.peerconnection.getStats?t.peerconnection.getStats(function(e){var C=[];e.result().forEach(function(e){var t={};e.names().forEach(function(n){t[n]=e.stat(n)}),t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,C.push(t)}),function(e){$(document).trigger("statsChrome.jingle",[t.sid,e]);for(var C,x,R=0,k=0,P=0,j=0,E=0,D=0,O=new Object,A=[],M=0,I=0,L=0,N=0,B=0,F=0,U=0,H=0,q=0,z=0,J=0,V=0,G=!1,W=!1,X=!1,K=!1,Q=e.length-1;Q>=0;Q--){if("ssrc"==e[Q].type)if(-1!==e[Q].id.indexOf("send"))if("opus"!==e[Q].googCodecName&&"PCMA"!==e[Q].googCodecName&&"PCMU"!==e[Q].googCodecName||G)"VP8"!=e[Q].googCodecName||W||(W=!0,k=e[Q].packetsSent,e[Q].packetsLost,e[Q].googFrameRateSent&&e[Q].googFrameRateSent,a.video||(a.video=e[Q].bytesSent),e[Q].googRtt&&!L&&(L=parseInt(e[Q].googRtt,10)),e[Q].bytesSent-a.video,a.video=e[Q].bytesSent);else{G=!0,R=e[Q].packetsSent,e[Q].packetsLost,M=e[Q].audioInputLevel,e[Q].googRtt&&!L&&(L=parseInt(e[Q].googRtt,10)),a.audio||(a.audio=e[Q].bytesSent);e[Q].bytesSent,a.audio;a.audio=e[Q].bytesSent}else if("opus"!==e[Q].googCodecName&&"PCMA"!==e[Q].googCodecName||X)"VP8"!=e[Q].googCodecName||K||(K=!0,j=e[Q].packetsReceived,D+=e[Q].packetsLost,e[Q].googFrameRateReceived&&e[Q].googFrameRateReceived,o.video=r.video,i.video=n.video,n.video=parseInt(j,10),r.video=parseInt(D,10),s.video||(s.video=e[Q].bytesReceived),e[Q].bytesReceived-s.video,s.video=e[Q].bytesReceived);else{X=!0,P=e[Q].packetsReceived,E+=e[Q].packetsLost,I=e[Q].audioOutputLevel,o.audio=r.audio,i.audio=n.audio,n.audio=parseInt(P,10),r.audio=parseInt(E,10),N=parseInt(e[Q].googJitterBufferMs,10),B=parseInt(e[Q].googJitterReceived,10),F=parseInt(e[Q].packetsReceived,10)-u,u=parseInt(e[Q].packetsReceived,10),F<0&&(F=0),U=parseInt(e[Q].packetsLost,10)-d,d=parseInt(e[Q].packetsLost,10),U<0&&(U=0),V=U/(50*c)*100,J=e[Q].googCurrentDelayMs,s.audio||(s.audio=e[Q].bytesReceived);e[Q].bytesReceived,s.audio;s.audio=e[Q].bytesReceived}"googCandidatePair"==e[Q].type&&"true"===e[Q].googWritable&&l&&(O.localCandidateType=e[Q].googLocalCandidateType,O.localAddress=e[Q].googLocalAddress,O.localTransportType=e[Q].googTransportType,O.remoteCandidateType=e[Q].googRemoteCandidateType,O.remoteAddress=e[Q].googRemoteAddress,T=e[Q].googLocalAddress.split(":")[0],e[Q].googRemoteAddress.split(":")[0],b=O.localAddress+" [ "+O.localCandidateType+" ] <-> "+O.remoteAddress+" [ "+O.remoteCandidateType+" ] || "+O.localTransportType),"localcandidate"===e[Q].type&&e[Q].ipAddress===T&&(O.networkType=e[Q].networkType,w=O.networkType),"googCandidatePair"===e[Q].type&&"0"===e[Q].requestsReceived||"remotecandidate"===e[Q].type||"localcandidate"===e[Q].type||"googCertificate"===e[Q].type||"googComponent"===e[Q].type||"googTrack"===e[Q].type||"googLibjingleSession"===e[Q].type||"VideoBwe"===e[Q].type||A.push(e[Q]);var Y=e[Q],Z=!1;if(("video"===Y.mediaType||Y.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===Y.type&&Y.id.indexOf("rtcp")<0?Z=!0:"ssrc"!=Y.type||!Y.bytesReceived||"VP8"!==Y.googCodecName&&""!==Y.googCodecName||(Z=!0),Z)if(_.bitrate.bsnow=Y.bytesReceived,_.bitrate.tsnow=Y.timestamp,void 0===_.bitrate.bsbefore||void 0===_.bitrate.tsbefore)_.bitrate.bsbefore=_.bitrate.bsnow,_.bitrate.tsbefore=_.bitrate.tsnow;else{var ee=_.bitrate.tsnow-_.bitrate.tsbefore;"safari"==adapter.default.browserDetails.browser&&(ee/=1e3);var te=Math.round(8*(_.bitrate.bsnow-_.bitrate.bsbefore)/ee);"safari"===adapter.default.browserDetails.browser&&(te=parseInt(te/1e3)),_.bitrate.value=te+" kbits/sec",_.bitrate.bsbefore=_.bitrate.bsnow,_.bitrate.tsbefore=_.bitrate.tsnow,$(document).trigger("webrtcSessionBitRate.jingle",[t.sid,_.bitrate])}}F&&(q=.18*(H=93.2-V)*H-27.9*H+1126.62),z=(x=q-(.024*(C=J)+.11*(C-177.3)*(C-177.3<0?0:1)))<0||V>20?1:x>100?4.5:1+.035*x+x*(x-60)*(100-x)*7*1e-6;var ne=0;x>=80?ne=2:x<80&&x>=60&&(ne=1),O.googRTTAudio=L,O.googJitterBufferMsAudio=N,O.googJitterReceived=B,O.mosPacketsReceivedAudio=F,O.mosPacketsLostAudio=U,O.MOS=z,O.candidatePair=b,z&&(p+=1,h+=z,f+=L,m+=B,g+=N,O.iteration=p,O.currentDelay=C,O.MOS=z,O.networkQualityFlag=ne,O.meanMOS=h/p,v=v<L?L:v,S=S<B?B:S,y=y<N?N:y),O.packetsAudioSent=parseInt(R,10),O.packetsAudioReceived=parseInt(P,10),O.audioInputLevel=parseInt(M,10),O.audioOutputLevel=parseInt(I,10),O.packetsVideoSent=parseInt(k,10),O.packetsVideoReceived=parseInt(j,10),O.bytesSent=a,O.bytesReceived=s,O.localCandidateType&&(l=!1,$(document).trigger("webrtcConnectionType.jingle",[t.sid,O])),A.RainMetrics={type:"mscore",meanRTT:f/p,maxRTT:v,meanJitter:m/p,maxJitter:S,meanJitterDepth:g/p,maxJitterDepth:y,candidatePair:O.candidatePair,networkType:w,meanMOS:O.meanMOS},$(document).trigger("webrtcSessionStats.jingle",[t.sid,A]),$(document).trigger("webrtcSessionStatsSimplyfied.jingle",[t.sid,O]),O&&Strophe.log("","[Strophe.jingle] webrtcChromeStats audio packets received : "+O.packetsAudioReceived+" / audio packets sent : "+O.packetsAudioSent+" / for session "+t.sid)}(C)}):Strophe.log("","[Strophe.jingle] getStats does not exist..."):Strophe.log("","[Strophe.jingle] getStats no peerconnection")},e||1e3),this.statsinterval},function(){"use strict";Strophe.addConnectionPlugin("mam",{_c:null,_p:["with","start","end"],init:function(e){this._c=e,Strophe.addNamespace("MAM","urn:xmpp:mam:1")},query:function(e,t){var n=this._p,r={type:"set",id:e},i={xmlns:Strophe.NS.MAM};t.queryid&&(i.queryid=t.queryid,delete t.queryid);var o,a=$iq(r).c("query",i).c("x",{xmlns:"jabber:x:data",type:"submit"});for(a.c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t("urn:xmpp:mam:1").up().up(),o=0;o<this._p.length;o++){var s=n[o],c=t[s];delete t[s],c&&a.c("field",{var:s}).c("value").t(c).up().up()}a.up(),delete t.onMessage;var l=t.onComplete;return delete t.onComplete,a.cnode(new Strophe.RSM(t).toXML()),this._c.sendIQ(a,l)},querymuc:function(e,t,n){var r=this._p,i={to:t,type:"set",id:e},o={xmlns:Strophe.NS.MAM};n.queryid&&(o.queryid=n.queryid,delete n.queryid);var a,s=$iq(i).c("query",o).c("x",{xmlns:"jabber:x:data",type:"submit"});for(s.c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t(Strophe.NS.MAM).up().up(),a=0;a<this._p.length;a++){var c=r[a],l=n[c];delete n[c],l&&s.c("field",{var:c}).c("value").t(l).up().up()}s.up();var d=n.onComplete;return delete n.onComplete,s.cnode(new Strophe.RSM(n).toXML()),this._c.sendIQ(s,d)},delete:function(e,t){var n=this._p,r={type:"set",id:e},i={xmlns:Strophe.NS.MAM};t.queryid&&(i.queryid=t.queryid,delete t.queryid);var o,a=$iq(r).c("delete",i).c("x",{xmlns:"jabber:x:data",type:"submit"});for(a.c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t(Strophe.NS.MAM).up().up(),o=0;o<this._p.length;o++){var s=n[o],c=t[s];c&&a.c("field",{var:s}).c("value").t(c).up().up()}a.up(),delete t.onMessage;var l=t.onComplete;return delete t.onComplete,a.cnode(new Strophe.RSM(t).toXML()),this._c.sendIQ(a,l)}})}(),function(){"use strict";function e(){}function t(e,t){var n=!1;return $('si feature x field[var="stream-method"] value',e).each(function(e,r){$(r).text()===t&&(n=!0)}),n}Strophe.addConnectionPlugin("si_filetransfer",{_c:null,_cb:null,init:function(e){this._c=e,Strophe.addNamespace("SI","http://jabber.org/protocol/si"),Strophe.addNamespace("SI_FILE_TRANSFER",Strophe.NS.SI+"/profile/file-transfer"),Strophe.addNamespace("FEATURE_NEG","http://jabber.org/protocol/feature-neg"),e.addHandler(this._receive.bind(this),Strophe.NS.SI,"iq","set")},_receive:function(e){var n=$(e),r=n.attr("from"),i=n.attr("id"),o=$("si",n).attr("id");if(Object.hasOwnProperty.call(this._c,"ibb")&&t(e,Strophe.NS.IBB))var a=$("file",n);var s=a.attr("name"),c=a.attr("size"),l=$("si",n).attr("mime-type"),d=$("desc",n).text();return"function"==typeof this._cb&&this._cb(r,o,s,c,l,i,d),!0},_success:function(e,n){var r;t(n,Strophe.NS.IBB)||(r=new Error("In-Band Bytestream not supported")),e(r)},_fail:function(e,t){var n="timed out";t&&(n=t),e(new Error(n))},_send:function(e,t,n){this._c.sendIQ(e,t,n,18e4)},send:function(e,t,n,r,i,o,a){if(Object.hasOwnProperty.call(this._c,"ibb")){var s=$iq({type:"set",to:e,id:this._c.getUniqueId("si-filetransfer")}).c("si",{xmlns:Strophe.NS.SI,id:t,profile:Strophe.NS.SI_FILE_TRANSFER,"mime-type":i}).c("file",{xmlns:Strophe.NS.SI_FILE_TRANSFER,name:n,size:r}).c("desc").t(o).up().c("feature",{xmlns:Strophe.NS.FEATURE_NEG}).c("x",{xmlns:"jabber:x:data",type:"form"}).c("field",{var:"stream-method",type:"list-single"}).c("option").c("value").t(Strophe.NS.IBB);this._send(s,this._success.bind(this,a),this._fail.bind(this,a))}else Strophe.warn("The In-Band Bytestream plugin is required.")},responseOk:function(t,n,r){var i=$iq({type:"result",to:t,id:r}).c("si",{xmlns:Strophe.NS.SI,id:n}).c("file",{xmlns:Strophe.NS.SI_FILE_TRANSFER}).up().c("feature",{xmlns:Strophe.NS.FEATURE_NEG}).c("x",{xmlns:"jabber:x:data",type:"submit"}).c("field",{var:"stream-method"});i.c("value").t(Strophe.NS.IBB),this._send(i,e,e)},responseError:function(t,n,r,i){var o=$iq({type:"error",to:t,id:r}).c("error",{code:i,type:"cancel"}).c("forbidden",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("text",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"});o.c("value").t(Strophe.NS.IBB),this._send(o,e,e)},addFileHandler:function(e){this._cb=e}})}(),function(){"use strict";Strophe.addConnectionPlugin("calllog",{_c:null,_p:["with"],init:function(e){this._c=e,Strophe.addNamespace("CALLLOG","jabber:iq:telephony:call:log")},query:function(e,t){var n,r=this._p,i={type:"set",id:130,from:e},o={xmlns:Strophe.NS.CALLLOG},a=$iq(i).c("query",o).c("x",{xmlns:"jabber:x:data",type:"submit"});for(a.c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t("jabber:iq:telephony:call:log").up().up(),n=0;n<this._p.length;n++){var s=r[n],c=t[s];delete t[s],c&&a.c("field",{var:s}).c("value").t(c).up().up()}a.up();t.onMessage;delete t.onMessage;var l=t.onComplete;return delete t.onComplete,a.cnode(new Strophe.RSM(t).toXML()),this._c.sendIQ(a,l)}})}(),function(e,t){"object"==typeof exports?module.exports=exports=t():"function"==typeof define&&define.amd?define([],t):e.CryptoJS=t()}(this,function(){var e,t,n,r,i,o,a,s,c,l,d=d||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},i=r.lib={},o=i.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var a=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=a<<24-(r+o)%4*8}else for(o=0;o<i;o+=4)t[r+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],i=function(t){t=t;var n=987654321,r=4294967295;return function(){var i=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}},o=0;o<t;o+=4){var s=i(4294967296*(n||e.random()));n=987654071*s(),r.push(4294967296*s()|0)}return new a.init(r,t)}}),s=r.enc={},c=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},l=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},d=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},u=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,s=i/(4*o),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*o,l=e.min(4*c,i);if(c){for(var d=0;d<c;d+=o)this._doProcessBlock(r,d);var u=r.splice(0,c);n.sigBytes-=l}return new a.init(u,l)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(i.Hasher=u.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}}),r.algo={});return r}(Math);return function(){var e=d,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var i=[],o=0;o<n;o+=3)for(var a=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;s<4&&o+.75*s<n;s++)i.push(r.charAt(a>>>6*(3-s)&63));var c=r.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(e){var n=e.length,r=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var o=0;o<r.length;o++)i[r.charCodeAt(o)]=o}var a=r.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(n=s)}return function(e,n,r){for(var i=[],o=0,a=0;a<n;a++)if(a%4){var s=r[e.charCodeAt(a-1)]<<a%4*2,c=r[e.charCodeAt(a)]>>>6-a%4*2;i[o>>>2]|=(s|c)<<24-o%4*8,o++}return t.create(i,o)}(e,n,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){var t=d,n=t.lib,r=n.WordArray,i=n.Hasher,o=t.algo,a=[];!function(){for(var t=0;t<64;t++)a[t]=4294967296*e.abs(e.sin(t+1))|0}();var s=o.MD5=i.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o=this._hash.words,s=e[t+0],d=e[t+1],h=e[t+2],f=e[t+3],m=e[t+4],g=e[t+5],v=e[t+6],S=e[t+7],y=e[t+8],b=e[t+9],_=e[t+10],w=e[t+11],T=e[t+12],C=e[t+13],x=e[t+14],R=e[t+15],k=o[0],P=o[1],j=o[2],E=o[3];k=c(k,P,j,E,s,7,a[0]),E=c(E,k,P,j,d,12,a[1]),j=c(j,E,k,P,h,17,a[2]),P=c(P,j,E,k,f,22,a[3]),k=c(k,P,j,E,m,7,a[4]),E=c(E,k,P,j,g,12,a[5]),j=c(j,E,k,P,v,17,a[6]),P=c(P,j,E,k,S,22,a[7]),k=c(k,P,j,E,y,7,a[8]),E=c(E,k,P,j,b,12,a[9]),j=c(j,E,k,P,_,17,a[10]),P=c(P,j,E,k,w,22,a[11]),k=c(k,P,j,E,T,7,a[12]),E=c(E,k,P,j,C,12,a[13]),j=c(j,E,k,P,x,17,a[14]),k=l(k,P=c(P,j,E,k,R,22,a[15]),j,E,d,5,a[16]),E=l(E,k,P,j,v,9,a[17]),j=l(j,E,k,P,w,14,a[18]),P=l(P,j,E,k,s,20,a[19]),k=l(k,P,j,E,g,5,a[20]),E=l(E,k,P,j,_,9,a[21]),j=l(j,E,k,P,R,14,a[22]),P=l(P,j,E,k,m,20,a[23]),k=l(k,P,j,E,b,5,a[24]),E=l(E,k,P,j,x,9,a[25]),j=l(j,E,k,P,f,14,a[26]),P=l(P,j,E,k,y,20,a[27]),k=l(k,P,j,E,C,5,a[28]),E=l(E,k,P,j,h,9,a[29]),j=l(j,E,k,P,S,14,a[30]),k=u(k,P=l(P,j,E,k,T,20,a[31]),j,E,g,4,a[32]),E=u(E,k,P,j,y,11,a[33]),j=u(j,E,k,P,w,16,a[34]),P=u(P,j,E,k,x,23,a[35]),k=u(k,P,j,E,d,4,a[36]),E=u(E,k,P,j,m,11,a[37]),j=u(j,E,k,P,S,16,a[38]),P=u(P,j,E,k,_,23,a[39]),k=u(k,P,j,E,C,4,a[40]),E=u(E,k,P,j,s,11,a[41]),j=u(j,E,k,P,f,16,a[42]),P=u(P,j,E,k,v,23,a[43]),k=u(k,P,j,E,b,4,a[44]),E=u(E,k,P,j,T,11,a[45]),j=u(j,E,k,P,R,16,a[46]),k=p(k,P=u(P,j,E,k,h,23,a[47]),j,E,s,6,a[48]),E=p(E,k,P,j,S,10,a[49]),j=p(j,E,k,P,x,15,a[50]),P=p(P,j,E,k,g,21,a[51]),k=p(k,P,j,E,T,6,a[52]),E=p(E,k,P,j,f,10,a[53]),j=p(j,E,k,P,_,15,a[54]),P=p(P,j,E,k,d,21,a[55]),k=p(k,P,j,E,y,6,a[56]),E=p(E,k,P,j,R,10,a[57]),j=p(j,E,k,P,v,15,a[58]),P=p(P,j,E,k,C,21,a[59]),k=p(k,P,j,E,m,6,a[60]),E=p(E,k,P,j,w,10,a[61]),j=p(j,E,k,P,h,15,a[62]),P=p(P,j,E,k,b,21,a[63]),o[0]=o[0]+k|0,o[1]=o[1]+P|0,o[2]=o[2]+j|0,o[3]=o[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var o=e.floor(r/4294967296),a=r;n[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[14+(i+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,c=s.words,l=0;l<4;l++){var d=c[l];c[l]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,r,i,o,a){var s=e+(t&n|~t&r)+i+a;return(s<<o|s>>>32-o)+t}function l(e,t,n,r,i,o,a){var s=e+(t&r|n&~r)+i+a;return(s<<o|s>>>32-o)+t}function u(e,t,n,r,i,o,a){var s=e+(t^n^r)+i+a;return(s<<o|s>>>32-o)+t}function p(e,t,n,r,i,o,a){var s=e+(n^(t|~r))+i+a;return(s<<o|s>>>32-o)+t}t.MD5=i._createHelper(s),t.HmacMD5=i._createHmacHelper(s)}(Math),t=(e=d).lib,n=t.WordArray,r=t.Hasher,i=e.algo,o=[],a=i.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],a=n[2],s=n[3],c=n[4],l=0;l<80;l++){if(l<16)o[l]=0|e[t+l];else{var d=o[l-3]^o[l-8]^o[l-14]^o[l-16];o[l]=d<<1|d>>>31}var u=(r<<5|r>>>27)+c+o[l];u+=l<20?1518500249+(i&a|~i&s):l<40?1859775393+(i^a^s):l<60?(i&a|i&s|a&s)-1894007588:(i^a^s)-899497514,c=s,s=a,a=i<<30|i>>>2,i=r,r=u}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}}),e.SHA1=r._createHelper(a),e.HmacSHA1=r._createHmacHelper(a),function(e){var t=d,n=t.lib,r=n.WordArray,i=n.Hasher,o=t.algo,a=[],s=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)t(r)&&(i<8&&(a[i]=n(e.pow(r,.5))),s[i]=n(e.pow(r,1/3)),i++),r++}();var c=[],l=o.SHA256=i.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],l=n[4],d=n[5],u=n[6],p=n[7],h=0;h<64;h++){if(h<16)c[h]=0|e[t+h];else{var f=c[h-15],m=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,g=c[h-2],v=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;c[h]=m+c[h-7]+v+c[h-16]}var S=r&i^r&o^i&o,y=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),b=p+((l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25))+(l&d^~l&u)+s[h]+c[h];p=u,u=d,d=l,l=a+b|0,a=o,o=i,i=r,r=b+(y+S)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+l|0,n[5]=n[5]+d|0,n[6]=n[6]+u|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(l),t.HmacSHA256=i._createHmacHelper(l)}(Math),function(){var e=d,t=e.lib.WordArray,n=e.enc;n.Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i+=2){var o=t[i>>>2]>>>16-i%4*8&65535;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var n=e.length,r=[],i=0;i<n;i++)r[i>>>1]|=e.charCodeAt(i)<<16-i%2*16;return t.create(r,2*n)}};function r(e){return e<<8&4278255360|e>>>8&16711935}n.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o+=2){var a=r(t[o>>>2]>>>16-o%4*8&65535);i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var n=e.length,i=[],o=0;o<n;o++)i[o>>>1]|=r(e.charCodeAt(o)<<16-o%2*16);return t.create(i,2*n)}}}(),function(){if("function"==typeof ArrayBuffer){var e=d.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,r=[],i=0;i<n;i++)r[i>>>2]|=e[i]<<24-i%4*8;t.call(this,r,n)}else t.apply(this,arguments)}).prototype=e}}(),function(e){var t=d,n=t.lib,r=n.WordArray,i=n.Hasher,o=t.algo,a=r.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=r.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=r.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=r.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=r.create([0,1518500249,1859775393,2400959708,2840853838]),p=r.create([1352829926,1548603684,1836072691,2053994217,0]),h=o.RIPEMD160=i.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o,d,h,b,_,w,T,C,x,R,k,P=this._hash.words,j=u.words,E=p.words,D=a.words,O=s.words,A=c.words,M=l.words;w=o=P[0],T=d=P[1],C=h=P[2],x=b=P[3],R=_=P[4];for(n=0;n<80;n+=1)k=o+e[t+D[n]]|0,k+=n<16?f(d,h,b)+j[0]:n<32?m(d,h,b)+j[1]:n<48?g(d,h,b)+j[2]:n<64?v(d,h,b)+j[3]:S(d,h,b)+j[4],k=(k=y(k|=0,A[n]))+_|0,o=_,_=b,b=y(h,10),h=d,d=k,k=w+e[t+O[n]]|0,k+=n<16?S(T,C,x)+E[0]:n<32?v(T,C,x)+E[1]:n<48?g(T,C,x)+E[2]:n<64?m(T,C,x)+E[3]:f(T,C,x)+E[4],k=(k=y(k|=0,M[n]))+R|0,w=R,R=x,x=y(C,10),C=T,T=k;k=P[1]+h+x|0,P[1]=P[2]+b+R|0,P[2]=P[3]+_+w|0,P[3]=P[4]+o+T|0,P[4]=P[0]+d+C|0,P[0]=k},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var i=this._hash,o=i.words,a=0;a<5;a++){var s=o[a];o[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return i},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function f(e,t,n){return e^t^n}function m(e,t,n){return e&t|~e&n}function g(e,t,n){return(e|~t)^n}function v(e,t,n){return e&n|t&~n}function S(e,t,n){return e^(t|~n)}function y(e,t){return e<<t|e>>>32-t}t.RIPEMD160=i._createHelper(h),t.HmacRIPEMD160=i._createHmacHelper(h)}(Math),function(){var e=d,t=e.lib.Base,n=e.enc.Utf8;e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var r=e.blockSize,i=4*r;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),a=this._iKey=t.clone(),s=o.words,c=a.words,l=0;l<r;l++)s[l]^=1549556828,c[l]^=909522486;o.sigBytes=a.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})}(),function(){var e=d,t=e.lib,n=t.Base,r=t.WordArray,i=e.algo,o=i.SHA1,a=i.HMAC,s=i.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=a.create(n.hasher,e),o=r.create(),s=r.create([1]),c=o.words,l=s.words,d=n.keySize,u=n.iterations;c.length<d;){var p=i.update(t).finalize(s);i.reset();for(var h=p.words,f=h.length,m=p,g=1;g<u;g++){m=i.finalize(m),i.reset();for(var v=m.words,S=0;S<f;S++)h[S]^=v[S]}o.concat(p),l[0]++}return o.sigBytes=4*d,o}});e.PBKDF2=function(e,t,n){return s.create(n).compute(e,t)}}(),function(){var e=d,t=e.lib,n=t.Base,r=t.WordArray,i=e.algo,o=i.MD5,a=i.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=n.hasher.create(),o=r.create(),a=o.words,s=n.keySize,c=n.iterations;a.length<s;){l&&i.update(l);var l=i.update(e).finalize(t);i.reset();for(var d=1;d<c;d++)l=i.finalize(l),i.reset();o.concat(l)}return o.sigBytes=4*s,o}});e.EvpKDF=function(e,t,n){return a.create(n).compute(e,t)}}(),function(){var e=d,t=e.lib.WordArray,n=e.algo,r=n.SHA256,i=n.SHA224=r.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=r._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=r._createHelper(i),e.HmacSHA224=r._createHmacHelper(i)}(),function(e){var t=d,n=t.lib,r=n.Base,i=n.WordArray,o=t.x64={};o.Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),o.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var o=e[r];n.push(o.high),n.push(o.low)}return i.create(n,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),n=t.length,i=0;i<n;i++)t[i]=t[i].clone();return e}})}(),function(e){var t=d,n=t.lib,r=n.WordArray,i=n.Hasher,o=t.x64.Word,a=t.algo,s=[],c=[],l=[];!function(){for(var e=1,t=0,n=0;n<24;n++){s[e+5*t]=(n+1)*(n+2)/2%64;var r=(2*e+3*t)%5;e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var i=1,a=0;a<24;a++){for(var d=0,u=0,p=0;p<7;p++){if(1&i){var h=(1<<p)-1;h<32?u^=1<<h:d^=1<<h-32}128&i?i=i<<1^113:i<<=1}l[a]=o.create(d,u)}}();var u=[];!function(){for(var e=0;e<25;e++)u[e]=o.create()}();var p=a.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new o.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,i=0;i<r;i++){var o=e[t+2*i],a=e[t+2*i+1];o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(P=n[i]).high^=a,P.low^=o}for(var d=0;d<24;d++){for(var p=0;p<5;p++){for(var h=0,f=0,m=0;m<5;m++){h^=(P=n[p+5*m]).high,f^=P.low}var g=u[p];g.high=h,g.low=f}for(p=0;p<5;p++){var v=u[(p+4)%5],S=u[(p+1)%5],y=S.high,b=S.low;for(h=v.high^(y<<1|b>>>31),f=v.low^(b<<1|y>>>31),m=0;m<5;m++){(P=n[p+5*m]).high^=h,P.low^=f}}for(var _=1;_<25;_++){var w=(P=n[_]).high,T=P.low,C=s[_];if(C<32)h=w<<C|T>>>32-C,f=T<<C|w>>>32-C;else h=T<<C-32|w>>>64-C,f=w<<C-32|T>>>64-C;var x=u[c[_]];x.high=h,x.low=f}var R=u[0],k=n[0];R.high=k.high,R.low=k.low;for(p=0;p<5;p++)for(m=0;m<5;m++){var P=n[_=p+5*m],j=u[_],E=u[(p+1)%5+5*m],D=u[(p+2)%5+5*m];P.high=j.high^~E.high&D.high,P.low=j.low^~E.low&D.low}P=n[0];var O=l[d];P.high^=O.high,P.low^=O.low}},_doFinalize:function(){var t=this._data,n=t.words,i=(this._nDataBytes,8*t.sigBytes),o=32*this.blockSize;n[i>>>5]|=1<<24-i%32,n[(e.ceil((i+1)/o)*o>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,c=s/8,l=[],d=0;d<c;d++){var u=a[d],p=u.high,h=u.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),l.push(h),l.push(p)}return new r.init(l,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=i._createHelper(p),t.HmacSHA3=i._createHmacHelper(p)}(Math),function(){var e=d,t=e.lib.Hasher,n=e.x64,r=n.Word,i=n.WordArray,o=e.algo;function a(){return r.create.apply(r,arguments)}var s=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=a()}();var l=o.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],l=n[4],d=n[5],u=n[6],p=n[7],h=r.high,f=r.low,m=i.high,g=i.low,v=o.high,S=o.low,y=a.high,b=a.low,_=l.high,w=l.low,T=d.high,C=d.low,x=u.high,R=u.low,k=p.high,P=p.low,j=h,E=f,D=m,O=g,A=v,M=S,I=y,L=b,N=_,$=w,B=T,F=C,U=x,H=R,q=k,z=P,J=0;J<80;J++){var V=c[J];if(J<16)var G=V.high=0|e[t+2*J],W=V.low=0|e[t+2*J+1];else{var X=c[J-15],K=X.high,Q=X.low,Y=(K>>>1|Q<<31)^(K>>>8|Q<<24)^K>>>7,Z=(Q>>>1|K<<31)^(Q>>>8|K<<24)^(Q>>>7|K<<25),ee=c[J-2],te=ee.high,ne=ee.low,re=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,ie=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),oe=c[J-7],ae=oe.high,se=oe.low,ce=c[J-16],le=ce.high,de=ce.low;G=(G=(G=Y+ae+((W=Z+se)>>>0<Z>>>0?1:0))+re+((W=W+ie)>>>0<ie>>>0?1:0))+le+((W=W+de)>>>0<de>>>0?1:0);V.high=G,V.low=W}var ue,pe=N&B^~N&U,he=$&F^~$&H,fe=j&D^j&A^D&A,me=E&O^E&M^O&M,ge=(j>>>28|E<<4)^(j<<30|E>>>2)^(j<<25|E>>>7),ve=(E>>>28|j<<4)^(E<<30|j>>>2)^(E<<25|j>>>7),Se=(N>>>14|$<<18)^(N>>>18|$<<14)^(N<<23|$>>>9),ye=($>>>14|N<<18)^($>>>18|N<<14)^($<<23|N>>>9),be=s[J],_e=be.high,we=be.low,Te=q+Se+((ue=z+ye)>>>0<z>>>0?1:0),Ce=ve+me;q=U,z=H,U=B,H=F,B=N,F=$,N=I+(Te=(Te=(Te=Te+pe+((ue=ue+he)>>>0<he>>>0?1:0))+_e+((ue=ue+we)>>>0<we>>>0?1:0))+G+((ue=ue+W)>>>0<W>>>0?1:0))+(($=L+ue|0)>>>0<L>>>0?1:0)|0,I=A,L=M,A=D,M=O,D=j,O=E,j=Te+(ge+fe+(Ce>>>0<ve>>>0?1:0))+((E=ue+Ce|0)>>>0<ue>>>0?1:0)|0}f=r.low=f+E,r.high=h+j+(f>>>0<E>>>0?1:0),g=i.low=g+O,i.high=m+D+(g>>>0<O>>>0?1:0),S=o.low=S+M,o.high=v+A+(S>>>0<M>>>0?1:0),b=a.low=b+L,a.high=y+I+(b>>>0<L>>>0?1:0),w=l.low=w+$,l.high=_+N+(w>>>0<$>>>0?1:0),C=d.low=C+F,d.high=T+B+(C>>>0<F>>>0?1:0),R=u.low=R+H,u.high=x+U+(R>>>0<H>>>0?1:0),P=p.low=P+z,p.high=k+q+(P>>>0<z>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(l),e.HmacSHA512=t._createHmacHelper(l)}(),function(){var e=d,t=e.x64,n=t.Word,r=t.WordArray,i=e.algo,o=i.SHA512,a=i.SHA384=o.extend({_doReset:function(){this._hash=new r.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var e=o._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=o._createHelper(a),e.HmacSHA384=o._createHmacHelper(a)}(),d.lib.Cipher||function(e){var t=d,n=t.lib,r=n.Base,i=n.WordArray,o=n.BufferedBlockAlgorithm,a=t.enc,s=(a.Utf8,a.Base64),c=t.algo.EvpKDF,l=n.Cipher=o.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?y:v}return function(t){return{encrypt:function(n,r,i){return e(r).encrypt(t,n,r,i)},decrypt:function(n,r,i){return e(r).decrypt(t,n,r,i)}}}}()}),u=(n.StreamCipher=l.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),t.mode={}),p=n.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),h=u.CBC=function(){var t=p.extend();function n(t,n,r){var i=this._iv;if(i){var o=i;this._iv=e}else o=this._prevBlock;for(var a=0;a<r;a++)t[n+a]^=o[a]}return t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize;n.call(this,e,t,i),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}),t.Decryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,o=e.slice(t,t+i);r.decryptBlock(e,t),n.call(this,e,t,i),this._prevBlock=o}}),t}(),f=(t.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,o=r<<24|r<<16|r<<8|r,a=[],s=0;s<r;s+=4)a.push(o);var c=i.create(a,r);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},m=(n.BlockCipher=l.extend({cfg:l.cfg.extend({mode:h,padding:f}),reset:function(){l.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=n.createEncryptor;else{r=n.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==r?this._mode.init(this,t&&t.words):(this._mode=r.call(n,this,t&&t.words),this._mode.__creator=r)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{t=this._process(!0);e.unpad(t)}return t},blockSize:4}),n.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),g=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var r=i.create([1398893684,1701076831]).concat(n).concat(t);else r=t;return r.toString(s)},parse:function(e){var t=s.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var r=i.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return m.create({ciphertext:t,salt:r})}},v=n.SerializableCipher=r.extend({cfg:r.extend({format:g}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r),o=i.finalize(t),a=i.cfg;return m.create({ciphertext:o,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),S=(t.kdf={}).OpenSSL={execute:function(e,t,n,r){r||(r=i.random(8));var o=c.create({keySize:t+n}).compute(e,r),a=i.create(o.words.slice(t),4*n);return o.sigBytes=4*t,m.create({key:o,iv:a,salt:r})}},y=n.PasswordBasedCipher=v.extend({cfg:v.cfg.extend({kdf:S}),encrypt:function(e,t,n,r){var i=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=i.iv;var o=v.encrypt.call(this,e,t,i.key,r);return o.mixIn(i),o},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var i=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);return r.iv=i.iv,v.decrypt.call(this,e,t,i.key,r)}})}(),d.mode.CFB=function(){var e=d.lib.BlockCipherMode.extend();function t(e,t,n,r){var i=this._iv;if(i){var o=i.slice(0);this._iv=void 0}else o=this._prevBlock;r.encryptBlock(o,0);for(var a=0;a<n;a++)e[t+a]^=o[a]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize;t.call(this,e,n,i,r),this._prevBlock=e.slice(n,n+i)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize,o=e.slice(n,n+i);t.call(this,e,n,i,r),this._prevBlock=o}}),e}(),d.mode.ECB=((s=d.lib.BlockCipherMode.extend()).Encryptor=s.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),s.Decryptor=s.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),s),d.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=4*t,i=r-n%r,o=n+i-1;e.clamp(),e.words[o>>>2]|=i<<24-o%4*8,e.sigBytes+=i},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},d.pad.Iso10126={pad:function(e,t){var n=4*t,r=n-e.sigBytes%n;e.concat(d.lib.WordArray.random(r-1)).concat(d.lib.WordArray.create([r<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},d.pad.Iso97971={pad:function(e,t){e.concat(d.lib.WordArray.create([2147483648],1)),d.pad.ZeroPadding.pad(e,t)},unpad:function(e){d.pad.ZeroPadding.unpad(e),e.sigBytes--}},d.mode.OFB=(c=d.lib.BlockCipherMode.extend(),l=c.Encryptor=c.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,o=this._keystream;i&&(o=this._keystream=i.slice(0),this._iv=void 0),n.encryptBlock(o,0);for(var a=0;a<r;a++)e[t+a]^=o[a]}}),c.Decryptor=l,c),d.pad.NoPadding={pad:function(){},unpad:function(){}},function(e){var t=d,n=t.lib.CipherParams,r=t.enc.Hex;t.format.Hex={stringify:function(e){return e.ciphertext.toString(r)},parse:function(e){var t=r.parse(e);return n.create({ciphertext:t})}}}(),function(){var e=d,t=e.lib.BlockCipher,n=e.algo,r=[],i=[],o=[],a=[],s=[],c=[],l=[],u=[],p=[],h=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,d=0;for(t=0;t<256;t++){var f=d^d<<1^d<<2^d<<3^d<<4;f=f>>>8^255&f^99,r[n]=f,i[f]=n;var m=e[n],g=e[m],v=e[g],S=257*e[f]^16843008*f;o[n]=S<<24|S>>>8,a[n]=S<<16|S>>>16,s[n]=S<<8|S>>>24,c[n]=S;S=16843009*v^65537*g^257*m^16843008*n;l[f]=S<<24|S>>>8,u[f]=S<<16|S>>>16,p[f]=S<<8|S>>>24,h[f]=S,n?(n=m^e[e[e[v^m]]],d^=e[e[d]]):n=d=1}}();var f=[0,1,2,4,8,16,32,64,128,27,54],m=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,i=4*((this._nRounds=n+6)+1),o=this._keySchedule=[],a=0;a<i;a++)if(a<n)o[a]=t[a];else{var s=o[a-1];a%n?n>6&&a%n==4&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=r[(s=s<<8|s>>>24)>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=f[a/n|0]<<24),o[a]=o[a-n]^s}for(var c=this._invKeySchedule=[],d=0;d<i;d++){a=i-d;if(d%4)s=o[a];else s=o[a-4];c[d]=d<4||a<=4?s:l[r[s>>>24]]^u[r[s>>>16&255]]^p[r[s>>>8&255]]^h[r[255&s]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,a,s,c,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,u,p,h,i);n=e[t+1];e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,o,a,s){for(var c=this._nRounds,l=e[t]^n[0],d=e[t+1]^n[1],u=e[t+2]^n[2],p=e[t+3]^n[3],h=4,f=1;f<c;f++){var m=r[l>>>24]^i[d>>>16&255]^o[u>>>8&255]^a[255&p]^n[h++],g=r[d>>>24]^i[u>>>16&255]^o[p>>>8&255]^a[255&l]^n[h++],v=r[u>>>24]^i[p>>>16&255]^o[l>>>8&255]^a[255&d]^n[h++],S=r[p>>>24]^i[l>>>16&255]^o[d>>>8&255]^a[255&u]^n[h++];l=m,d=g,u=v,p=S}m=(s[l>>>24]<<24|s[d>>>16&255]<<16|s[u>>>8&255]<<8|s[255&p])^n[h++],g=(s[d>>>24]<<24|s[u>>>16&255]<<16|s[p>>>8&255]<<8|s[255&l])^n[h++],v=(s[u>>>24]<<24|s[p>>>16&255]<<16|s[l>>>8&255]<<8|s[255&d])^n[h++],S=(s[p>>>24]<<24|s[l>>>16&255]<<16|s[d>>>8&255]<<8|s[255&u])^n[h++];e[t]=m,e[t+1]=g,e[t+2]=v,e[t+3]=S},keySize:8});e.AES=t._createHelper(m)}(),function(){var e=d,t=e.lib,n=t.WordArray,r=t.BlockCipher,i=e.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],s=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=i.DES=r.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var r=o[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(var i=this._subKeys=[],c=0;c<16;c++){var l=i[c]=[],d=s[c];for(n=0;n<24;n++)l[n/6|0]|=t[(a[n]-1+d)%28]<<31-n%6,l[4+(n/6|0)]|=t[28+(a[n+24]-1+d)%28]<<31-n%6;l[0]=l[0]<<1|l[0]>>>31;for(n=1;n<7;n++)l[n]=l[n]>>>4*(n-1)+3;l[7]=l[7]<<5|l[7]>>>27}var u=this._invSubKeys=[];for(n=0;n<16;n++)u[n]=i[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),h.call(this,2,858993459),h.call(this,8,16711935),p.call(this,1,1431655765);for(var r=0;r<16;r++){for(var i=n[r],o=this._lBlock,a=this._rBlock,s=0,d=0;d<8;d++)s|=c[d][((a^i[d])&l[d])>>>0];this._lBlock=a,this._rBlock=o^s}var u=this._lBlock;this._lBlock=this._rBlock,this._rBlock=u,p.call(this,1,1431655765),h.call(this,8,16711935),h.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function h(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=r._createHelper(u);var f=i.TripleDES=r.extend({_doReset:function(){var e=this._key.words;this._des1=u.createEncryptor(n.create(e.slice(0,2))),this._des2=u.createEncryptor(n.create(e.slice(2,4))),this._des3=u.createEncryptor(n.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=r._createHelper(f)}(),function(){var e=d,t=e.lib.StreamCipher,n=e.algo,r=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],i=0;i<256;i++)r[i]=i;i=0;for(var o=0;i<256;i++){var a=i%n,s=t[a>>>2]>>>24-a%4*8&255;o=(o+r[i]+s)%256;var c=r[i];r[i]=r[o],r[o]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,n=this._j,r=0,i=0;i<4;i++){n=(n+e[t=(t+1)%256])%256;var o=e[t];e[t]=e[n],e[n]=o,r|=e[(e[t]+e[n])%256]<<24-8*i}return this._i=t,this._j=n,r}e.RC4=t._createHelper(r);var o=n.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});e.RC4Drop=t._createHelper(o)}(),d.mode.CTRGladman=function(){var e=d.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=1<<24;return e}var n=e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize,o=this._iv,a=this._counter;o&&(a=this._counter=o.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(a);var s=a.slice(0);r.encryptBlock(s,0);for(var c=0;c<i;c++)e[n+c]^=s[c]}});return e.Decryptor=n,e}(),function(){var e=d,t=e.lib.StreamCipher,n=e.algo,r=[],i=[],o=[],a=n.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(n=0;n<4;n++)s.call(this);for(n=0;n<8;n++)i[n]^=r[n+4&7];if(t){var o=t.words,a=o[0],c=o[1],l=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),u=l>>>16|4294901760&d,p=d<<16|65535&l;i[0]^=l,i[1]^=u,i[2]^=d,i[3]^=p,i[4]^=l,i[5]^=u,i[6]^=d,i[7]^=p;for(n=0;n<4;n++)s.call(this)}},_doProcessBlock:function(e,t){var n=this._X;s.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)r[i]=16711935&(r[i]<<8|r[i]>>>24)|4278255360&(r[i]<<24|r[i]>>>8),e[t+i]^=r[i]},blockSize:4,ivSize:2});function s(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0;for(n=0;n<8;n++){var r=e[n]+t[n],a=65535&r,s=r>>>16,c=((a*a>>>17)+a*s>>>15)+s*s,l=((4294901760&r)*r|0)+((65535&r)*r|0);o[n]=c^l}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}e.Rabbit=t._createHelper(a)}(),d.mode.CTR=function(){var e=d.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,o=this._counter;i&&(o=this._counter=i.slice(0),this._iv=void 0);var a=o.slice(0);n.encryptBlock(a,0),o[r-1]=o[r-1]+1|0;for(var s=0;s<r;s++)e[t+s]^=a[s]}});return e.Decryptor=t,e}(),function(){var e=d,t=e.lib.StreamCipher,n=e.algo,r=[],i=[],o=[],a=n.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var i=0;i<4;i++)s.call(this);for(i=0;i<8;i++)r[i]^=n[i+4&7];if(t){var o=t.words,a=o[0],c=o[1],l=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),u=l>>>16|4294901760&d,p=d<<16|65535&l;r[0]^=l,r[1]^=u,r[2]^=d,r[3]^=p,r[4]^=l,r[5]^=u,r[6]^=d,r[7]^=p;for(i=0;i<4;i++)s.call(this)}},_doProcessBlock:function(e,t){var n=this._X;s.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)r[i]=16711935&(r[i]<<8|r[i]>>>24)|4278255360&(r[i]<<24|r[i]>>>8),e[t+i]^=r[i]},blockSize:4,ivSize:2});function s(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0;for(n=0;n<8;n++){var r=e[n]+t[n],a=65535&r,s=r>>>16,c=((a*a>>>17)+a*s>>>15)+s*s,l=((4294901760&r)*r|0)+((65535&r)*r|0);o[n]=c^l}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}e.RabbitLegacy=t._createHelper(a)}(),d.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},d}),function(){function e(e,t){var n=0,r=!1,i=window.setInterval(function(){e()&&(window.clearInterval(i),t(r)),n++>50&&(window.clearInterval(i),t(r=!0))},10)}var t,n="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if(S="object"==typeof process&&"object"==typeof process.versions&&process.versions.node&&!process.browser){var r=process.versions.node.toString().replace("v","");n="Nodejs/"+r+" (NodeOS) AppleWebKit/"+r+" (KHTML, like Gecko) Nodejs/"+r+" Nodejs/"+r}t="undefined"!=typeof global?global:window,"undefined"==typeof window&&("undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:n,getUserMedia:function(){}},t.window=global),"undefined"==typeof location&&(t.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(t.screen={width:0,height:0}));var i=window.navigator;void 0!==i?(void 0!==i.webkitGetUserMedia&&(i.getUserMedia=i.webkitGetUserMedia),void 0!==i.mozGetUserMedia&&(i.getUserMedia=i.mozGetUserMedia)):i={getUserMedia:function(){},userAgent:n};var o,a,s=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(i.userAgent||""),c=!(-1===i.userAgent.indexOf("Edge")||!i.msSaveOrOpenBlob&&!i.msSaveBlob),l=!!window.opera||i.userAgent.indexOf(" OPR/")>=0,d=i.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(i.userAgent),u=/^((?!chrome|android).)*safari/i.test(i.userAgent),p=!!window.chrome&&!l,h="undefined"!=typeof document&&!!document.documentMode&&!c,f={Android:function(){return i.userAgent.match(/Android/i)},BlackBerry:function(){return i.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return i.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return i.userAgent.match(/Opera Mini/i)},Windows:function(){return i.userAgent.match(/IEMobile/i)},any:function(){return f.Android()||f.BlackBerry()||f.iOS()||f.Opera()||f.Windows()},getOsName:function(){var e="Unknown OS";return f.Android()&&(e="Android"),f.BlackBerry()&&(e="BlackBerry"),f.iOS()&&(e="iOS"),f.Opera()&&(e="Opera Mini"),f.Windows()&&(e="Windows"),e}},m="Unknown OS",g="Unknown OS Version",v=function(){for(var e,t=i.appVersion,n=i.userAgent,r="-",o=[{s:"Chrome OS",r:/CrOS/},{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],a=0;e=o[a];a++)if(e.r.test(n)){r=e.s;break}var s="-";switch(/Windows/.test(r)&&(/Windows (.*)/.test(r)&&(s=/Windows (.*)/.exec(r)[1]),r="Windows"),r){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(n)&&(s=/Mac OS X (10[\.\_\d]+)/.exec(n)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(n)&&(s=/Android ([\.\_\d]+)/.exec(n)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(n)&&(s=(s=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))[1]+"."+s[2]+"."+(0|s[3]))}return{osName:r,osVersion:s}}();v&&v.osName&&"-"!=v.osName?(m=v.osName,g=v.osVersion):f.any()&&("Android"==(m=f.getOsName())&&(g=!!(a=(o=(o||i.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&a[1]));var S="object"==typeof process&&"object"==typeof process.versions&&process.versions.node;"Unknown OS"===m&&S&&(m="Nodejs",g=process.versions.node.toString().replace("v",""));var y=!1,b=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!y&&e in document.createElement("canvas")&&(y=!0),!b&&e in document.createElement("video")&&(b=!0))});var _=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,w=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,T=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/,C=[],x=[],R=[],k=[];i.mediaDevices&&i.mediaDevices.enumerateDevices&&(i.enumerateDevices=function(e){var t=i.mediaDevices.enumerateDevices();t&&t.then?i.mediaDevices.enumerateDevices().then(e).catch(function(){e([])}):e([])});var P=!1;"undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack?P=!0:i.mediaDevices&&i.mediaDevices.enumerateDevices&&(P=!0);var j=!1,E=!1,D=!1,O=!1,A=!1,M=window.DetectRTC||{};M.browser=function(){var e,t,n,r=(i.appVersion,i.userAgent),o=i.appName,a=""+parseFloat(i.appVersion),s=parseInt(i.appVersion,10);if(l){o="Opera";try{s=(a=i.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){a="0.0.0.0",s=0}}else h?((t=r.indexOf("rv:"))>0?a=r.substring(t+3):(t=r.indexOf("MSIE"),a=r.substring(t+5)),o="IE"):p?(t=r.indexOf("Chrome"),o="Chrome",a=r.substring(t+7)):u?-1!==r.indexOf("CriOS")?(t=r.indexOf("CriOS"),o="Chrome",a=r.substring(t+6)):-1!==r.indexOf("FxiOS")?(t=r.indexOf("FxiOS"),o="Firefox",a=r.substring(t+6)):(t=r.indexOf("Safari"),o="Safari",a=r.substring(t+7),-1!==(t=r.indexOf("Version"))&&(a=r.substring(t+8)),-1!==i.userAgent.indexOf("Version/")&&(a=i.userAgent.split("Version/")[1].split(" ")[0])):d?(t=r.indexOf("Firefox"),o="Firefox",a=r.substring(t+8)):(e=r.lastIndexOf(" ")+1)<(t=r.lastIndexOf("/"))&&(o=r.substring(e,t),a=r.substring(t+1),o.toLowerCase()===o.toUpperCase()&&(o=i.appName));return c&&(o="Edge",a=i.userAgent.split("Edge/")[1]),-1!==(n=a.search(/[; \)]/))&&(a=a.substring(0,n)),s=parseInt(""+a,10),isNaN(s)&&(a=""+parseFloat(i.appVersion),s=parseInt(i.appVersion,10)),{fullVersion:a,version:s,name:o,isPrivateBrowsing:!1}}(),function(t){var n;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){n=!1},function(e){n=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var r;try{(r=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){n=!0}void 0===n&&e(function(){return"done"===r.readyState},function(e){e||(n=!r.result)})}else if(function(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var n=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);return!!(n&&parseInt(n[1],10)>=10)}(window.navigator.userAgent)){n=!1;try{window.indexedDB||(n=!0)}catch(e){n=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){n=!0}void 0===n&&(n=!1,window.localStorage.removeItem("test"))}}catch(e){n=!1}e(function(){return void 0!==n},function(e){t(n)})}(function(e){M.browser.isPrivateBrowsing=!!e}),M.browser["is"+M.browser.name]=!0,M.osName=m,M.osVersion=g;var I=("object"==typeof process&&"object"==typeof process.versions&&process.versions["node-webkit"],!1);["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(e){I||e in window&&(I=!0)}),M.isWebRTCSupported=I,M.isORTCSupported="undefined"!=typeof RTCIceGatherer;var L=!1;(M.browser.isChrome&&M.browser.version>=35?L=!0:M.browser.isFirefox&&M.browser.version>=34?L=!0:M.browser.isEdge&&M.browser.version>=17?L=!0:"Android"===M.osName&&M.browser.isChrome&&(L=!0),(i.getDisplayMedia||i.mediaDevices&&i.mediaDevices.getDisplayMedia)&&(L=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||""))||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(M.browser.isChrome||M.browser.isEdge||M.browser.isOpera)?L=!1:M.browser.isFirefox&&(L=!1));M.isScreenCapturingSupported=L;var N={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(e){N.isSupported||e in window&&(N.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(N.isCreateMediaStreamSourceSupported=!0))}),M.isAudioContextSupported=N.isSupported,M.isCreateMediaStreamSourceSupported=N.isCreateMediaStreamSourceSupported;var $=!1;M.browser.isChrome&&M.browser.version>31&&($=!0),M.isRtpDataChannelsSupported=$;var B=!1;M.browser.isFirefox&&M.browser.version>28?B=!0:M.browser.isChrome&&M.browser.version>25?B=!0:M.browser.isOpera&&M.browser.version>=11&&(B=!0),M.isSctpDataChannelsSupported=B,M.isMobileDevice=s;var F=!1;i.getUserMedia?F=!0:i.mediaDevices&&i.mediaDevices.getUserMedia&&(F=!0),M.browser.isChrome&&M.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(F="Requires HTTPs"),"Nodejs"===M.osName&&(F=!1),M.isGetUserMediaSupported=F;var U,H,q,z="";screen.width&&(z+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));M.displayResolution=z,M.displayAspectRatio=(U=screen.width,H=screen.height,q=function e(t,n){return 0==n?t:e(n,t%n)}(U,H),U/q/(H/q)).toFixed(2),M.isCanvasSupportsStreamCapturing=y,M.isVideoSupportsStreamCapturing=b,"Chrome"==M.browser.name&&M.browser.version>=53&&(M.isCanvasSupportsStreamCapturing||(M.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),M.isVideoSupportsStreamCapturing||(M.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),M.DetectLocalIPAddress=function(e,t){if(M.isWebRTCSupported){var n=!0,r=!0;!function(e,t){function n(t){if(t){var n=w.exec(t);if(n){var r=n[1],o=t.match(_);void 0===i[r]&&e(r,o,!0),i[r]=!0}}else e()}function r(){var e=l.localDescription.sdp.split("\n");e.forEach(function(e){e&&0===e.indexOf("a=candidate:")&&n(e)})}if("undefined"!=typeof document&&"function"==typeof document.getElementById){var i={},o=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!o){var a=document.getElementById("iframe");if(!a)return;var s=a.contentWindow;o=s.RTCPeerConnection||s.mozRTCPeerConnection||s.webkitRTCPeerConnection}if(o){var c=null;"Chrome"===M.browser&&M.browser.version<58&&(c={optional:[{RtpDataChannels:!0}]});var l=new o({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},c);if(t&&(l.addStream?l.addStream(t):l.addTrack&&t.getTracks()[0]&&l.addTrack(t.getTracks()[0],t)),l.onicecandidate=function(e){e.candidate&&e.candidate.candidate?n(e.candidate.candidate):n()},!t)try{l.createDataChannel("sctp",{})}catch(e){}M.isPromisesSupported?l.createOffer().then(function(e){l.setLocalDescription(e).then(r)}):l.createOffer(function(e){l.setLocalDescription(e,r,function(){})},function(){})}}}(function(t){t?t.match(_)?e("Local: "+t,n=!1,r):t.match(T)?e("Public: "+t,n,r=!1):e("Public: "+t,n,r):e()},t)}},M.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,M.isWebSocketsBlocked=!M.isWebSocketsSupported,"Nodejs"===M.osName&&(M.isWebSocketsSupported=!0,M.isWebSocketsBlocked=!1),M.checkWebSocketsSupport=function(e){e=e||function(){};try{var t,n=new WebSocket("wss://echo.websocket.org:443/");n.onopen=function(){M.isWebSocketsBlocked=!1,t=(new Date).getTime(),n.send("ping")},n.onmessage=function(){M.WebsocketLatency=(new Date).getTime()-t+"ms",e(),n.close(),n=null},n.onerror=function(){M.isWebSocketsBlocked=!0,e()}}catch(t){M.isWebSocketsBlocked=!0,e()}},M.load=function(e){(function(e){if(P)if(!i.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(i.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!i.enumerateDevices&&i.enumerateDevices&&(i.enumerateDevices=i.enumerateDevices.bind(i)),i.enumerateDevices){C=[],x=[],R=[],k=[],j=!1,E=!1,D=!1,O=!1,A=!1;var t={};i.enumerateDevices(function(n){C=[],x=[],R=[],k=[],n.forEach(function(e){var n={};for(var r in e)try{"function"!=typeof e[r]&&(n[r]=e[r])}catch(e){}t[n.deviceId+n.label+n.kind]||("audio"===n.kind&&(n.kind="audioinput"),"video"===n.kind&&(n.kind="videoinput"),n.deviceId||(n.deviceId=n.id),n.id||(n.id=n.deviceId),n.label?("videoinput"!==n.kind||A||(A=!0),"audioinput"!==n.kind||O||(O=!0)):(n.isCustomLabel=!0,"videoinput"===n.kind?n.label="Camera "+(k.length+1):"audioinput"===n.kind?n.label="Microphone "+(x.length+1):"audiooutput"===n.kind?n.label="Speaker "+(R.length+1):n.label="Please invoke getUserMedia once.",void 0!==M&&M.browser.isChrome&&M.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(n.label="HTTPs is required to get label of this "+n.kind+" device.")),"audioinput"===n.kind&&(j=!0,-1===x.indexOf(n)&&x.push(n)),"audiooutput"===n.kind&&(E=!0,-1===R.indexOf(n)&&R.push(n)),"videoinput"===n.kind&&(D=!0,-1===k.indexOf(n)&&k.push(n)),C.push(n),t[n.deviceId+n.label+n.kind]=n)}),void 0!==M&&(M.MediaDevices=C,M.hasMicrophone=j,M.hasSpeakers=E,M.hasWebcam=D,M.isWebsiteHasWebcamPermissions=A,M.isWebsiteHasMicrophonePermissions=O,M.audioInputDevices=x,M.audioOutputDevices=R,M.videoInputDevices=k),e&&e()})}else e&&e();else e&&e()})(e=e||function(){})},M.MediaDevices=void 0!==C?C:[],M.hasMicrophone=j,M.hasSpeakers=E,M.hasWebcam=D,M.isWebsiteHasWebcamPermissions=A,M.isWebsiteHasMicrophonePermissions=O,M.audioInputDevices=x,M.audioOutputDevices=R,M.videoInputDevices=k;var J=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(J=!0),M.isSetSinkIdSupported=J;var V=!1;M.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(V=!0):M.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(V=!0),M.isRTPSenderReplaceTracksSupported=V;var G=!1;M.browser.isFirefox&&M.browser.version>38&&(G=!0),M.isRemoteStreamProcessingSupported=G;var W=!1;"undefined"!=typeof MediaStreamTrack&&"applyConstraints"in MediaStreamTrack.prototype&&(W=!0),M.isApplyConstraintsSupported=W;var X=!1;M.browser.isFirefox&&M.browser.version>=43&&(X=!0),M.isMultiMonitorScreenCapturingSupported=X,M.isPromisesSupported=!!("Promise"in window),M.version="1.4.0",void 0===M&&(window.DetectRTC={});var K=window.MediaStream;void 0===K&&"undefined"!=typeof webkitMediaStream&&(K=webkitMediaStream),M.MediaStream=void 0!==K&&"function"==typeof K&&Object.keys(K.prototype),"undefined"!=typeof MediaStreamTrack?M.MediaStreamTrack=Object.keys(MediaStreamTrack.prototype):M.MediaStreamTrack=!1;var Q=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;M.RTCPeerConnection=void 0!==Q&&Object.keys(Q.prototype),window.DetectRTC=M,"undefined"!=typeof module&&(module.exports=M),"function"==typeof define&&define.amd&&define("DetectRTC",[],function(){return M})}();var INFINITY=1/0,symbolTag="[object Symbol]",reUnescapedHtml=/[&<>"'`]/g,reHasUnescapedHtml=RegExp(reUnescapedHtml.source),htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")();function basePropertyOf(e){return function(t){return null==e?void 0:e[t]}}var escapeHtmlChar=basePropertyOf(htmlEscapes),objectProto=Object.prototype,objectToString=objectProto.toString,Symbol=root.Symbol,symbolProto=Symbol?Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(isSymbol(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY?"-0":t}function isObjectLike(e){return!!e&&"object"==typeof e}function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&objectToString.call(e)==symbolTag}function toString(e){return null==e?"":baseToString(e)}var _escape=function(e){return(e=toString(e))&&reHasUnescapedHtml.test(e)?e.replace(reUnescapedHtml,escapeHtmlChar):e};try{module.exports=_escape}catch(e){}